<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Documentation for OptaDOS">
    <meta name="author" content="The OptaDOS developers group" >
    <link rel="icon" href="../favicon.png">

    <title>optics_calculate &ndash; OptaDOS</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">OptaDOS </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>optics_calculate
      <small>Subroutine</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title=" 1.0% of total for procedures.">66 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/optics.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/optics.f90.html'>optics.f90</a></li>
              <li><a href='../module/od_optics.html'>od_optics</a></li>
          <li class="active">optics_calculate</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/optics_calculate.html#src">optics_calculate</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine optics_calculate()  
</h2>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/od_parameters.html'>od_parameters</a></li>
                <li><a href='../module/od_jdos_utils.html'>od_jdos_utils</a></li>
                <li><a href='../module/od_comms.html'>od_comms</a></li>
                <li><a href='../module/od_dos_utils.html'>od_dos_utils</a></li>
                <li><a href='../module/od_cell.html'>od_cell</a></li>
                <li><a href='../module/od_electronic.html'>od_electronic</a></li>
                <li><a href='../module/od_io.html'>od_io</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~optics_calculate~~UsesGraph Pages: 1 -->
<svg id="procoptics_calculateUsesGraph" width="580pt" height="268pt"
 viewBox="0.00 0.00 580.00 267.88" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~optics_calculate~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 263.88)">
<title>proc~~optics_calculate~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-263.88 576,-263.88 576,4 -4,4"/>
<!-- proc~optics_calculate -->
<g id="proc~~optics_calculate~~UsesGraph_node1" class="node">
<title>proc~optics_calculate</title>
<polygon fill="none" stroke="black" points="572,-144 474,-144 474,-120 572,-120 572,-144"/>
<text text-anchor="middle" x="523" y="-129.6" font-family="Helvetica,sans-Serif" font-size="10.50">optics_calculate</text>
</g>
<!-- module~od_parameters -->
<g id="proc~~optics_calculate~~UsesGraph_node2" class="node">
<title>module~od_parameters</title>
<g id="a_proc~~optics_calculate~~UsesGraph_node2"><a xlink:href=".././module/od_parameters.html" xlink:title="od_parameters">
<polygon fill="#337ab7" stroke="#337ab7" points="438,-184 344,-184 344,-160 438,-160 438,-184"/>
<text text-anchor="middle" x="391" y="-169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_parameters</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;module~od_parameters -->
<g id="proc~~optics_calculate~~UsesGraph_edge1" class="edge">
<title>proc~optics_calculate&#45;&gt;module~od_parameters</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M483,-144C469.88,-148.04 455.06,-152.6 441.26,-156.84"/>
<polygon fill="#ff0000" stroke="#ff0000" points="439.95,-153.58 431.43,-159.87 442.01,-160.27 439.95,-153.58"/>
</g>
<!-- module~od_comms -->
<g id="proc~~optics_calculate~~UsesGraph_node3" class="node">
<title>module~od_comms</title>
<g id="a_proc~~optics_calculate~~UsesGraph_node3"><a xlink:href=".././module/od_comms.html" xlink:title="od_comms">
<polygon fill="#337ab7" stroke="#337ab7" points="188,-242 118,-242 118,-218 188,-218 188,-242"/>
<text text-anchor="middle" x="153" y="-227.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_comms</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;module~od_comms -->
<g id="proc~~optics_calculate~~UsesGraph_edge2" class="edge">
<title>proc~optics_calculate&#45;&gt;module~od_comms</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M390,-250C325.17,-269.02 246.34,-255.39 198.19,-243.18"/>
<polygon fill="#ff0000" stroke="#ff0000" points="198.95,-239.76 188.39,-240.61 197.18,-246.53 198.95,-239.76"/>
</g>
<!-- module~od_jdos_utils -->
<g id="proc~~optics_calculate~~UsesGraph_node4" class="node">
<title>module~od_jdos_utils</title>
<g id="a_proc~~optics_calculate~~UsesGraph_node4"><a xlink:href=".././module/od_jdos_utils.html" xlink:title="od_jdos_utils">
<polygon fill="#337ab7" stroke="#337ab7" points="306,-222 226,-222 226,-198 306,-198 306,-222"/>
<text text-anchor="middle" x="266" y="-207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_jdos_utils</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;module~od_jdos_utils -->
<g id="proc~~optics_calculate~~UsesGraph_edge3" class="edge">
<title>proc~optics_calculate&#45;&gt;module~od_jdos_utils</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M514.46,-144.01C496.94,-170.47 450.5,-232.84 392,-250"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M390,-250C373.38,-254.88 332.11,-239.34 301.94,-226.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="303.14,-222.94 292.58,-222.09 300.31,-229.34 303.14,-222.94"/>
</g>
<!-- module~od_dos_utils -->
<g id="proc~~optics_calculate~~UsesGraph_node5" class="node">
<title>module~od_dos_utils</title>
<g id="a_proc~~optics_calculate~~UsesGraph_node5"><a xlink:href=".././module/od_dos_utils.html" xlink:title="od_dos_utils">
<polygon fill="#337ab7" stroke="#337ab7" points="429.5,-64 352.5,-64 352.5,-40 429.5,-40 429.5,-64"/>
<text text-anchor="middle" x="391" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_dos_utils</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;module~od_dos_utils -->
<g id="proc~~optics_calculate~~UsesGraph_edge4" class="edge">
<title>proc~optics_calculate&#45;&gt;module~od_dos_utils</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M502.26,-119.85C480.37,-106.38 444.89,-84.55 420.11,-69.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="421.86,-66.26 411.5,-64 418.19,-72.22 421.86,-66.26"/>
</g>
<!-- module~od_cell -->
<g id="proc~~optics_calculate~~UsesGraph_node6" class="node">
<title>module~od_cell</title>
<g id="a_proc~~optics_calculate~~UsesGraph_node6"><a xlink:href=".././module/od_cell.html" xlink:title="od_cell">
<polygon fill="#337ab7" stroke="#337ab7" points="293,-104 239,-104 239,-80 293,-80 293,-104"/>
<text text-anchor="middle" x="266" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_cell</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;module~od_cell -->
<g id="proc~~optics_calculate~~UsesGraph_edge5" class="edge">
<title>proc~optics_calculate&#45;&gt;module~od_cell</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473.77,-133.82C449.25,-134.28 419,-134.15 392,-132"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M390,-132C359.11,-129.54 325.79,-118.11 301.62,-108.1"/>
<polygon fill="#ff0000" stroke="#ff0000" points="302.76,-104.78 292.19,-104.07 300.01,-111.21 302.76,-104.78"/>
</g>
<!-- module~od_electronic -->
<g id="proc~~optics_calculate~~UsesGraph_node7" class="node">
<title>module~od_electronic</title>
<g id="a_proc~~optics_calculate~~UsesGraph_node7"><a xlink:href=".././module/od_electronic.html" xlink:title="od_electronic">
<polygon fill="#337ab7" stroke="#337ab7" points="308,-24 224,-24 224,0 308,0 308,-24"/>
<text text-anchor="middle" x="266" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_electronic</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;module~od_electronic -->
<g id="proc~~optics_calculate~~UsesGraph_edge6" class="edge">
<title>proc~optics_calculate&#45;&gt;module~od_electronic</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M515.92,-119.77C504.24,-97.71 476.36,-51.65 438,-31 401.37,-11.28 354,-7.39 318.4,-7.95"/>
<polygon fill="#ff0000" stroke="#ff0000" points="318.13,-4.45 308.23,-8.23 318.32,-11.45 318.13,-4.45"/>
</g>
<!-- module~od_io -->
<g id="proc~~optics_calculate~~UsesGraph_node8" class="node">
<title>module~od_io</title>
<g id="a_proc~~optics_calculate~~UsesGraph_node8"><a xlink:href=".././module/od_io.html" xlink:title="od_io">
<polygon fill="#337ab7" stroke="#337ab7" points="180,-142 126,-142 126,-118 180,-118 180,-142"/>
<text text-anchor="middle" x="153" y="-127.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_io</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;module~od_io -->
<g id="proc~~optics_calculate~~UsesGraph_edge7" class="edge">
<title>proc~optics_calculate&#45;&gt;module~od_io</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M390,-132C319.52,-126.4 236.83,-127.44 190.41,-128.71"/>
<polygon fill="#ff0000" stroke="#ff0000" points="190.14,-125.22 180.25,-129.01 190.34,-132.22 190.14,-125.22"/>
</g>
<!-- module~od_parameters&#45;&gt;module~od_cell -->
<g id="proc~~optics_calculate~~UsesGraph_edge8" class="edge">
<title>module~od_parameters&#45;&gt;module~od_cell</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M367.75,-160C360.13,-155.73 351.6,-150.8 344,-146 325.99,-134.64 306.35,-120.84 291.41,-110.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="293.35,-107.12 283.21,-104.06 289.23,-112.77 293.35,-107.12"/>
</g>
<!-- module~od_parameters&#45;&gt;module~od_io -->
<g id="proc~~optics_calculate~~UsesGraph_edge9" class="edge">
<title>module~od_parameters&#45;&gt;module~od_io</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M343.76,-172.98C320.66,-173.03 292.3,-172.43 267,-170"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M265,-170C237.29,-167.34 207.72,-156.24 186.08,-146.4"/>
<polygon fill="#ff0000" stroke="#ff0000" points="187.56,-143.23 177.02,-142.15 184.58,-149.56 187.56,-143.23"/>
</g>
<!-- module~od_constants -->
<g id="proc~~optics_calculate~~UsesGraph_node9" class="node">
<title>module~od_constants</title>
<g id="a_proc~~optics_calculate~~UsesGraph_node9"><a xlink:href=".././module/od_constants.html" xlink:title="od_constants">
<polygon fill="#337ab7" stroke="#337ab7" points="82,-162 0,-162 0,-138 82,-138 82,-162"/>
<text text-anchor="middle" x="41" y="-147.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_constants</text>
</a>
</g>
</g>
<!-- module~od_parameters&#45;&gt;module~od_constants -->
<g id="proc~~optics_calculate~~UsesGraph_edge10" class="edge">
<title>module~od_parameters&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M265,-170C215.89,-165.29 202.57,-178.64 154,-170"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M152,-170C132.4,-166.52 110.85,-162.61 92.05,-159.19"/>
<polygon fill="#ff0000" stroke="#ff0000" points="92.68,-155.74 82.22,-157.39 91.42,-162.63 92.68,-155.74"/>
</g>
<!-- module~od_comms&#45;&gt;module~od_constants -->
<g id="proc~~optics_calculate~~UsesGraph_edge11" class="edge">
<title>module~od_comms&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M135.29,-217.85C117.02,-204.56 87.54,-183.12 66.61,-167.9"/>
<polygon fill="#ffda00" stroke="#ffda00" points="68.65,-165.05 58.5,-162 64.53,-170.71 68.65,-165.05"/>
</g>
<!-- module~od_jdos_utils&#45;&gt;module~od_constants -->
<g id="proc~~optics_calculate~~UsesGraph_edge12" class="edge">
<title>module~od_jdos_utils&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M239.23,-197.87C217.16,-188.19 184.25,-175.38 154,-170"/>
</g>
<!-- module~od_dos_utils&#45;&gt;module~od_electronic -->
<g id="proc~~optics_calculate~~UsesGraph_edge13" class="edge">
<title>module~od_dos_utils&#45;&gt;module~od_electronic</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M353.1,-40C340.8,-36 326.94,-31.49 313.99,-27.28"/>
<polygon fill="#00ff91" stroke="#00ff91" points="314.9,-23.9 304.3,-24.13 312.73,-30.55 314.9,-23.9"/>
</g>
<!-- module~od_dos_utils&#45;&gt;module~od_constants -->
<g id="proc~~optics_calculate~~UsesGraph_edge14" class="edge">
<title>module~od_dos_utils&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M352.17,-44.07C304.31,-35.78 220.16,-27.14 154,-52"/>
</g>
<!-- module~od_cell&#45;&gt;module~od_io -->
<g id="proc~~optics_calculate~~UsesGraph_edge15" class="edge">
<title>module~od_cell&#45;&gt;module~od_io</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M238.98,-100.91C224.33,-105.92 205.83,-112.26 189.83,-117.73"/>
<polygon fill="#0091ff" stroke="#0091ff" points="188.57,-114.46 180.25,-121.01 190.84,-121.09 188.57,-114.46"/>
</g>
<!-- module~od_cell&#45;&gt;module~od_constants -->
<g id="proc~~optics_calculate~~UsesGraph_edge16" class="edge">
<title>module~od_cell&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M242.32,-79.9C214.93,-65.99 170.49,-45.8 154,-52"/>
</g>
<!-- module~od_electronic&#45;&gt;module~od_constants -->
<g id="proc~~optics_calculate~~UsesGraph_edge17" class="edge">
<title>module~od_electronic&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M230.91,-24.02C208.9,-31.84 179.69,-42.35 154,-52"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M152,-52C111.06,-67.38 75.73,-105.94 56.79,-129.85"/>
<polygon fill="#4800ff" stroke="#4800ff" points="53.9,-127.87 50.57,-137.93 59.44,-132.14 53.9,-127.87"/>
</g>
<!-- module~od_io&#45;&gt;module~od_constants -->
<g id="proc~~optics_calculate~~UsesGraph_edge18" class="edge">
<title>module~od_io&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M125.93,-134.74C115.81,-136.58 103.86,-138.75 92.2,-140.87"/>
<polygon fill="#ff00da" stroke="#ff00da" points="91.29,-137.48 82.08,-142.71 92.54,-144.37 91.29,-137.48"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>



    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~optics_calculate~~CallsGraph Pages: 1 -->
<svg id="procoptics_calculateCallsGraph" width="641pt" height="610pt"
 viewBox="0.00 0.00 641.00 610.22" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~optics_calculate~~CallsGraph" class="graph" transform="scale(1.9 1.9) rotate(0) translate(4 1152.66)">
<title>proc~~optics_calculate~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1152.66 1211,-1152.66 1211,4 -4,4"/>
<!-- proc~optics_calculate -->
<g id="proc~~optics_calculate~~CallsGraph_node1" class="node">
<title>proc~optics_calculate</title>
<polygon fill="none" stroke="black" points="98,-567.66 0,-567.66 0,-543.66 98,-543.66 98,-567.66"/>
<text text-anchor="middle" x="49" y="-553.26" font-family="Helvetica,sans-Serif" font-size="10.50">optics_calculate</text>
</g>
<!-- proc~write_conduct -->
<g id="proc~~optics_calculate~~CallsGraph_node2" class="node">
<title>proc~write_conduct</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node2"><a xlink:href=".././proc/write_conduct.html" xlink:title="write_conduct">
<polygon fill="#d9534f" stroke="#d9534f" points="388.5,-1053.66 301.5,-1053.66 301.5,-1029.66 388.5,-1029.66 388.5,-1053.66"/>
<text text-anchor="middle" x="345" y="-1039.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_conduct</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~write_conduct -->
<g id="proc~~optics_calculate~~CallsGraph_edge1" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~write_conduct</title>
<path fill="none" stroke="#ff0000" d="M50.89,-567.95C55.57,-629.77 79.34,-906.14 134,-968.66 173.65,-1014.01 242.99,-1031.2 291.09,-1037.7"/>
<polygon fill="#ff0000" stroke="#ff0000" points="290.96,-1041.22 301.32,-1038.97 291.82,-1034.27 290.96,-1041.22"/>
</g>
<!-- proc~write_absorp -->
<g id="proc~~optics_calculate~~CallsGraph_node3" class="node">
<title>proc~write_absorp</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node3"><a xlink:href=".././proc/write_absorp.html" xlink:title="write_absorp">
<polygon fill="#d9534f" stroke="#d9534f" points="385.5,-984.66 304.5,-984.66 304.5,-960.66 385.5,-960.66 385.5,-984.66"/>
<text text-anchor="middle" x="345" y="-970.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_absorp</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~write_absorp -->
<g id="proc~~optics_calculate~~CallsGraph_edge2" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~write_absorp</title>
<path fill="none" stroke="#ff0000" d="M50.94,-567.85C55.73,-626.7 79.35,-880.9 134,-933.66 176.25,-974.46 246.6,-979.7 294.11,-977.77"/>
<polygon fill="#ff0000" stroke="#ff0000" points="294.38,-981.26 304.18,-977.24 294.01,-974.27 294.38,-981.26"/>
</g>
<!-- proc~jdos_utils_calculate -->
<g id="proc~~optics_calculate~~CallsGraph_node4" class="node">
<title>proc~jdos_utils_calculate</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node4"><a xlink:href=".././proc/jdos_utils_calculate.html" xlink:title="jdos_utils_calculate">
<polygon fill="#d9534f" stroke="#d9534f" points="249,-567.66 134,-567.66 134,-543.66 249,-543.66 249,-567.66"/>
<text text-anchor="middle" x="191.5" y="-553.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jdos_utils_calculate</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~jdos_utils_calculate -->
<g id="proc~~optics_calculate~~CallsGraph_edge5" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~jdos_utils_calculate</title>
<path fill="none" stroke="#ff0000" d="M98.35,-555.66C106.57,-555.66 115.23,-555.66 123.82,-555.66"/>
<polygon fill="#ff0000" stroke="#ff0000" points="123.83,-559.16 133.83,-555.66 123.83,-552.16 123.83,-559.16"/>
</g>
<!-- proc~dos_utils_calculate_at_e -->
<g id="proc~~optics_calculate~~CallsGraph_node5" class="node">
<title>proc~dos_utils_calculate_at_e</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node5"><a xlink:href=".././proc/dos_utils_calculate_at_e.html" xlink:title="dos_utils_calculate_at_e">
<polygon fill="#d9534f" stroke="#d9534f" points="581,-616.66 441,-616.66 441,-592.66 581,-592.66 581,-616.66"/>
<text text-anchor="middle" x="511" y="-602.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_calculate_at_e</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~dos_utils_calculate_at_e -->
<g id="proc~~optics_calculate~~CallsGraph_edge4" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~dos_utils_calculate_at_e</title>
<path fill="none" stroke="#ff0000" d="M92.44,-567.77C105.66,-571.13 120.35,-574.46 134,-576.66 235.74,-593.05 354.55,-599.87 430.95,-602.69"/>
<polygon fill="#ff0000" stroke="#ff0000" points="430.86,-606.19 440.98,-603.05 431.11,-599.2 430.86,-606.19"/>
</g>
<!-- proc~elec_read_optical_mat -->
<g id="proc~~optics_calculate~~CallsGraph_node6" class="node">
<title>proc~elec_read_optical_mat</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node6"><a xlink:href=".././proc/elec_read_optical_mat.html" xlink:title="elec_read_optical_mat">
<polygon fill="#d9534f" stroke="#d9534f" points="932,-760.66 800,-760.66 800,-736.66 932,-736.66 932,-760.66"/>
<text text-anchor="middle" x="866" y="-746.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elec_read_optical_mat</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~elec_read_optical_mat -->
<g id="proc~~optics_calculate~~CallsGraph_edge3" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~elec_read_optical_mat</title>
<path fill="none" stroke="#ff0000" d="M60.38,-567.69C95.72,-607.23 216.29,-730.66 344,-730.66 344,-730.66 344,-730.66 512,-730.66 607.92,-730.66 718.31,-737.37 789.74,-742.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="789.76,-746.11 799.99,-743.36 790.28,-739.13 789.76,-746.11"/>
</g>
<!-- proc~make_weights -->
<g id="proc~~optics_calculate~~CallsGraph_node7" class="node">
<title>proc~make_weights</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node7"><a xlink:href=".././proc/make_weights.html" xlink:title="make_weights">
<polygon fill="#d9534f" stroke="#d9534f" points="555,-135.66 467,-135.66 467,-111.66 555,-111.66 555,-135.66"/>
<text text-anchor="middle" x="511" y="-121.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">make_weights</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~make_weights -->
<g id="proc~~optics_calculate~~CallsGraph_edge6" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~make_weights</title>
<path fill="none" stroke="#ff0000" d="M62.64,-543.58C78.24,-529.28 106.15,-505.65 134,-491.66 181.52,-467.81 214.25,-498.91 249,-458.66 327.83,-367.36 206.44,-281.2 285,-189.66 327.38,-140.28 404.55,-126.84 456.55,-123.7"/>
<polygon fill="#ff0000" stroke="#ff0000" points="456.78,-127.2 466.6,-123.21 456.44,-120.2 456.78,-127.2"/>
</g>
<!-- proc~calc_epsilon_2 -->
<g id="proc~~optics_calculate~~CallsGraph_node8" class="node">
<title>proc~calc_epsilon_2</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node8"><a xlink:href=".././proc/calc_epsilon_2.html" xlink:title="calc_epsilon_2">
<polygon fill="#d9534f" stroke="#d9534f" points="236.5,-449.66 146.5,-449.66 146.5,-425.66 236.5,-425.66 236.5,-449.66"/>
<text text-anchor="middle" x="191.5" y="-435.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_epsilon_2</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~calc_epsilon_2 -->
<g id="proc~~optics_calculate~~CallsGraph_edge7" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~calc_epsilon_2</title>
<path fill="none" stroke="#ff0000" d="M58.57,-543.5C72.53,-524.4 101.87,-487.14 134,-463.66 138.75,-460.19 144.03,-457.02 149.41,-454.18"/>
<polygon fill="#ff0000" stroke="#ff0000" points="151.05,-457.28 158.47,-449.72 147.95,-451 151.05,-457.28"/>
</g>
<!-- proc~calc_epsilon_1 -->
<g id="proc~~optics_calculate~~CallsGraph_node9" class="node">
<title>proc~calc_epsilon_1</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node9"><a xlink:href=".././proc/calc_epsilon_1.html" xlink:title="calc_epsilon_1">
<polygon fill="#d9534f" stroke="#d9534f" points="236.5,-407.66 146.5,-407.66 146.5,-383.66 236.5,-383.66 236.5,-407.66"/>
<text text-anchor="middle" x="191.5" y="-393.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_epsilon_1</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~calc_epsilon_1 -->
<g id="proc~~optics_calculate~~CallsGraph_edge8" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~calc_epsilon_1</title>
<path fill="none" stroke="#ff0000" d="M54.21,-543.38C64,-516.59 90.78,-452.45 134,-416.66 135.74,-415.23 137.58,-413.88 139.5,-412.63"/>
<polygon fill="#ff0000" stroke="#ff0000" points="141.32,-415.62 148.32,-407.66 137.89,-409.52 141.32,-415.62"/>
</g>
<!-- proc~calc_refract -->
<g id="proc~~optics_calculate~~CallsGraph_node10" class="node">
<title>proc~calc_refract</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node10"><a xlink:href=".././proc/calc_refract.html" xlink:title="calc_refract">
<polygon fill="#d9534f" stroke="#d9534f" points="229,-365.66 154,-365.66 154,-341.66 229,-341.66 229,-365.66"/>
<text text-anchor="middle" x="191.5" y="-351.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_refract</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~calc_refract -->
<g id="proc~~optics_calculate~~CallsGraph_edge9" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~calc_refract</title>
<path fill="none" stroke="#ff0000" d="M52.27,-543.66C58.92,-511.64 81.34,-423.34 134,-374.66 137.16,-371.75 140.75,-369.22 144.57,-367.05"/>
<polygon fill="#ff0000" stroke="#ff0000" points="146.31,-370.09 153.76,-362.56 143.24,-363.8 146.31,-370.09"/>
</g>
<!-- proc~calc_reflect -->
<g id="proc~~optics_calculate~~CallsGraph_node11" class="node">
<title>proc~calc_reflect</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node11"><a xlink:href=".././proc/calc_reflect.html" xlink:title="calc_reflect">
<polygon fill="#d9534f" stroke="#d9534f" points="228,-323.66 155,-323.66 155,-299.66 228,-299.66 228,-323.66"/>
<text text-anchor="middle" x="191.5" y="-309.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_reflect</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~calc_reflect -->
<g id="proc~~optics_calculate~~CallsGraph_edge10" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~calc_reflect</title>
<path fill="none" stroke="#ff0000" d="M51.08,-543.65C55.03,-506.87 71.85,-394.54 134,-332.66 137.43,-329.24 141.48,-326.37 145.79,-323.97"/>
<polygon fill="#ff0000" stroke="#ff0000" points="147.38,-327.09 154.93,-319.65 144.39,-320.76 147.38,-327.09"/>
</g>
<!-- proc~calc_conduct -->
<g id="proc~~optics_calculate~~CallsGraph_node12" class="node">
<title>proc~calc_conduct</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node12"><a xlink:href=".././proc/calc_conduct.html" xlink:title="calc_conduct">
<polygon fill="#d9534f" stroke="#d9534f" points="232.5,-281.66 150.5,-281.66 150.5,-257.66 232.5,-257.66 232.5,-281.66"/>
<text text-anchor="middle" x="191.5" y="-267.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_conduct</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~calc_conduct -->
<g id="proc~~optics_calculate~~CallsGraph_edge17" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~calc_conduct</title>
<path fill="none" stroke="#ff0000" d="M50.26,-543.52C51.78,-502.28 62.28,-365.98 134,-290.66 136.27,-288.28 138.84,-286.16 141.6,-284.28"/>
<polygon fill="#ff0000" stroke="#ff0000" points="143.36,-287.31 150.33,-279.33 139.91,-281.22 143.36,-287.31"/>
</g>
<!-- proc~write_epsilon -->
<g id="proc~~optics_calculate~~CallsGraph_node13" class="node">
<title>proc~write_epsilon</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node13"><a xlink:href=".././proc/write_epsilon.html" xlink:title="write_epsilon">
<polygon fill="#d9534f" stroke="#d9534f" points="552,-1030.66 470,-1030.66 470,-1006.66 552,-1006.66 552,-1030.66"/>
<text text-anchor="middle" x="511" y="-1016.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_epsilon</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~write_epsilon -->
<g id="proc~~optics_calculate~~CallsGraph_edge11" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~write_epsilon</title>
<path fill="none" stroke="#ff0000" d="M51.59,-567.97C58.68,-621.07 89.09,-830 134,-875.66 221.71,-964.85 299.14,-885.02 405,-951.66 425.52,-964.58 421.06,-978.86 441,-992.66 446.93,-996.77 453.6,-1000.33 460.39,-1003.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="459.09,-1006.63 469.67,-1007.23 461.77,-1000.17 459.09,-1006.63"/>
</g>
<!-- proc~calc_loss_fn -->
<g id="proc~~optics_calculate~~CallsGraph_node14" class="node">
<title>proc~calc_loss_fn</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node14"><a xlink:href=".././proc/calc_loss_fn.html" xlink:title="calc_loss_fn">
<polygon fill="#d9534f" stroke="#d9534f" points="229.5,-239.66 153.5,-239.66 153.5,-215.66 229.5,-215.66 229.5,-239.66"/>
<text text-anchor="middle" x="191.5" y="-225.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_loss_fn</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~calc_loss_fn -->
<g id="proc~~optics_calculate~~CallsGraph_edge14" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~calc_loss_fn</title>
<path fill="none" stroke="#ff0000" d="M49.63,-543.56C48.93,-498.41 52.5,-337.74 134,-248.66 136.94,-245.45 140.42,-242.73 144.18,-240.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="146.03,-243.4 153.36,-235.75 142.86,-237.16 146.03,-243.4"/>
</g>
<!-- proc~write_refract -->
<g id="proc~~optics_calculate~~CallsGraph_node15" class="node">
<title>proc~write_refract</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node15"><a xlink:href=".././proc/write_refract.html" xlink:title="write_refract">
<polygon fill="#d9534f" stroke="#d9534f" points="384.5,-884.66 305.5,-884.66 305.5,-860.66 384.5,-860.66 384.5,-884.66"/>
<text text-anchor="middle" x="345" y="-870.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_refract</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~write_refract -->
<g id="proc~~optics_calculate~~CallsGraph_edge13" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~write_refract</title>
<path fill="none" stroke="#ff0000" d="M51.79,-567.89C59.35,-617.9 90.34,-805.97 134,-843.66 178.16,-881.78 248.15,-883.81 295.05,-879.83"/>
<polygon fill="#ff0000" stroke="#ff0000" points="295.65,-883.29 305.27,-878.84 294.98,-876.32 295.65,-883.29"/>
</g>
<!-- proc~dos_utils_set_efermi -->
<g id="proc~~optics_calculate~~CallsGraph_node16" class="node">
<title>proc~dos_utils_set_efermi</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node16"><a xlink:href=".././proc/dos_utils_set_efermi.html" xlink:title="dos_utils_set_efermi">
<polygon fill="#d9534f" stroke="#d9534f" points="405,-314.66 285,-314.66 285,-290.66 405,-290.66 405,-314.66"/>
<text text-anchor="middle" x="345" y="-300.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_set_efermi</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~dos_utils_set_efermi -->
<g id="proc~~optics_calculate~~CallsGraph_edge15" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~dos_utils_set_efermi</title>
<path fill="none" stroke="#ff0000" d="M95.38,-543.63C150.76,-528.56 238.4,-503.3 249,-491.66 298.94,-436.8 237.97,-386.04 285,-328.66 287.6,-325.49 290.66,-322.69 294.01,-320.23"/>
<polygon fill="#ff0000" stroke="#ff0000" points="296.14,-323.02 302.78,-314.77 292.44,-317.08 296.14,-323.02"/>
</g>
<!-- proc~write_loss_fn -->
<g id="proc~~optics_calculate~~CallsGraph_node17" class="node">
<title>proc~write_loss_fn</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node17"><a xlink:href=".././proc/write_loss_fn.html" xlink:title="write_loss_fn">
<polygon fill="#d9534f" stroke="#d9534f" points="551,-896.66 471,-896.66 471,-872.66 551,-872.66 551,-896.66"/>
<text text-anchor="middle" x="511" y="-882.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_loss_fn</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~write_loss_fn -->
<g id="proc~~optics_calculate~~CallsGraph_edge12" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~write_loss_fn</title>
<path fill="none" stroke="#ff0000" d="M50.33,-567.84C52.08,-607.29 63.24,-732.6 134,-794.66 226.53,-875.83 285.93,-820.51 405,-851.66 424.9,-856.87 446.63,-863.53 465.13,-869.51"/>
<polygon fill="#ff0000" stroke="#ff0000" points="464.18,-872.88 474.77,-872.65 466.35,-866.22 464.18,-872.88"/>
</g>
<!-- proc~write_reflect -->
<g id="proc~~optics_calculate~~CallsGraph_node18" class="node">
<title>proc~write_reflect</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node18"><a xlink:href=".././proc/write_reflect.html" xlink:title="write_reflect">
<polygon fill="#d9534f" stroke="#d9534f" points="729.5,-1148.66 651.5,-1148.66 651.5,-1124.66 729.5,-1124.66 729.5,-1148.66"/>
<text text-anchor="middle" x="690.5" y="-1134.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_reflect</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~write_reflect -->
<g id="proc~~optics_calculate~~CallsGraph_edge18" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~write_reflect</title>
<path fill="none" stroke="#ff0000" d="M50.6,-567.94C54.07,-633.64 73.48,-943.15 134,-1012.66 264.28,-1162.28 531.89,-1153.49 641.29,-1142.73"/>
<polygon fill="#ff0000" stroke="#ff0000" points="641.78,-1146.2 651.37,-1141.69 641.06,-1139.23 641.78,-1146.2"/>
</g>
<!-- proc~calc_absorp -->
<g id="proc~~optics_calculate~~CallsGraph_node19" class="node">
<title>proc~calc_absorp</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node19"><a xlink:href=".././proc/calc_absorp.html" xlink:title="calc_absorp">
<polygon fill="#d9534f" stroke="#d9534f" points="229.5,-197.66 153.5,-197.66 153.5,-173.66 229.5,-173.66 229.5,-197.66"/>
<text text-anchor="middle" x="191.5" y="-183.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calc_absorp</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~calc_absorp -->
<g id="proc~~optics_calculate~~CallsGraph_edge19" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~calc_absorp</title>
<path fill="none" stroke="#ff0000" d="M51.39,-543.49C57.98,-487.94 87.58,-259 134,-206.66 136.89,-203.4 140.33,-200.65 144.08,-198.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="145.93,-201.31 153.23,-193.63 142.73,-195.08 145.93,-201.31"/>
</g>
<!-- proc~elec_dealloc_optical -->
<g id="proc~~optics_calculate~~CallsGraph_node20" class="node">
<title>proc~elec_dealloc_optical</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node20"><a xlink:href=".././proc/elec_dealloc_optical.html" xlink:title="elec_dealloc_optical">
<polygon fill="#d9534f" stroke="#d9534f" points="926.5,-916.66 805.5,-916.66 805.5,-892.66 926.5,-892.66 926.5,-916.66"/>
<text text-anchor="middle" x="866" y="-902.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elec_dealloc_optical</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~elec_dealloc_optical -->
<g id="proc~~optics_calculate~~CallsGraph_edge16" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~elec_dealloc_optical</title>
<path fill="none" stroke="#ff0000" d="M54.63,-567.72C65.07,-593.45 92.77,-654.23 134,-689.66 211.15,-755.96 242.28,-780.66 344,-780.66 344,-780.66 344,-780.66 512,-780.66 576.39,-780.66 752.79,-855.04 829.07,-888.59"/>
<polygon fill="#ff0000" stroke="#ff0000" points="827.73,-891.82 838.29,-892.66 830.55,-885.42 827.73,-891.82"/>
</g>
<!-- proc~io_file_unit -->
<g id="proc~~optics_calculate~~CallsGraph_node24" class="node">
<title>proc~io_file_unit</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node24"><a xlink:href=".././proc/io_file_unit.html" xlink:title="io_file_unit">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1072,-994.66 1002,-994.66 1002,-970.66 1072,-970.66 1072,-994.66"/>
<text text-anchor="middle" x="1037" y="-980.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_file_unit</text>
</a>
</g>
</g>
<!-- proc~write_conduct&#45;&gt;proc~io_file_unit -->
<g id="proc~~optics_calculate~~CallsGraph_edge20" class="edge">
<title>proc~write_conduct&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#ff0000" d="M388.22,-1053.73C404.57,-1057.91 423.53,-1062.17 441,-1064.66 657.2,-1095.46 727,-1120.96 932,-1045.66 961.52,-1034.82 991.89,-1015.27 1012.14,-1000.81"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1014.4,-1003.49 1020.42,-994.77 1010.28,-997.83 1014.4,-1003.49"/>
</g>
<!-- proc~write_absorp&#45;&gt;proc~io_file_unit -->
<g id="proc~~optics_calculate~~CallsGraph_edge21" class="edge">
<title>proc~write_absorp&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#ff5000" d="M360.84,-984.83C382.86,-1002.59 423.49,-1034.11 441,-1039.66 640.15,-1102.83 894.08,-1031.38 993.44,-997.99"/>
<polygon fill="#ff5000" stroke="#ff5000" points="994.78,-1001.23 1003.12,-994.69 992.53,-994.6 994.78,-1001.23"/>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~dos_utils_set_efermi -->
<g id="proc~~optics_calculate~~CallsGraph_edge23" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~dos_utils_set_efermi</title>
<path fill="none" stroke="#ffa100" d="M231.89,-543.59C238.42,-540.03 244.51,-535.47 249,-529.66 304.53,-457.88 228.89,-400 285,-328.66 287.5,-325.49 290.46,-322.69 293.72,-320.23"/>
<polygon fill="#ffa100" stroke="#ffa100" points="295.73,-323.09 302.29,-314.77 291.97,-317.19 295.73,-323.09"/>
</g>
<!-- proc~io_time -->
<g id="proc~~optics_calculate~~CallsGraph_node25" class="node">
<title>proc~io_time</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node25"><a xlink:href=".././proc/io_time.html" xlink:title="io_time">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1064,-528.66 1010,-528.66 1010,-504.66 1064,-504.66 1064,-528.66"/>
<text text-anchor="middle" x="1037" y="-514.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_time</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~io_time -->
<g id="proc~~optics_calculate~~CallsGraph_edge26" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#ffa100" d="M249.01,-561.75C353.16,-571.13 581.43,-583.08 764,-531.66 781.62,-526.7 782.28,-516.25 800,-511.66 868.97,-493.79 953.1,-502.5 1000,-509.93"/>
<polygon fill="#ffa100" stroke="#ffa100" points="999.54,-513.4 1009.98,-511.58 1000.68,-506.49 999.54,-513.4"/>
</g>
<!-- proc~calculate_jdos -->
<g id="proc~~optics_calculate~~CallsGraph_node26" class="node">
<title>proc~calculate_jdos</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node26"><a xlink:href=".././proc/calculate_jdos.html" xlink:title="calculate_jdos">
<polygon fill="#d9534f" stroke="#d9534f" points="910,-254.66 822,-254.66 822,-230.66 910,-230.66 910,-254.66"/>
<text text-anchor="middle" x="866" y="-240.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_jdos</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~calculate_jdos -->
<g id="proc~~optics_calculate~~CallsGraph_edge24" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~calculate_jdos</title>
<path fill="none" stroke="#ffa100" d="M206.54,-543.53C219.71,-531.31 238.86,-511.23 249,-489.66 288.93,-404.77 222.7,-351.81 285,-281.66 429.35,-119.12 554.37,-125.09 764,-182.66 793.47,-190.76 823.04,-209.93 842.5,-224.44"/>
<polygon fill="#ffa100" stroke="#ffa100" points="840.37,-227.22 850.44,-230.52 844.63,-221.66 840.37,-227.22"/>
</g>
<!-- proc~setup_energy_scale -->
<g id="proc~~optics_calculate~~CallsGraph_node27" class="node">
<title>proc~setup_energy_scale</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node27"><a xlink:href=".././proc/setup_energy_scale.html" xlink:title="setup_energy_scale">
<polygon fill="#d9534f" stroke="#d9534f" points="749.5,-333.66 631.5,-333.66 631.5,-309.66 749.5,-309.66 749.5,-333.66"/>
<text text-anchor="middle" x="690.5" y="-319.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_energy_scale</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~setup_energy_scale -->
<g id="proc~~optics_calculate~~CallsGraph_edge25" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~setup_energy_scale</title>
<path fill="none" stroke="#ffa100" d="M223.2,-543.58C232.28,-538.96 241.72,-532.99 249,-525.66 273.37,-501.12 261.36,-481.92 285,-456.66 340.47,-397.4 364.84,-389.75 441,-361.66 499.59,-340.06 570.2,-330.11 621.16,-325.53"/>
<polygon fill="#ffa100" stroke="#ffa100" points="621.73,-329 631.4,-324.66 621.14,-322.02 621.73,-329"/>
</g>
<!-- proc~elec_read_band_gradient -->
<g id="proc~~optics_calculate~~CallsGraph_node28" class="node">
<title>proc~elec_read_band_gradient</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node28"><a xlink:href=".././proc/elec_read_band_gradient.html" xlink:title="elec_read_band_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="764,-683.66 617,-683.66 617,-659.66 764,-659.66 764,-683.66"/>
<text text-anchor="middle" x="690.5" y="-669.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elec_read_band_gradient</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~elec_read_band_gradient -->
<g id="proc~~optics_calculate~~CallsGraph_edge22" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~elec_read_band_gradient</title>
<path fill="none" stroke="#ffa100" d="M230.96,-567.68C279.55,-582.59 365.92,-608.18 441,-625.66 495.85,-638.44 558.18,-649.97 606.69,-658.29"/>
<polygon fill="#ffa100" stroke="#ffa100" points="606.38,-661.79 616.83,-660.01 607.56,-654.88 606.38,-661.79"/>
</g>
<!-- proc~jdos_utils_merge -->
<g id="proc~~optics_calculate~~CallsGraph_node29" class="node">
<title>proc~jdos_utils_merge</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node29"><a xlink:href=".././proc/jdos_utils_merge.html" xlink:title="jdos_utils_merge">
<polygon fill="#d9534f" stroke="#d9534f" points="396,-489.66 294,-489.66 294,-465.66 396,-465.66 396,-489.66"/>
<text text-anchor="middle" x="345" y="-475.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jdos_utils_merge</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~jdos_utils_merge -->
<g id="proc~~optics_calculate~~CallsGraph_edge27" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~jdos_utils_merge</title>
<path fill="none" stroke="#ffa100" d="M221.5,-543.62C230.5,-539.54 240.33,-534.73 249,-529.66 266.04,-519.71 267.88,-513.47 285,-503.66 291,-500.22 297.55,-496.93 304.02,-493.91"/>
<polygon fill="#ffa100" stroke="#ffa100" points="305.7,-496.99 313.38,-489.7 302.83,-490.61 305.7,-496.99"/>
</g>
<!-- proc~io_error -->
<g id="proc~~optics_calculate~~CallsGraph_node30" class="node">
<title>proc~io_error</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node30"><a xlink:href=".././proc/io_error.html" xlink:title="io_error">
<polygon fill="#d9534f" stroke="#d9534f" points="1201.5,-416.66 1147.5,-416.66 1147.5,-392.66 1201.5,-392.66 1201.5,-416.66"/>
<text text-anchor="middle" x="1174.5" y="-402.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_error</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~io_error -->
<g id="proc~~optics_calculate~~CallsGraph_edge28" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#ffa100" d="M249.12,-546.95C429.83,-519.13 989.53,-432.98 1137.38,-410.22"/>
<polygon fill="#ffa100" stroke="#ffa100" points="1137.95,-413.68 1147.3,-408.7 1136.89,-406.76 1137.95,-413.68"/>
</g>
<!-- proc~dos_utils_calculate_at_e&#45;&gt;proc~io_time -->
<g id="proc~~optics_calculate~~CallsGraph_edge30" class="edge">
<title>proc~dos_utils_calculate_at_e&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#fff100" d="M581.27,-604.31C633.31,-601.88 705.39,-593.8 764,-569.66 782.49,-562.04 781.4,-550.02 800,-542.66 866.82,-516.24 952.06,-513.74 999.66,-514.84"/>
<polygon fill="#fff100" stroke="#fff100" points="999.69,-518.35 1009.79,-515.15 999.9,-511.35 999.69,-518.35"/>
</g>
<!-- proc~dos_utils_calculate_at_e&#45;&gt;proc~elec_read_band_gradient -->
<g id="proc~~optics_calculate~~CallsGraph_edge31" class="edge">
<title>proc~dos_utils_calculate_at_e&#45;&gt;proc~elec_read_band_gradient</title>
<path fill="none" stroke="#fff100" d="M544.73,-616.73C556.23,-621.04 569.22,-625.99 581,-630.66 597.11,-637.05 600.84,-639.4 617,-645.66 626.07,-649.18 635.84,-652.79 645.18,-656.17"/>
<polygon fill="#fff100" stroke="#fff100" points="644.11,-659.5 654.7,-659.59 646.47,-652.91 644.11,-659.5"/>
</g>
<!-- proc~dos_utils_calculate_at_e&#45;&gt;proc~io_error -->
<g id="proc~~optics_calculate~~CallsGraph_edge29" class="edge">
<title>proc~dos_utils_calculate_at_e&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#fff100" d="M581.16,-605.85C631.89,-606.03 702.39,-604.85 764,-598.66 802.41,-594.8 1075.01,-560.68 1106,-537.66 1142.84,-510.3 1161.02,-457.08 1168.73,-426.92"/>
<polygon fill="#fff100" stroke="#fff100" points="1172.19,-427.48 1171.1,-416.94 1165.38,-425.85 1172.19,-427.48"/>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~io_file_unit -->
<g id="proc~~optics_calculate~~CallsGraph_edge36" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#bbff00" d="M881.18,-760.77C895.06,-773.03 916.34,-792.94 932,-812.66 971.39,-862.26 1007.62,-927.86 1025.08,-961.21"/>
<polygon fill="#bbff00" stroke="#bbff00" points="1022.16,-963.2 1029.87,-970.47 1028.38,-959.98 1022.16,-963.2"/>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~io_time -->
<g id="proc~~optics_calculate~~CallsGraph_edge32" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#bbff00" d="M875.85,-736.52C903.28,-698.85 987.12,-583.76 1021.28,-536.87"/>
<polygon fill="#bbff00" stroke="#bbff00" points="1024.18,-538.83 1027.24,-528.69 1018.52,-534.71 1024.18,-538.83"/>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~io_error -->
<g id="proc~~optics_calculate~~CallsGraph_edge33" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#bbff00" d="M915.58,-760.7C968.98,-770.79 1054.05,-777.15 1106,-731.66 1152.18,-691.23 1168.15,-493.96 1172.29,-426.97"/>
<polygon fill="#bbff00" stroke="#bbff00" points="1175.8,-426.9 1172.89,-416.71 1168.81,-426.49 1175.8,-426.9"/>
</g>
<!-- proc~algor_dist_array -->
<g id="proc~~optics_calculate~~CallsGraph_node31" class="node">
<title>proc~algor_dist_array</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node31"><a xlink:href=".././proc/algor_dist_array.html" xlink:title="algor_dist_array">
<polygon fill="#d9534f" stroke="#d9534f" points="1086,-680.66 988,-680.66 988,-656.66 1086,-656.66 1086,-680.66"/>
<text text-anchor="middle" x="1037" y="-666.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">algor_dist_array</text>
</a>
</g>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~algor_dist_array -->
<g id="proc~~optics_calculate~~CallsGraph_edge34" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~algor_dist_array</title>
<path fill="none" stroke="#bbff00" d="M884.94,-736.47C904.64,-723.51 937.51,-703.06 968,-689.66 972.43,-687.71 977.1,-685.87 981.83,-684.14"/>
<polygon fill="#bbff00" stroke="#bbff00" points="983.26,-687.35 991.57,-680.77 980.97,-680.74 983.26,-687.35"/>
</g>
<!-- interface~comms_send -->
<g id="proc~~optics_calculate~~CallsGraph_node32" class="node">
<title>interface~comms_send</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node32"><a xlink:href=".././interface/comms_send.html" xlink:title="comms_send">
<polygon fill="#a7506f" stroke="#a7506f" points="1078,-802.66 996,-802.66 996,-778.66 1078,-778.66 1078,-802.66"/>
<text text-anchor="middle" x="1037" y="-788.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">comms_send</text>
</a>
</g>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;interface~comms_send -->
<g id="proc~~optics_calculate~~CallsGraph_edge35" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;interface~comms_send</title>
<path fill="none" stroke="#bbff00" d="M915.43,-760.7C937.5,-766.18 963.62,-772.68 985.9,-778.21"/>
<polygon fill="#bbff00" stroke="#bbff00" points="985.29,-781.67 995.83,-780.68 986.97,-774.87 985.29,-781.67"/>
</g>
<!-- interface~comms_recv -->
<g id="proc~~optics_calculate~~CallsGraph_node33" class="node">
<title>interface~comms_recv</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node33"><a xlink:href=".././interface/comms_recv.html" xlink:title="comms_recv">
<polygon fill="#a7506f" stroke="#a7506f" points="1076.5,-722.66 997.5,-722.66 997.5,-698.66 1076.5,-698.66 1076.5,-722.66"/>
<text text-anchor="middle" x="1037" y="-708.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">comms_recv</text>
</a>
</g>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;interface~comms_recv -->
<g id="proc~~optics_calculate~~CallsGraph_edge37" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;interface~comms_recv</title>
<path fill="none" stroke="#bbff00" d="M920.47,-736.64C941.91,-731.82 966.45,-726.3 987.38,-721.6"/>
<polygon fill="#bbff00" stroke="#bbff00" points="988.35,-724.97 997.33,-719.36 986.81,-718.14 988.35,-724.97"/>
</g>
<!-- proc~cell_get_symmetry -->
<g id="proc~~optics_calculate~~CallsGraph_node22" class="node">
<title>proc~cell_get_symmetry</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node22"><a xlink:href=".././proc/cell_get_symmetry.html" xlink:title="cell_get_symmetry">
<polygon fill="#d9534f" stroke="#d9534f" points="746.5,-215.66 634.5,-215.66 634.5,-191.66 746.5,-191.66 746.5,-215.66"/>
<text text-anchor="middle" x="690.5" y="-201.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cell_get_symmetry</text>
</a>
</g>
</g>
<!-- proc~make_weights&#45;&gt;proc~cell_get_symmetry -->
<g id="proc~~optics_calculate~~CallsGraph_edge38" class="edge">
<title>proc~make_weights&#45;&gt;proc~cell_get_symmetry</title>
<path fill="none" stroke="#6bff00" d="M538.96,-135.81C569.5,-149.58 619.42,-172.08 653.33,-187.36"/>
<polygon fill="#6bff00" stroke="#6bff00" points="652.31,-190.74 662.87,-191.66 655.19,-184.36 652.31,-190.74"/>
</g>
<!-- proc~make_weights&#45;&gt;proc~io_error -->
<g id="proc~~optics_calculate~~CallsGraph_edge39" class="edge">
<title>proc~make_weights&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#6bff00" d="M530.79,-111.53C551.11,-99.2 584.9,-80.92 617,-73.66 828.99,-25.77 937.67,63.81 1106,-73.66 1154.19,-113.02 1168.87,-314.53 1172.48,-382.35"/>
<polygon fill="#6bff00" stroke="#6bff00" points="1168.99,-382.58 1172.98,-392.39 1175.98,-382.22 1168.99,-382.58"/>
</g>
<!-- proc~write_epsilon&#45;&gt;proc~io_file_unit -->
<g id="proc~~optics_calculate~~CallsGraph_edge40" class="edge">
<title>proc~write_epsilon&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#0086ff" d="M552.04,-1017.65C626.82,-1015.52 792.78,-1009.66 932,-996.66 951.74,-994.82 973.5,-992.01 991.99,-989.4"/>
<polygon fill="#0086ff" stroke="#0086ff" points="992.49,-992.86 1001.89,-987.97 991.49,-985.93 992.49,-992.86"/>
</g>
<!-- proc~write_refract&#45;&gt;proc~io_file_unit -->
<g id="proc~~optics_calculate~~CallsGraph_edge41" class="edge">
<title>proc~write_refract&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#1a00ff" d="M376.4,-884.72C394.85,-891.66 419,-900.08 441,-905.66 642.84,-956.9 892.31,-975.07 991.91,-980.57"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="991.74,-984.07 1001.92,-981.11 992.12,-977.08 991.74,-984.07"/>
</g>
<!-- proc~dos_utils_calculate -->
<g id="proc~~optics_calculate~~CallsGraph_node21" class="node">
<title>proc~dos_utils_calculate</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node21"><a xlink:href=".././proc/dos_utils_calculate.html" xlink:title="dos_utils_calculate">
<polygon fill="#d9534f" stroke="#d9534f" points="567,-394.66 455,-394.66 455,-370.66 567,-370.66 567,-394.66"/>
<text text-anchor="middle" x="511" y="-380.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_calculate</text>
</a>
</g>
</g>
<!-- proc~dos_utils_set_efermi&#45;&gt;proc~dos_utils_calculate -->
<g id="proc~~optics_calculate~~CallsGraph_edge45" class="edge">
<title>proc~dos_utils_set_efermi&#45;&gt;proc~dos_utils_calculate</title>
<path fill="none" stroke="#6b00ff" d="M370.91,-314.81C399.01,-328.52 444.86,-350.89 476.18,-366.16"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="474.87,-369.42 485.39,-370.66 477.94,-363.13 474.87,-369.42"/>
</g>
<!-- interface~comms_bcast -->
<g id="proc~~optics_calculate~~CallsGraph_node23" class="node">
<title>interface~comms_bcast</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node23"><a xlink:href=".././interface/comms_bcast.html" xlink:title="comms_bcast">
<polygon fill="#a7506f" stroke="#a7506f" points="908.5,-296.66 823.5,-296.66 823.5,-272.66 908.5,-272.66 908.5,-296.66"/>
<text text-anchor="middle" x="866" y="-282.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">comms_bcast</text>
</a>
</g>
</g>
<!-- proc~dos_utils_set_efermi&#45;&gt;interface~comms_bcast -->
<g id="proc~~optics_calculate~~CallsGraph_edge44" class="edge">
<title>proc~dos_utils_set_efermi&#45;&gt;interface~comms_bcast</title>
<path fill="none" stroke="#6b00ff" d="M405.07,-294.79C459.88,-287.9 543.78,-278.43 617,-274.66 682.25,-271.3 698.75,-271.44 764,-274.66 780.02,-275.45 797.43,-276.95 813.2,-278.54"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="812.99,-282.04 823.3,-279.6 813.72,-275.08 812.99,-282.04"/>
</g>
<!-- proc~dos_utils_set_efermi&#45;&gt;proc~io_error -->
<g id="proc~~optics_calculate~~CallsGraph_edge43" class="edge">
<title>proc~dos_utils_set_efermi&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#6b00ff" d="M365.42,-290.62C408.63,-264.61 516.82,-203.85 617,-182.66 718.5,-161.2 1053.63,-150.38 1106,-189.66 1167.31,-235.65 1174.31,-337.15 1174.22,-382.28"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="1170.72,-382.42 1174.08,-392.47 1177.72,-382.52 1170.72,-382.42"/>
</g>
<!-- interface~comms_reduce -->
<g id="proc~~optics_calculate~~CallsGraph_node34" class="node">
<title>interface~comms_reduce</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node34"><a xlink:href=".././interface/comms_reduce.html" xlink:title="comms_reduce">
<polygon fill="#a7506f" stroke="#a7506f" points="913,-376.66 819,-376.66 819,-352.66 913,-352.66 913,-376.66"/>
<text text-anchor="middle" x="866" y="-362.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">comms_reduce</text>
</a>
</g>
</g>
<!-- proc~dos_utils_set_efermi&#45;&gt;interface~comms_reduce -->
<g id="proc~~optics_calculate~~CallsGraph_edge42" class="edge">
<title>proc~dos_utils_set_efermi&#45;&gt;interface~comms_reduce</title>
<path fill="none" stroke="#6b00ff" d="M352.89,-315.01C366.35,-337.68 398.57,-385.32 441,-403.66 572.66,-460.57 748.33,-408.81 825.65,-380.41"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="827.32,-383.53 835.45,-376.74 824.86,-376.97 827.32,-383.53"/>
</g>
<!-- proc~write_loss_fn&#45;&gt;proc~io_file_unit -->
<g id="proc~~optics_calculate~~CallsGraph_edge46" class="edge">
<title>proc~write_loss_fn&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#bb00ff" d="M551.39,-892.03C647.01,-909.91 890.98,-955.54 991.59,-974.36"/>
<polygon fill="#bb00ff" stroke="#bb00ff" points="991.25,-977.85 1001.72,-976.25 992.53,-970.97 991.25,-977.85"/>
</g>
<!-- proc~write_reflect&#45;&gt;proc~io_file_unit -->
<g id="proc~~optics_calculate~~CallsGraph_edge47" class="edge">
<title>proc~write_reflect&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#ff00f1" d="M729.53,-1141.08C779.26,-1145.04 867.62,-1145.67 932,-1110.66 976.97,-1086.21 1009.85,-1033.48 1025.6,-1003.9"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="1028.8,-1005.32 1030.27,-994.83 1022.58,-1002.11 1028.8,-1005.32"/>
</g>
<!-- proc~elec_dealloc_optical&#45;&gt;proc~io_error -->
<g id="proc~~optics_calculate~~CallsGraph_edge48" class="edge">
<title>proc~elec_dealloc_optical&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#ff0050" d="M926.55,-898.09C981.77,-888.68 1061.87,-866.01 1106,-811.66 1154.74,-751.64 1169.28,-503.34 1172.64,-427.06"/>
<polygon fill="#ff0050" stroke="#ff0050" points="1176.15,-426.86 1173.07,-416.72 1169.16,-426.56 1176.15,-426.86"/>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;interface~comms_bcast -->
<g id="proc~~optics_calculate~~CallsGraph_edge52" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;interface~comms_bcast</title>
<path fill="none" stroke="#ff0000" d="M522.81,-370.45C540.38,-351.54 577.23,-315.8 617,-300.66 681.32,-276.18 761.77,-275.99 813.28,-279.33"/>
<polygon fill="#ff0000" stroke="#ff0000" points="813.27,-282.84 823.49,-280.07 813.77,-275.86 813.27,-282.84"/>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;proc~io_time -->
<g id="proc~~optics_calculate~~CallsGraph_edge51" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#ff0000" d="M567.17,-389.21C648.56,-399.86 804.89,-424.15 932,-466.66 957.75,-475.28 985.39,-488.78 1005.69,-499.59"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1004.29,-502.81 1014.75,-504.49 1007.62,-496.65 1004.29,-502.81"/>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;proc~elec_read_band_gradient -->
<g id="proc~~optics_calculate~~CallsGraph_edge53" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;proc~elec_read_band_gradient</title>
<path fill="none" stroke="#ff0000" d="M519.4,-394.71C546.69,-439.15 641.9,-594.16 676.67,-650.77"/>
<polygon fill="#ff0000" stroke="#ff0000" points="673.85,-652.87 682.07,-659.56 679.82,-649.21 673.85,-652.87"/>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;proc~io_error -->
<g id="proc~~optics_calculate~~CallsGraph_edge49" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#ff0000" d="M514.62,-370.47C522.86,-335.26 551.66,-232.79 617,-182.66 704.34,-115.66 1020.07,-34.87 1106,-103.66 1149.88,-138.79 1167.18,-318.66 1171.99,-382.31"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1168.51,-382.74 1172.72,-392.46 1175.49,-382.23 1168.51,-382.74"/>
</g>
<!-- proc~dos_utils_merge -->
<g id="proc~~optics_calculate~~CallsGraph_node35" class="node">
<title>proc~dos_utils_merge</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node35"><a xlink:href=".././proc/dos_utils_merge.html" xlink:title="dos_utils_merge">
<polygon fill="#d9534f" stroke="#d9534f" points="740,-375.66 641,-375.66 641,-351.66 740,-351.66 740,-375.66"/>
<text text-anchor="middle" x="690.5" y="-361.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_merge</text>
</a>
</g>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;proc~dos_utils_merge -->
<g id="proc~~optics_calculate~~CallsGraph_edge50" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;proc~dos_utils_merge</title>
<path fill="none" stroke="#ff0000" d="M567.19,-376.76C587.39,-374.59 610.3,-372.14 630.8,-369.95"/>
<polygon fill="#ff0000" stroke="#ff0000" points="631.38,-373.4 640.95,-368.86 630.64,-366.44 631.38,-373.4"/>
</g>
<!-- proc~cell_get_symmetry&#45;&gt;interface~comms_bcast -->
<g id="proc~~optics_calculate~~CallsGraph_edge55" class="edge">
<title>proc~cell_get_symmetry&#45;&gt;interface~comms_bcast</title>
<path fill="none" stroke="#ff6d00" d="M734.26,-215.7C744.38,-219.43 754.88,-224.07 764,-229.66 782.76,-241.18 781.06,-252.45 800,-263.66 804.35,-266.24 809.06,-268.54 813.88,-270.59"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="812.64,-273.86 823.23,-274.21 815.17,-267.34 812.64,-273.86"/>
</g>
<!-- proc~cell_get_symmetry&#45;&gt;proc~io_file_unit -->
<g id="proc~~optics_calculate~~CallsGraph_edge54" class="edge">
<title>proc~cell_get_symmetry&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#ff6d00" d="M704.21,-215.72C721.27,-232.79 750.92,-265.82 764,-300.66 800.75,-398.52 742.98,-682.05 800,-769.66 836.34,-825.49 881.75,-796.93 932,-840.66 973.21,-876.53 1007.59,-931.56 1024.57,-961.49"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="1021.73,-963.58 1029.65,-970.61 1027.85,-960.17 1021.73,-963.58"/>
</g>
<!-- proc~cell_get_symmetry&#45;&gt;proc~io_error -->
<g id="proc~~optics_calculate~~CallsGraph_edge56" class="edge">
<title>proc~cell_get_symmetry&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#ff6d00" d="M746.57,-198.77C845.98,-191.1 1050.29,-181.01 1106,-221.66 1158.15,-259.72 1170.06,-342.57 1172.74,-382.4"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="1169.26,-382.84 1173.29,-392.64 1176.25,-382.47 1169.26,-382.84"/>
</g>
<!-- proc~calculate_jdos&#45;&gt;proc~io_error -->
<g id="proc~~optics_calculate~~CallsGraph_edge57" class="edge">
<title>proc~calculate_jdos&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#00ff24" d="M910.03,-250.83C918.01,-253.85 925.78,-257.99 932,-263.66 962.02,-291.03 937.42,-320.93 968,-347.66 980.86,-358.9 1081.94,-383.55 1137.39,-396.44"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1136.65,-399.86 1147.18,-398.7 1138.22,-393.04 1136.65,-399.86"/>
</g>
<!-- proc~doslin -->
<g id="proc~~optics_calculate~~CallsGraph_node36" class="node">
<title>proc~doslin</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node36"><a xlink:href=".././proc/doslin.html" xlink:title="doslin">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1064,-296.66 1010,-296.66 1010,-272.66 1064,-272.66 1064,-296.66"/>
<text text-anchor="middle" x="1037" y="-282.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doslin</text>
</a>
</g>
</g>
<!-- proc~calculate_jdos&#45;&gt;proc~doslin -->
<g id="proc~~optics_calculate~~CallsGraph_edge58" class="edge">
<title>proc~calculate_jdos&#45;&gt;proc~doslin</title>
<path fill="none" stroke="#00ff24" d="M910.08,-253.37C937.88,-260.28 973.63,-269.16 999.93,-275.7"/>
<polygon fill="#00ff24" stroke="#00ff24" points="999.31,-279.15 1009.86,-278.17 1001,-272.36 999.31,-279.15"/>
</g>
<!-- proc~gaussian -->
<g id="proc~~optics_calculate~~CallsGraph_node37" class="node">
<title>proc~gaussian</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node37"><a xlink:href=".././proc/gaussian.html" xlink:title="gaussian">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1067,-254.66 1007,-254.66 1007,-230.66 1067,-230.66 1067,-254.66"/>
<text text-anchor="middle" x="1037" y="-240.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gaussian</text>
</a>
</g>
</g>
<!-- proc~calculate_jdos&#45;&gt;proc~gaussian -->
<g id="proc~~optics_calculate~~CallsGraph_edge59" class="edge">
<title>proc~calculate_jdos&#45;&gt;proc~gaussian</title>
<path fill="none" stroke="#00ff24" d="M910.08,-242.66C936.73,-242.66 970.67,-242.66 996.6,-242.66"/>
<polygon fill="#00ff24" stroke="#00ff24" points="996.82,-246.16 1006.82,-242.66 996.82,-239.16 996.82,-246.16"/>
</g>
<!-- proc~allocate_jdos -->
<g id="proc~~optics_calculate~~CallsGraph_node38" class="node">
<title>proc~allocate_jdos</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node38"><a xlink:href=".././proc/allocate_jdos.html" xlink:title="allocate_jdos">
<polygon fill="#d9534f" stroke="#d9534f" points="1078,-338.66 996,-338.66 996,-314.66 1078,-314.66 1078,-338.66"/>
<text text-anchor="middle" x="1037" y="-324.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_jdos</text>
</a>
</g>
</g>
<!-- proc~calculate_jdos&#45;&gt;proc~allocate_jdos -->
<g id="proc~~optics_calculate~~CallsGraph_edge60" class="edge">
<title>proc~calculate_jdos&#45;&gt;proc~allocate_jdos</title>
<path fill="none" stroke="#00ff24" d="M910.16,-252.9C917.78,-255.72 925.39,-259.26 932,-263.66 952.47,-277.29 947.45,-292.17 968,-305.66 973.62,-309.35 979.93,-312.42 986.37,-314.97"/>
<polygon fill="#00ff24" stroke="#00ff24" points="985.25,-318.29 995.84,-318.34 987.59,-311.69 985.25,-318.29"/>
</g>
<!-- proc~doslin_sub_cell_corners -->
<g id="proc~~optics_calculate~~CallsGraph_node39" class="node">
<title>proc~doslin_sub_cell_corners</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node39"><a xlink:href=".././proc/doslin_sub_cell_corners.html" xlink:title="doslin_sub_cell_corners">
<polygon fill="#d9534f" stroke="#d9534f" points="1106,-136.66 968,-136.66 968,-112.66 1106,-112.66 1106,-136.66"/>
<text text-anchor="middle" x="1037" y="-122.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doslin_sub_cell_corners</text>
</a>
</g>
</g>
<!-- proc~calculate_jdos&#45;&gt;proc~doslin_sub_cell_corners -->
<g id="proc~~optics_calculate~~CallsGraph_edge61" class="edge">
<title>proc~calculate_jdos&#45;&gt;proc~doslin_sub_cell_corners</title>
<path fill="none" stroke="#00ff24" d="M884.45,-230.48C914.3,-209.63 975.32,-167.03 1010.14,-142.72"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1012.2,-145.55 1018.39,-136.96 1008.19,-139.81 1012.2,-145.55"/>
</g>
<!-- proc~setup_energy_scale&#45;&gt;interface~comms_bcast -->
<g id="proc~~optics_calculate~~CallsGraph_edge63" class="edge">
<title>proc~setup_energy_scale&#45;&gt;interface~comms_bcast</title>
<path fill="none" stroke="#00ff91" d="M747.83,-309.65C768.92,-305.15 792.75,-300.07 813.39,-295.67"/>
<polygon fill="#00ff91" stroke="#00ff91" points="814.19,-299.08 823.24,-293.57 812.73,-292.23 814.19,-299.08"/>
</g>
<!-- proc~setup_energy_scale&#45;&gt;proc~io_error -->
<g id="proc~~optics_calculate~~CallsGraph_edge64" class="edge">
<title>proc~setup_energy_scale&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#00ff91" d="M749.53,-315.67C800.29,-312.98 874.66,-315.37 932,-343.66 953.15,-354.1 946.93,-372.06 968,-382.66 1022.08,-409.86 1094.13,-410.77 1136.97,-408.22"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1137.47,-411.69 1147.21,-407.51 1136.99,-404.71 1137.47,-411.69"/>
</g>
<!-- proc~setup_energy_scale&#45;&gt;interface~comms_reduce -->
<g id="proc~~optics_calculate~~CallsGraph_edge62" class="edge">
<title>proc~setup_energy_scale&#45;&gt;interface~comms_reduce</title>
<path fill="none" stroke="#00ff91" d="M740.29,-333.75C761.67,-339.05 786.89,-345.3 809.03,-350.79"/>
<polygon fill="#00ff91" stroke="#00ff91" points="808.41,-354.24 818.96,-353.25 810.09,-347.45 808.41,-354.24"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~elec_read_optical_mat -->
<g id="proc~~optics_calculate~~CallsGraph_edge72" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~elec_read_optical_mat</title>
<path fill="none" stroke="#00ffff" d="M716.3,-683.83C738.17,-694.44 770.98,-710.05 800,-722.66 807.85,-726.07 816.3,-729.58 824.43,-732.86"/>
<polygon fill="#00ffff" stroke="#00ffff" points="823.18,-736.13 833.77,-736.6 825.78,-729.63 823.18,-736.13"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~elec_dealloc_optical -->
<g id="proc~~optics_calculate~~CallsGraph_edge73" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~elec_dealloc_optical</title>
<path fill="none" stroke="#00ffff" d="M703.09,-683.92C718.85,-701.16 747,-734.11 764,-766.66 788.21,-813.01 764.34,-840.43 800,-878.66 803.16,-882.05 806.83,-885.01 810.77,-887.59"/>
<polygon fill="#00ffff" stroke="#00ffff" points="809.34,-890.8 819.78,-892.65 812.77,-884.7 809.34,-890.8"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;interface~comms_bcast -->
<g id="proc~~optics_calculate~~CallsGraph_edge65" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;interface~comms_bcast</title>
<path fill="none" stroke="#00ffff" d="M693.25,-659.37C700.16,-614.06 728.72,-453.28 800,-343.66 810.32,-327.79 825.93,-313.43 839.27,-302.85"/>
<polygon fill="#00ffff" stroke="#00ffff" points="841.39,-305.63 847.21,-296.78 837.14,-300.07 841.39,-305.63"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~io_file_unit -->
<g id="proc~~optics_calculate~~CallsGraph_edge66" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#00ffff" d="M701.94,-683.7C716.83,-701.2 744.52,-735.05 764,-766.66 783.19,-797.8 772.42,-816.64 800,-840.66 846.53,-881.18 879.01,-852.05 932,-883.66 967.69,-904.95 1001,-940.49 1019.89,-962.7"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1017.31,-965.07 1026.4,-970.5 1022.68,-960.58 1017.31,-965.07"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~io_time -->
<g id="proc~~optics_calculate~~CallsGraph_edge69" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#00ffff" d="M715.48,-659.55C737.36,-648.59 770.67,-632.16 800,-618.66 870.6,-586.18 954.34,-550.7 1000.68,-531.32"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1002.1,-534.52 1009.98,-527.44 999.41,-528.06 1002.1,-534.52"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~io_error -->
<g id="proc~~optics_calculate~~CallsGraph_edge67" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#00ffff" d="M764.32,-662.01C869.06,-646.81 1055.25,-614.45 1106,-570.66 1149.76,-532.91 1165.56,-462.53 1170.93,-426.76"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1174.4,-427.22 1172.28,-416.84 1167.46,-426.28 1174.4,-427.22"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~algor_dist_array -->
<g id="proc~~optics_calculate~~CallsGraph_edge68" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~algor_dist_array</title>
<path fill="none" stroke="#00ffff" d="M764.14,-671.03C827.64,-670.48 918.67,-669.68 977.56,-669.17"/>
<polygon fill="#00ffff" stroke="#00ffff" points="977.84,-672.67 987.81,-669.08 977.78,-665.67 977.84,-672.67"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;interface~comms_send -->
<g id="proc~~optics_calculate~~CallsGraph_edge70" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;interface~comms_send</title>
<path fill="none" stroke="#00ffff" d="M700.6,-684C717.44,-705.73 755.8,-750.36 800,-769.66 859.83,-795.79 936.18,-797.59 985.58,-795.19"/>
<polygon fill="#00ffff" stroke="#00ffff" points="985.9,-798.67 995.69,-794.62 985.51,-791.69 985.9,-798.67"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;interface~comms_recv -->
<g id="proc~~optics_calculate~~CallsGraph_edge71" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;interface~comms_recv</title>
<path fill="none" stroke="#00ffff" d="M764.14,-679.89C831.18,-687.48 928.89,-698.54 987.09,-705.13"/>
<polygon fill="#00ffff" stroke="#00ffff" points="986.81,-708.62 997.14,-706.26 987.59,-701.66 986.81,-708.62"/>
</g>
<!-- proc~jdos_utils_merge&#45;&gt;interface~comms_reduce -->
<g id="proc~~optics_calculate~~CallsGraph_edge74" class="edge">
<title>proc~jdos_utils_merge&#45;&gt;interface~comms_reduce</title>
<path fill="none" stroke="#0091ff" d="M396.23,-479.13C476.43,-479.91 637.26,-474.94 764,-429.66 793.59,-419.09 823.34,-398.44 842.81,-383.24"/>
<polygon fill="#0091ff" stroke="#0091ff" points="845.12,-385.88 850.75,-376.9 840.75,-380.41 845.12,-385.88"/>
</g>
<!-- proc~algor_dist_array&#45;&gt;proc~io_error -->
<g id="proc~~optics_calculate~~CallsGraph_edge75" class="edge">
<title>proc~algor_dist_array&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#4800ff" d="M1086.16,-656.8C1093.56,-653.24 1100.54,-648.63 1106,-642.66 1163.05,-580.31 1172.28,-473.19 1173.49,-426.97"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1176.99,-426.89 1173.65,-416.84 1170,-426.78 1176.99,-426.89"/>
</g>
<!-- proc~dos_utils_merge&#45;&gt;interface~comms_reduce -->
<g id="proc~~optics_calculate~~CallsGraph_edge76" class="edge">
<title>proc~dos_utils_merge&#45;&gt;interface~comms_reduce</title>
<path fill="none" stroke="#ff0000" d="M740.29,-363.94C761.58,-364.07 786.66,-364.21 808.73,-364.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="808.94,-367.84 818.96,-364.4 808.98,-360.84 808.94,-367.84"/>
</g>
<!-- proc~allocate_jdos&#45;&gt;proc~io_error -->
<g id="proc~~optics_calculate~~CallsGraph_edge77" class="edge">
<title>proc~allocate_jdos&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#0066ff" d="M1075.24,-338.67C1085.48,-342.56 1096.41,-347.29 1106,-352.66 1122.73,-362.04 1139.82,-375.25 1152.62,-386.01"/>
<polygon fill="#0066ff" stroke="#0066ff" points="1150.5,-388.8 1160.36,-392.66 1155.06,-383.49 1150.5,-388.8"/>
</g>
<!-- proc~heap_sort -->
<g id="proc~~optics_calculate~~CallsGraph_node40" class="node">
<title>proc~heap_sort</title>
<g id="a_proc~~optics_calculate~~CallsGraph_node40"><a xlink:href=".././proc/heap_sort.html" xlink:title="heap_sort">
<polygon fill="#d9534f" stroke="#d9534f" points="1207,-136.66 1142,-136.66 1142,-112.66 1207,-112.66 1207,-136.66"/>
<text text-anchor="middle" x="1174.5" y="-122.26" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">heap_sort</text>
</a>
</g>
</g>
<!-- proc~doslin_sub_cell_corners&#45;&gt;proc~heap_sort -->
<g id="proc~~optics_calculate~~CallsGraph_edge78" class="edge">
<title>proc~doslin_sub_cell_corners&#45;&gt;proc~heap_sort</title>
<path fill="none" stroke="#cc00ff" d="M1106.15,-124.66C1114.95,-124.66 1123.75,-124.66 1131.94,-124.66"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="1131.95,-128.16 1141.95,-124.66 1131.95,-121.16 1131.95,-128.16"/>
</g>
</g>
</svg>
</div><script>var panprocoptics_calculateCallsGraph = svgPanZoom('#procoptics_calculateCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~optics_calculate~~CalledByGraph Pages: 1 -->
<svg id="procoptics_calculateCalledByGraph" width="197pt" height="32pt"
 viewBox="0.00 0.00 197.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~optics_calculate~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~optics_calculate~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 193,-28 193,4 -4,4"/>
<!-- proc~optics_calculate -->
<g id="proc~~optics_calculate~~CalledByGraph_node1" class="node">
<title>proc~optics_calculate</title>
<polygon fill="none" stroke="black" points="189,-24 91,-24 91,0 189,0 189,-24"/>
<text text-anchor="middle" x="140" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">optics_calculate</text>
</g>
<!-- program~optados -->
<g id="proc~~optics_calculate~~CalledByGraph_node2" class="node">
<title>program~optados</title>
<g id="a_proc~~optics_calculate~~CalledByGraph_node2"><a xlink:href=".././program/optados.html" xlink:title="optados">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="55,-24 0,-24 0,0 55,0 55,-24"/>
<text text-anchor="middle" x="27.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">optados</text>
</a>
</g>
</g>
<!-- program~optados&#45;&gt;proc~optics_calculate -->
<g id="proc~~optics_calculate~~CalledByGraph_edge1" class="edge">
<title>program~optados&#45;&gt;proc~optics_calculate</title>
<path fill="none" stroke="#ff0000" d="M55.25,-12C63.05,-12 71.88,-12 80.83,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="80.91,-15.5 90.91,-12 80.91,-8.5 80.91,-15.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
        <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/optics_calculate.html#src">optics_calculate</a>
      </div>
    </div>


    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="w">  </span><span class="k">subroutine </span><span class="n">optics_calculate</span><span class="w"></span>
<span class="w">    </span><span class="c">!</span>
<span class="w">    </span><span class="c">!  Program to calculate optical properties</span>
<span class="w">    </span><span class="c">!</span>

<span class="w">    </span><span class="k">use </span><span class="n">od_electronic</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">optical_mat</span><span class="p">,</span><span class="w"> </span><span class="n">elec_read_optical_mat</span><span class="p">,</span><span class="w"> </span><span class="n">nbands</span><span class="p">,</span><span class="w"> </span><span class="n">nspins</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">efermi</span><span class="p">,</span><span class="w"> </span><span class="n">efermi_set</span><span class="p">,</span><span class="w"> </span><span class="n">elec_dealloc_optical</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_cell</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">cell_volume</span><span class="p">,</span><span class="w"> </span><span class="n">num_kpoints_on_node</span><span class="p">,</span><span class="w"> </span><span class="n">kpoint_r</span><span class="p">,</span><span class="w"> </span><span class="n">real_lattice</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_jdos_utils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">jdos_utils_calculate</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_comms</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">on_root</span><span class="p">,</span><span class="w"> </span><span class="n">my_node_id</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_parameters</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">optics_geom</span><span class="p">,</span><span class="w"> </span><span class="n">adaptive</span><span class="p">,</span><span class="w"> </span><span class="n">linear</span><span class="p">,</span><span class="w"> </span><span class="n">fixed</span><span class="p">,</span><span class="w"> </span><span class="n">optics_intraband</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">optics_drude_broadening</span><span class="p">,</span><span class="w"> </span><span class="n">photo_slab_min</span><span class="p">,</span><span class="w"> </span><span class="n">photo_slab_max</span><span class="p">,</span><span class="w"> </span><span class="n">devel_flag</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_dos_utils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dos_utils_calculate_at_e</span><span class="p">,</span><span class="w"> </span><span class="n">dos_utils_set_efermi</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_io</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">stdout</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">on_root</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(1x,a78)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;+============================================================================+&#39;</span><span class="w"></span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(1x,a78)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;+                                Optics Calculation                          +&#39;</span><span class="w"></span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(1x,a78)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;+============================================================================+&#39;</span><span class="w"></span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(1x,a78)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;|                                                                            |&#39;</span><span class="w"></span>
<span class="w">    </span><span class="k">end if</span>

<span class="k">    if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">efermi_set</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">dos_utils_set_efermi</span><span class="w"></span>

<span class="w">    </span><span class="c">! Get information from .cst_ome file</span>
<span class="w">    </span><span class="k">call </span><span class="n">elec_read_optical_mat</span><span class="w"></span>

<span class="w">    </span><span class="c">! Form matrix element</span>
<span class="w">    </span><span class="k">call </span><span class="n">make_weights</span><span class="p">(</span><span class="n">matrix_weights</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c">! Send matrix element to jDOS routine and get weighted jDOS back</span>
<span class="w">    </span><span class="k">call </span><span class="n">jdos_utils_calculate</span><span class="p">(</span><span class="n">matrix_weights</span><span class="p">,</span><span class="w"> </span><span class="n">weighted_jdos</span><span class="o">=</span><span class="n">weighted_jdos</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c">! Calculate weighted DOS at Ef for intraband term</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">optics_intraband</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dos_matrix_weights</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">matrix_weights</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span><span class="w"> </span><span class="n">nbands</span><span class="p">,</span><span class="w"> </span><span class="n">num_kpoints_on_node</span><span class="p">(</span><span class="n">my_node_id</span><span class="p">),</span><span class="w"> </span><span class="n">nspins</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dos_at_e</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">nspins</span><span class="p">))</span><span class="w"></span>
<span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">weighted_dos_at_e</span><span class="p">(</span><span class="n">nspins</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">matrix_weights</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)))</span><span class="w"></span>
<span class="w">      </span><span class="n">weighted_dos_at_e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="w"></span>
<span class="w">      </span><span class="k">do </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">matrix_weights</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">do </span><span class="n">N2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nbands</span><span class="w"></span>
<span class="w">          </span><span class="n">dos_matrix_weights</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">N2</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">matrix_weights</span><span class="p">(</span><span class="n">N2</span><span class="p">,</span><span class="w"> </span><span class="n">N2</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">N</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">end do</span>
<span class="k">      end do</span>
<span class="k">      call </span><span class="n">dos_utils_calculate_at_e</span><span class="p">(</span><span class="n">efermi</span><span class="p">,</span><span class="w"> </span><span class="n">dos_at_e</span><span class="p">,</span><span class="w"> </span><span class="n">dos_matrix_weights</span><span class="p">,</span><span class="w"> </span><span class="n">weighted_dos_at_e</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">end if</span>

<span class="k">    call </span><span class="n">elec_dealloc_optical</span><span class="w"> </span><span class="c">! don&#39;t need this large array anymore</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">on_root</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="nb">index</span><span class="p">(</span><span class="n">devel_flag</span><span class="p">,</span><span class="s1">&#39;slab_volume&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">slab_volume</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">cell_volume</span><span class="o">/</span><span class="n">real_lattice</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">photo_slab_max</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">photo_slab_min</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="c">! Calculate epsilon_2</span>
<span class="w">        </span><span class="k">call </span><span class="n">calc_epsilon_2</span><span class="p">(</span><span class="n">weighted_jdos</span><span class="p">,</span><span class="w"> </span><span class="n">weighted_dos_at_e</span><span class="p">,</span><span class="n">slab_volume</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">else</span><span class="w"></span>
<span class="w">        </span><span class="c">! Calculate epsilon_2</span>
<span class="w">        </span><span class="k">call </span><span class="n">calc_epsilon_2</span><span class="p">(</span><span class="n">weighted_jdos</span><span class="p">,</span><span class="w"> </span><span class="n">weighted_dos_at_e</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">end if</span><span class="w"></span>
<span class="w">      </span><span class="c">! Calculate epsilon_1</span>
<span class="w">      </span><span class="k">call </span><span class="n">calc_epsilon_1</span><span class="w"></span>
<span class="w">      </span><span class="c">! Calculate other optical properties</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">index</span><span class="p">(</span><span class="n">optics_geom</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;tensor&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">calc_conduct</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">calc_refract</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">calc_loss_fn</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">calc_absorp</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">calc_reflect</span><span class="w"></span>
<span class="w">      </span><span class="k">end if</span><span class="w"></span>

<span class="w">      </span><span class="c">! Write everything out</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">index</span><span class="p">(</span><span class="n">devel_flag</span><span class="p">,</span><span class="s1">&#39;slab_volume&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">write_epsilon</span><span class="p">(</span><span class="n">atom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="n">photo_volume</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slab_volume</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">else</span>
<span class="k">        call </span><span class="n">write_epsilon</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">end if</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">index</span><span class="p">(</span><span class="n">optics_geom</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;tensor&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">write_conduct</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">write_loss_fn</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">index</span><span class="p">(</span><span class="n">devel_flag</span><span class="p">,</span><span class="s1">&#39;slab_volume&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          call </span><span class="n">write_refract</span><span class="p">(</span><span class="n">atom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="n">photo_volume</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slab_volume</span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="k">call </span><span class="n">write_absorp</span><span class="p">(</span><span class="n">atom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="n">photo_volume</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slab_volume</span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="k">call </span><span class="n">write_reflect</span><span class="p">(</span><span class="n">atom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="n">photo_volume</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slab_volume</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span>
<span class="k">          call </span><span class="n">write_refract</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="k">call </span><span class="n">write_absorp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="k">call </span><span class="n">write_reflect</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">      end if</span>
<span class="k">    end if</span>

<span class="k">  end subroutine </span><span class="n">optics_calculate</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>OptaDOS was developed by The OptaDOS developers group<br>&copy; 2024 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>