<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Documentation for OptaDOS">
    <meta name="author" content="The OptaDOS developers group" >
    <link rel="icon" href="../favicon.png">

    <title>elec_read_optical_mat &ndash; OptaDOS</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">OptaDOS </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>elec_read_optical_mat
      <small>Subroutine</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title=" 1.4% of total for procedures.">95 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/electronic.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/electronic.f90.html'>electronic.f90</a></li>
              <li><a href='../module/od_electronic.html'>od_electronic</a></li>
          <li class="active">elec_read_optical_mat</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/elec_read_optical_mat.html#src">elec_read_optical_mat</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine elec_read_optical_mat()  
</h2>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/od_algorithms.html'>od_algorithms</a></li>
                <li><a href='../module/od_parameters.html'>od_parameters</a></li>
                <li><a href='../module/od_comms.html'>od_comms</a></li>
                <li><a href='../module/od_cell.html'>od_cell</a></li>
                <li><a href='../module/od_constants.html'>od_constants</a></li>
                <li><a href='../module/od_io.html'>od_io</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~elec_read_optical_mat~~UsesGraph Pages: 1 -->
<svg id="procelec_read_optical_matUsesGraph" width="618pt" height="225pt"
 viewBox="0.00 0.00 618.00 225.40" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~elec_read_optical_mat~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 221.4)">
<title>proc~~elec_read_optical_mat~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-221.4 614,-221.4 614,4 -4,4"/>
<!-- proc~elec_read_optical_mat -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_node1" class="node">
<title>proc~elec_read_optical_mat</title>
<polygon fill="none" stroke="black" points="610,-117.93 478,-117.93 478,-93.93 610,-93.93 610,-117.93"/>
<text text-anchor="middle" x="544" y="-103.53" font-family="Helvetica,sans-Serif" font-size="10.50">elec_read_optical_mat</text>
</g>
<!-- module~od_algorithms -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_node2" class="node">
<title>module~od_algorithms</title>
<g id="a_proc~~elec_read_optical_mat~~UsesGraph_node2"><a xlink:href=".././module/od_algorithms.html" xlink:title="od_algorithms">
<polygon fill="#337ab7" stroke="#337ab7" points="312,-177.93 224,-177.93 224,-153.93 312,-153.93 312,-177.93"/>
<text text-anchor="middle" x="268" y="-163.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_algorithms</text>
</a>
</g>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;module~od_algorithms -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_edge1" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;module~od_algorithms</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M394,-125.93C362.29,-128.05 328.02,-139.74 303.4,-149.94"/>
<polygon fill="#ff0000" stroke="#ff0000" points="301.96,-146.75 294.14,-153.89 304.71,-153.18 301.96,-146.75"/>
</g>
<!-- module~od_parameters -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_node3" class="node">
<title>module~od_parameters</title>
<g id="a_proc~~elec_read_optical_mat~~UsesGraph_node3"><a xlink:href=".././module/od_parameters.html" xlink:title="od_parameters">
<polygon fill="#337ab7" stroke="#337ab7" points="442,-97.93 348,-97.93 348,-73.93 442,-73.93 442,-97.93"/>
<text text-anchor="middle" x="395" y="-83.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_parameters</text>
</a>
</g>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;module~od_parameters -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_edge2" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;module~od_parameters</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M477.67,-97.05C469.16,-95.89 460.51,-94.71 452.17,-93.58"/>
<polygon fill="#ff0000" stroke="#ff0000" points="452.57,-90.1 442.19,-92.22 451.63,-97.04 452.57,-90.1"/>
</g>
<!-- module~od_comms -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_node4" class="node">
<title>module~od_comms</title>
<g id="a_proc~~elec_read_optical_mat~~UsesGraph_node4"><a xlink:href=".././module/od_comms.html" xlink:title="od_comms">
<polygon fill="#337ab7" stroke="#337ab7" points="188,-138.93 118,-138.93 118,-114.93 188,-114.93 188,-138.93"/>
<text text-anchor="middle" x="153" y="-124.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_comms</text>
</a>
</g>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;module~od_comms -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_edge4" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;module~od_comms</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M394,-125.93C325.83,-130.49 246.53,-129.62 198.32,-128.41"/>
<polygon fill="#ff0000" stroke="#ff0000" points="198.32,-124.9 188.23,-128.13 198.13,-131.9 198.32,-124.9"/>
</g>
<!-- module~od_constants -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_node5" class="node">
<title>module~od_constants</title>
<g id="a_proc~~elec_read_optical_mat~~UsesGraph_node5"><a xlink:href=".././module/od_constants.html" xlink:title="od_constants">
<polygon fill="#337ab7" stroke="#337ab7" points="82,-98.93 0,-98.93 0,-74.93 82,-74.93 82,-98.93"/>
<text text-anchor="middle" x="41" y="-84.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_constants</text>
</a>
</g>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;module~od_constants -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_edge3" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M394,-125.93C348.71,-129.35 354.19,-170.1 312,-186.93 246.31,-213.14 221.1,-228.3 154,-205.93"/>
</g>
<!-- module~od_cell -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_node6" class="node">
<title>module~od_cell</title>
<g id="a_proc~~elec_read_optical_mat~~UsesGraph_node6"><a xlink:href=".././module/od_cell.html" xlink:title="od_cell">
<polygon fill="#337ab7" stroke="#337ab7" points="295,-97.93 241,-97.93 241,-73.93 295,-73.93 295,-97.93"/>
<text text-anchor="middle" x="268" y="-83.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_cell</text>
</a>
</g>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;module~od_cell -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_edge5" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;module~od_cell</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M394,-125.93C360.48,-128.17 324.11,-114.57 299.29,-102.62"/>
<polygon fill="#ff0000" stroke="#ff0000" points="300.56,-99.34 290.05,-98 297.43,-105.6 300.56,-99.34"/>
</g>
<!-- module~od_io -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_node7" class="node">
<title>module~od_io</title>
<g id="a_proc~~elec_read_optical_mat~~UsesGraph_node7"><a xlink:href=".././module/od_io.html" xlink:title="od_io">
<polygon fill="#337ab7" stroke="#337ab7" points="180,-58.93 126,-58.93 126,-34.93 180,-34.93 180,-58.93"/>
<text text-anchor="middle" x="153" y="-44.53" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_io</text>
</a>
</g>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;module~od_io -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_edge6" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;module~od_io</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M477.7,-116.71C452.27,-120.4 422.85,-124.08 396,-125.93"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M394,-125.93C371.93,-127.46 365.91,-119.91 348,-106.93 328.09,-92.51 333.72,-76.46 312,-64.93 274.04,-44.79 223.83,-42.49 190.3,-43.78"/>
<polygon fill="#ff0000" stroke="#ff0000" points="189.84,-40.3 180.04,-44.31 190.2,-47.29 189.84,-40.3"/>
</g>
<!-- module~od_algorithms&#45;&gt;module~od_constants -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_edge7" class="edge">
<title>module~od_algorithms&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M243.48,-178.1C215.63,-191.82 170.88,-211.56 154,-205.93"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M152,-205.93C104.04,-189.95 69.21,-137.78 52.71,-108.09"/>
<polygon fill="#ff0000" stroke="#ff0000" points="55.63,-106.13 47.83,-98.97 49.46,-109.44 55.63,-106.13"/>
</g>
<!-- module~od_parameters&#45;&gt;module~od_constants -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_edge10" class="edge">
<title>module~od_parameters&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M381.92,-73.81C361.1,-54.03 316.12,-16.1 269,-6.93"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M267,-6.93C201.47,5.81 179.45,0.16 118,-25.93 95.66,-35.42 74.5,-53.43 60.2,-67.43"/>
<polygon fill="#ffff00" stroke="#ffff00" points="57.54,-65.14 53.01,-74.71 62.52,-70.06 57.54,-65.14"/>
</g>
<!-- module~od_parameters&#45;&gt;module~od_cell -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_edge8" class="edge">
<title>module~od_parameters&#45;&gt;module~od_cell</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M347.81,-85.93C333.76,-85.93 318.53,-85.93 305.24,-85.93"/>
<polygon fill="#ffff00" stroke="#ffff00" points="305.05,-82.43 295.05,-85.93 305.05,-89.43 305.05,-82.43"/>
</g>
<!-- module~od_parameters&#45;&gt;module~od_io -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_edge9" class="edge">
<title>module~od_parameters&#45;&gt;module~od_io</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M267,-6.93C235.94,-0.89 201.91,-16.14 179.4,-29.52"/>
<polygon fill="#ffff00" stroke="#ffff00" points="177.43,-26.62 170.79,-34.88 181.13,-32.56 177.43,-26.62"/>
</g>
<!-- module~od_comms&#45;&gt;module~od_constants -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_edge11" class="edge">
<title>module~od_comms&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M119,-114.93C108.33,-111.05 96.33,-106.69 85.05,-102.59"/>
<polygon fill="#00ff00" stroke="#00ff00" points="85.95,-99.19 75.36,-99.07 83.56,-105.77 85.95,-99.19"/>
</g>
<!-- module~od_cell&#45;&gt;module~od_constants -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_edge13" class="edge">
<title>module~od_cell&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M240.75,-86.05C204.43,-86.21 138.14,-86.51 92.16,-86.71"/>
<polygon fill="#0000ff" stroke="#0000ff" points="92.08,-83.21 82.09,-86.76 92.11,-90.21 92.08,-83.21"/>
</g>
<!-- module~od_cell&#45;&gt;module~od_io -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_edge12" class="edge">
<title>module~od_cell&#45;&gt;module~od_io</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M240.79,-76.89C225.67,-71.67 206.45,-65.04 189.94,-59.34"/>
<polygon fill="#0000ff" stroke="#0000ff" points="190.66,-55.88 180.07,-55.93 188.38,-62.5 190.66,-55.88"/>
</g>
<!-- module~od_io&#45;&gt;module~od_constants -->
<g id="proc~~elec_read_optical_mat~~UsesGraph_edge14" class="edge">
<title>module~od_io&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M125.93,-56.41C113.76,-60.84 98.96,-66.22 85.18,-71.23"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="83.6,-68.08 75.39,-74.79 85.99,-74.66 83.6,-68.08"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>



    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~elec_read_optical_mat~~CallsGraph Pages: 1 -->
<svg id="procelec_read_optical_matCallsGraph" width="364pt" height="238pt"
 viewBox="0.00 0.00 364.00 238.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~elec_read_optical_mat~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 234)">
<title>proc~~elec_read_optical_mat~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-234 360,-234 360,4 -4,4"/>
<!-- proc~elec_read_optical_mat -->
<g id="proc~~elec_read_optical_mat~~CallsGraph_node1" class="node">
<title>proc~elec_read_optical_mat</title>
<polygon fill="none" stroke="black" points="132,-125 0,-125 0,-101 132,-101 132,-125"/>
<text text-anchor="middle" x="66" y="-110.6" font-family="Helvetica,sans-Serif" font-size="10.50">elec_read_optical_mat</text>
</g>
<!-- proc~io_time -->
<g id="proc~~elec_read_optical_mat~~CallsGraph_node2" class="node">
<title>proc~io_time</title>
<g id="a_proc~~elec_read_optical_mat~~CallsGraph_node2"><a xlink:href=".././proc/io_time.html" xlink:title="io_time">
<polygon fill="#d94e8f" stroke="#d94e8f" points="244,-230 190,-230 190,-206 244,-206 244,-230"/>
<text text-anchor="middle" x="217" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_time</text>
</a>
</g>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~io_time -->
<g id="proc~~elec_read_optical_mat~~CallsGraph_edge1" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#ff0000" d="M79.18,-125.11C97.33,-142.67 133.07,-175.43 168,-197 171.94,-199.43 176.21,-201.73 180.52,-203.84"/>
<polygon fill="#ff0000" stroke="#ff0000" points="179.37,-207.16 189.92,-208.17 182.3,-200.81 179.37,-207.16"/>
</g>
<!-- proc~io_file_unit -->
<g id="proc~~elec_read_optical_mat~~CallsGraph_node3" class="node">
<title>proc~io_file_unit</title>
<g id="a_proc~~elec_read_optical_mat~~CallsGraph_node3"><a xlink:href=".././proc/io_file_unit.html" xlink:title="io_file_unit">
<polygon fill="#d94e8f" stroke="#d94e8f" points="252,-188 182,-188 182,-164 252,-164 252,-188"/>
<text text-anchor="middle" x="217" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_file_unit</text>
</a>
</g>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~io_file_unit -->
<g id="proc~~elec_read_optical_mat~~CallsGraph_edge5" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#ff0000" d="M95.73,-125.15C119.2,-135.07 152.57,-149.18 178.2,-160.02"/>
<polygon fill="#ff0000" stroke="#ff0000" points="177.04,-163.33 187.61,-164 179.77,-156.88 177.04,-163.33"/>
</g>
<!-- proc~algor_dist_array -->
<g id="proc~~elec_read_optical_mat~~CallsGraph_node4" class="node">
<title>proc~algor_dist_array</title>
<g id="a_proc~~elec_read_optical_mat~~CallsGraph_node4"><a xlink:href=".././proc/algor_dist_array.html" xlink:title="algor_dist_array">
<polygon fill="#d9534f" stroke="#d9534f" points="266,-146 168,-146 168,-122 266,-122 266,-146"/>
<text text-anchor="middle" x="217" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">algor_dist_array</text>
</a>
</g>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~algor_dist_array -->
<g id="proc~~elec_read_optical_mat~~CallsGraph_edge3" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~algor_dist_array</title>
<path fill="none" stroke="#ff0000" d="M132.35,-122.21C140.8,-123.4 149.41,-124.62 157.74,-125.79"/>
<polygon fill="#ff0000" stroke="#ff0000" points="157.33,-129.27 167.72,-127.2 158.31,-122.33 157.33,-129.27"/>
</g>
<!-- interface~comms_send -->
<g id="proc~~elec_read_optical_mat~~CallsGraph_node5" class="node">
<title>interface~comms_send</title>
<g id="a_proc~~elec_read_optical_mat~~CallsGraph_node5"><a xlink:href=".././interface/comms_send.html" xlink:title="comms_send">
<polygon fill="#a7506f" stroke="#a7506f" points="258,-104 176,-104 176,-80 258,-80 258,-104"/>
<text text-anchor="middle" x="217" y="-89.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">comms_send</text>
</a>
</g>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;interface~comms_send -->
<g id="proc~~elec_read_optical_mat~~CallsGraph_edge4" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;interface~comms_send</title>
<path fill="none" stroke="#ff0000" d="M132.35,-103.79C143.61,-102.2 155.15,-100.58 165.93,-99.06"/>
<polygon fill="#ff0000" stroke="#ff0000" points="166.58,-102.5 175.99,-97.64 165.6,-95.57 166.58,-102.5"/>
</g>
<!-- proc~io_error -->
<g id="proc~~elec_read_optical_mat~~CallsGraph_node6" class="node">
<title>proc~io_error</title>
<g id="a_proc~~elec_read_optical_mat~~CallsGraph_node6"><a xlink:href=".././proc/io_error.html" xlink:title="io_error">
<polygon fill="#d9534f" stroke="#d9534f" points="356,-105 302,-105 302,-81 356,-81 356,-105"/>
<text text-anchor="middle" x="329" y="-90.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_error</text>
</a>
</g>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~io_error -->
<g id="proc~~elec_read_optical_mat~~CallsGraph_edge2" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#ff0000" d="M89.06,-100.84C109,-90.58 139.51,-76.69 168,-71 210.71,-62.47 223.08,-63.61 266,-71 274.74,-72.5 283.88,-75.12 292.37,-78.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="291.39,-81.4 301.98,-81.54 293.79,-74.82 291.39,-81.4"/>
</g>
<!-- interface~comms_recv -->
<g id="proc~~elec_read_optical_mat~~CallsGraph_node7" class="node">
<title>interface~comms_recv</title>
<g id="a_proc~~elec_read_optical_mat~~CallsGraph_node7"><a xlink:href=".././interface/comms_recv.html" xlink:title="comms_recv">
<polygon fill="#a7506f" stroke="#a7506f" points="256.5,-24 177.5,-24 177.5,0 256.5,0 256.5,-24"/>
<text text-anchor="middle" x="217" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">comms_recv</text>
</a>
</g>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;interface~comms_recv -->
<g id="proc~~elec_read_optical_mat~~CallsGraph_edge6" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;interface~comms_recv</title>
<path fill="none" stroke="#ff0000" d="M81.92,-100.87C101.22,-85.42 136.14,-58.31 168,-38 172.79,-34.94 177.98,-31.89 183.11,-29.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="185.09,-31.91 192.18,-24.04 181.73,-25.77 185.09,-31.91"/>
</g>
<!-- proc~algor_dist_array&#45;&gt;proc~io_error -->
<g id="proc~~elec_read_optical_mat~~CallsGraph_edge7" class="edge">
<title>proc~algor_dist_array&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#00ff00" d="M250.41,-121.92C263.57,-117.02 278.81,-111.33 292.29,-106.31"/>
<polygon fill="#00ff00" stroke="#00ff00" points="293.58,-109.56 301.73,-102.79 291.14,-103 293.58,-109.56"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~elec_read_optical_mat~~CalledByGraph Pages: 1 -->
<svg id="procelec_read_optical_matCalledByGraph" width="641pt" height="186pt"
 viewBox="0.00 0.00 641.00 186.13" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~elec_read_optical_mat~~CalledByGraph" class="graph" transform="scale(1.72 1.72) rotate(0) translate(4 316)">
<title>proc~~elec_read_optical_mat~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-316 1098,-316 1098,4 -4,4"/>
<!-- proc~elec_read_optical_mat -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node1" class="node">
<title>proc~elec_read_optical_mat</title>
<polygon fill="none" stroke="black" points="1094,-52 962,-52 962,-28 1094,-28 1094,-52"/>
<text text-anchor="middle" x="1028" y="-37.6" font-family="Helvetica,sans-Serif" font-size="10.50">elec_read_optical_mat</text>
</g>
<!-- proc~elec_read_band_gradient -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node2" class="node">
<title>proc~elec_read_band_gradient</title>
<g id="a_proc~~elec_read_optical_mat~~CalledByGraph_node2"><a xlink:href=".././proc/elec_read_band_gradient.html" xlink:title="elec_read_band_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="926,-132 779,-132 779,-108 926,-108 926,-132"/>
<text text-anchor="middle" x="852.5" y="-117.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elec_read_band_gradient</text>
</a>
</g>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~elec_read_optical_mat -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge1" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~elec_read_optical_mat</title>
<path fill="none" stroke="#ff0000" d="M879.85,-107.85C909.7,-94.08 958.5,-71.58 991.65,-56.3"/>
<polygon fill="#ff0000" stroke="#ff0000" points="993.35,-59.37 1000.97,-52 990.42,-53.01 993.35,-59.37"/>
</g>
<!-- proc~read_ome_bin -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node3" class="node">
<title>proc~read_ome_bin</title>
<g id="a_proc~~elec_read_optical_mat~~CalledByGraph_node3"><a xlink:href=".././proc/read_ome_bin.html" xlink:title="read_ome_bin">
<polygon fill="#d9534f" stroke="#d9534f" points="896.5,-52 808.5,-52 808.5,-28 896.5,-28 896.5,-52"/>
<text text-anchor="middle" x="852.5" y="-37.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_ome_bin</text>
</a>
</g>
</g>
<!-- proc~read_ome_bin&#45;&gt;proc~elec_read_optical_mat -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge2" class="edge">
<title>proc~read_ome_bin&#45;&gt;proc~elec_read_optical_mat</title>
<path fill="none" stroke="#ff0000" d="M896.83,-40C913.51,-40 933.07,-40 951.88,-40"/>
<polygon fill="#ff0000" stroke="#ff0000" points="951.94,-43.5 961.94,-40 951.94,-36.5 951.94,-43.5"/>
</g>
<!-- proc~optics_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node4" class="node">
<title>proc~optics_calculate</title>
<g id="a_proc~~elec_read_optical_mat~~CalledByGraph_node4"><a xlink:href=".././proc/optics_calculate.html" xlink:title="optics_calculate">
<polygon fill="#d9534f" stroke="#d9534f" points="189,-188 91,-188 91,-164 189,-164 189,-188"/>
<text text-anchor="middle" x="140" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">optics_calculate</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~elec_read_optical_mat -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge3" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~elec_read_optical_mat</title>
<path fill="none" stroke="#ff0000" d="M149.55,-163.9C163.48,-144.92 192.77,-107.95 225,-85 319.06,-18.03 355.03,0 470.5,0 470.5,0 470.5,0 674,0 786.32,0 814.78,-3.31 926,-19 938.93,-20.82 952.69,-23.31 965.75,-25.94"/>
<polygon fill="#ff0000" stroke="#ff0000" points="965.08,-29.37 975.59,-27.97 966.5,-22.52 965.08,-29.37"/>
</g>
<!-- proc~jdos_utils_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node6" class="node">
<title>proc~jdos_utils_calculate</title>
<g id="a_proc~~elec_read_optical_mat~~CalledByGraph_node6"><a xlink:href=".././proc/jdos_utils_calculate.html" xlink:title="jdos_utils_calculate">
<polygon fill="#d9534f" stroke="#d9534f" points="340,-190 225,-190 225,-166 340,-166 340,-190"/>
<text text-anchor="middle" x="282.5" y="-175.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jdos_utils_calculate</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~jdos_utils_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge15" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~jdos_utils_calculate</title>
<path fill="none" stroke="#ffff00" d="M189.35,-176.69C197.57,-176.81 206.23,-176.93 214.82,-177.05"/>
<polygon fill="#ffff00" stroke="#ffff00" points="214.79,-180.55 224.83,-177.19 214.89,-173.55 214.79,-180.55"/>
</g>
<!-- proc~dos_utils_calculate_at_e -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node8" class="node">
<title>proc~dos_utils_calculate_at_e</title>
<g id="a_proc~~elec_read_optical_mat~~CalledByGraph_node8"><a xlink:href=".././proc/dos_utils_calculate_at_e.html" xlink:title="dos_utils_calculate_at_e">
<polygon fill="#d9534f" stroke="#d9534f" points="743,-132 603,-132 603,-108 743,-108 743,-132"/>
<text text-anchor="middle" x="673" y="-117.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_calculate_at_e</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~dos_utils_calculate_at_e -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge17" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~dos_utils_calculate_at_e</title>
<path fill="none" stroke="#00ffff" d="M153.12,-163.95C168.42,-149.56 196.23,-126.05 225,-115 355.97,-64.68 524.88,-87.92 612.83,-105.93"/>
<polygon fill="#00ffff" stroke="#00ffff" points="612.12,-109.35 622.63,-107.98 613.56,-102.5 612.12,-109.35"/>
</g>
<!-- proc~dos_utils_set_efermi -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node13" class="node">
<title>proc~dos_utils_set_efermi</title>
<g id="a_proc~~elec_read_optical_mat~~CalledByGraph_node13"><a xlink:href=".././proc/dos_utils_set_efermi.html" xlink:title="dos_utils_set_efermi">
<polygon fill="#d9534f" stroke="#d9534f" points="531.5,-250 411.5,-250 411.5,-226 531.5,-226 531.5,-250"/>
<text text-anchor="middle" x="471.5" y="-235.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_set_efermi</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~dos_utils_set_efermi -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge23" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~dos_utils_set_efermi</title>
<path fill="none" stroke="#00ff00" d="M181.37,-188.02C195.13,-191.86 210.66,-195.91 225,-199 284.1,-211.75 352.04,-222.22 401.44,-229.09"/>
<polygon fill="#00ff00" stroke="#00ff00" points="401,-232.57 411.38,-230.46 401.95,-225.63 401,-232.57"/>
</g>
<!-- proc~dos_utils_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node5" class="node">
<title>proc~dos_utils_calculate</title>
<g id="a_proc~~elec_read_optical_mat~~CalledByGraph_node5"><a xlink:href=".././proc/dos_utils_calculate.html" xlink:title="dos_utils_calculate">
<polygon fill="#d9534f" stroke="#d9534f" points="729,-250 617,-250 617,-226 729,-226 729,-250"/>
<text text-anchor="middle" x="673" y="-235.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_calculate</text>
</a>
</g>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;proc~elec_read_band_gradient -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge4" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;proc~elec_read_band_gradient</title>
<path fill="none" stroke="#ff0000" d="M692.33,-225.82C723.76,-204.92 788.11,-162.14 824.62,-137.87"/>
<polygon fill="#ff0000" stroke="#ff0000" points="826.88,-140.57 833.27,-132.12 823.01,-134.74 826.88,-140.57"/>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~elec_read_band_gradient -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge5" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~elec_read_band_gradient</title>
<path fill="none" stroke="#ff0000" d="M340.31,-175.45C427.32,-171.1 598.68,-160.71 743,-141 756.84,-139.11 771.59,-136.59 785.61,-133.96"/>
<polygon fill="#ff0000" stroke="#ff0000" points="786.5,-137.36 795.66,-132.04 785.18,-130.48 786.5,-137.36"/>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~dos_utils_set_efermi -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge22" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~dos_utils_set_efermi</title>
<path fill="none" stroke="#00ff00" d="M314.53,-190.14C332.38,-196.94 355.31,-205.36 376,-212 388.15,-215.9 401.28,-219.74 413.79,-223.23"/>
<polygon fill="#00ff00" stroke="#00ff00" points="413.08,-226.66 423.65,-225.94 414.93,-219.91 413.08,-226.66"/>
</g>
<!-- program~od2od -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node7" class="node">
<title>program~od2od</title>
<g id="a_proc~~elec_read_optical_mat~~CalledByGraph_node7"><a xlink:href=".././program/od2od.html" xlink:title="od2od">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="498.5,-52 444.5,-52 444.5,-28 498.5,-28 498.5,-52"/>
<text text-anchor="middle" x="471.5" y="-37.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od2od</text>
</a>
</g>
</g>
<!-- program~od2od&#45;&gt;proc~read_ome_bin -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge8" class="edge">
<title>program~od2od&#45;&gt;proc~read_ome_bin</title>
<path fill="none" stroke="#00ff00" d="M498.55,-40C560.14,-40 715.71,-40 798.22,-40"/>
<polygon fill="#00ff00" stroke="#00ff00" points="798.39,-43.5 808.39,-40 798.39,-36.5 798.39,-43.5"/>
</g>
<!-- proc~read_dome_bin -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node9" class="node">
<title>proc~read_dome_bin</title>
<g id="a_proc~~elec_read_optical_mat~~CalledByGraph_node9"><a xlink:href=".././proc/read_dome_bin.html" xlink:title="read_dome_bin">
<polygon fill="#d9534f" stroke="#d9534f" points="720,-90 626,-90 626,-66 720,-66 720,-90"/>
<text text-anchor="middle" x="673" y="-75.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_dome_bin</text>
</a>
</g>
</g>
<!-- program~od2od&#45;&gt;proc~read_dome_bin -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge18" class="edge">
<title>program~od2od&#45;&gt;proc~read_dome_bin</title>
<path fill="none" stroke="#0000ff" d="M498.58,-44.97C528.15,-50.6 577.24,-59.95 615.66,-67.27"/>
<polygon fill="#0000ff" stroke="#0000ff" points="615.2,-70.74 625.68,-69.18 616.51,-63.87 615.2,-70.74"/>
</g>
<!-- proc~dos_utils_calculate_at_e&#45;&gt;proc~elec_read_band_gradient -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge6" class="edge">
<title>proc~dos_utils_calculate_at_e&#45;&gt;proc~elec_read_band_gradient</title>
<path fill="none" stroke="#ff0000" d="M743.13,-120C751.53,-120 760.17,-120 768.74,-120"/>
<polygon fill="#ff0000" stroke="#ff0000" points="768.74,-123.5 778.74,-120 768.74,-116.5 768.74,-123.5"/>
</g>
<!-- proc~read_dome_bin&#45;&gt;proc~elec_read_band_gradient -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge7" class="edge">
<title>proc~read_dome_bin&#45;&gt;proc~elec_read_band_gradient</title>
<path fill="none" stroke="#ff0000" d="M720.17,-88.93C741.65,-94.01 767.48,-100.12 790.53,-105.57"/>
<polygon fill="#ff0000" stroke="#ff0000" points="790.02,-109.05 800.56,-107.95 791.64,-102.24 790.02,-109.05"/>
</g>
<!-- program~optados -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node10" class="node">
<title>program~optados</title>
<g id="a_proc~~elec_read_optical_mat~~CalledByGraph_node10"><a xlink:href=".././program/optados.html" xlink:title="optados">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="55,-230 0,-230 0,-206 55,-206 55,-230"/>
<text text-anchor="middle" x="27.5" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">optados</text>
</a>
</g>
</g>
<!-- program~optados&#45;&gt;proc~optics_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge9" class="edge">
<title>program~optados&#45;&gt;proc~optics_calculate</title>
<path fill="none" stroke="#0000ff" d="M55.25,-207.83C68.02,-202.98 83.58,-197.07 97.81,-191.66"/>
<polygon fill="#0000ff" stroke="#0000ff" points="99.29,-194.84 107.4,-188.01 96.8,-188.29 99.29,-194.84"/>
</g>
<!-- proc~pdos_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node11" class="node">
<title>proc~pdos_calculate</title>
<g id="a_proc~~elec_read_optical_mat~~CalledByGraph_node11"><a xlink:href=".././proc/pdos_calculate.html" xlink:title="pdos_calculate">
<polygon fill="#d9534f" stroke="#d9534f" points="328.5,-312 236.5,-312 236.5,-288 328.5,-288 328.5,-312"/>
<text text-anchor="middle" x="282.5" y="-297.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pdos_calculate</text>
</a>
</g>
</g>
<!-- program~optados&#45;&gt;proc~pdos_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge19" class="edge">
<title>program~optados&#45;&gt;proc~pdos_calculate</title>
<path fill="none" stroke="#ff0000" d="M43.52,-230.15C55.65,-239.38 73.52,-251.69 91,-259 134.55,-277.22 187.21,-287.76 226.13,-293.58"/>
<polygon fill="#ff0000" stroke="#ff0000" points="225.82,-297.07 236.21,-295.03 226.81,-290.14 225.82,-297.07"/>
</g>
<!-- proc~core_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node12" class="node">
<title>proc~core_calculate</title>
<g id="a_proc~~elec_read_optical_mat~~CalledByGraph_node12"><a xlink:href=".././proc/core_calculate.html" xlink:title="core_calculate">
<polygon fill="#d9534f" stroke="#d9534f" points="327.5,-270 237.5,-270 237.5,-246 327.5,-246 327.5,-270"/>
<text text-anchor="middle" x="282.5" y="-255.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">core_calculate</text>
</a>
</g>
</g>
<!-- program~optados&#45;&gt;proc~core_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge20" class="edge">
<title>program~optados&#45;&gt;proc~core_calculate</title>
<path fill="none" stroke="#ffff00" d="M55.2,-228.44C66.14,-232.33 79.03,-236.43 91,-239 136.15,-248.71 188.4,-253.47 226.75,-255.8"/>
<polygon fill="#ffff00" stroke="#ffff00" points="227,-259.32 237.18,-256.4 227.4,-252.33 227,-259.32"/>
</g>
<!-- proc~jdos_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node14" class="node">
<title>proc~jdos_calculate</title>
<g id="a_proc~~elec_read_optical_mat~~CalledByGraph_node14"><a xlink:href=".././proc/jdos_calculate.html" xlink:title="jdos_calculate">
<polygon fill="#d9534f" stroke="#d9534f" points="184,-230 96,-230 96,-206 184,-206 184,-230"/>
<text text-anchor="middle" x="140" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jdos_calculate</text>
</a>
</g>
</g>
<!-- program~optados&#45;&gt;proc~jdos_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge26" class="edge">
<title>program~optados&#45;&gt;proc~jdos_calculate</title>
<path fill="none" stroke="#00ffff" d="M55.25,-218C64.45,-218 75.09,-218 85.65,-218"/>
<polygon fill="#00ffff" stroke="#00ffff" points="85.69,-221.5 95.69,-218 85.69,-214.5 85.69,-221.5"/>
</g>
<!-- proc~dos_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node15" class="node">
<title>proc~dos_calculate</title>
<g id="a_proc~~elec_read_optical_mat~~CalledByGraph_node15"><a xlink:href=".././proc/dos_calculate.html" xlink:title="dos_calculate">
<polygon fill="#d9534f" stroke="#d9534f" points="325,-148 240,-148 240,-124 325,-124 325,-148"/>
<text text-anchor="middle" x="282.5" y="-133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_calculate</text>
</a>
</g>
</g>
<!-- program~optados&#45;&gt;proc~dos_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge27" class="edge">
<title>program~optados&#45;&gt;proc~dos_calculate</title>
<path fill="none" stroke="#0000ff" d="M36.54,-205.78C47.09,-190.92 67.07,-166.39 91,-155 134.62,-134.23 190.11,-130.92 229.94,-131.94"/>
<polygon fill="#0000ff" stroke="#0000ff" points="229.85,-135.44 239.97,-132.3 230.1,-128.44 229.85,-135.44"/>
</g>
<!-- proc~pdos_calculate&#45;&gt;proc~dos_utils_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge10" class="edge">
<title>proc~pdos_calculate&#45;&gt;proc~dos_utils_calculate</title>
<path fill="none" stroke="#ff0000" d="M328.68,-299.17C385.05,-297.38 484.11,-291.74 567,-274 589.41,-269.2 613.65,-261.1 633.19,-253.79"/>
<polygon fill="#ff0000" stroke="#ff0000" points="634.57,-257.01 642.66,-250.17 632.07,-250.47 634.57,-257.01"/>
</g>
<!-- proc~pdos_calculate&#45;&gt;proc~dos_utils_set_efermi -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge21" class="edge">
<title>proc~pdos_calculate&#45;&gt;proc~dos_utils_set_efermi</title>
<path fill="none" stroke="#00ff00" d="M320,-287.9C349.86,-278 392.26,-263.94 424.46,-253.27"/>
<polygon fill="#00ff00" stroke="#00ff00" points="425.7,-256.54 434.09,-250.07 423.5,-249.9 425.7,-256.54"/>
</g>
<!-- proc~core_calculate&#45;&gt;proc~dos_utils_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge13" class="edge">
<title>proc~core_calculate&#45;&gt;proc~dos_utils_calculate</title>
<path fill="none" stroke="#ff0000" d="M327.73,-258.58C343.02,-258.75 360.26,-258.91 376,-259 460.89,-259.46 482.52,-267.36 567,-259 581.81,-257.53 597.62,-254.93 612.36,-252.05"/>
<polygon fill="#ff0000" stroke="#ff0000" points="613.26,-255.44 622.36,-250.02 611.87,-248.58 613.26,-255.44"/>
</g>
<!-- proc~core_calculate&#45;&gt;proc~dos_utils_set_efermi -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge25" class="edge">
<title>proc~core_calculate&#45;&gt;proc~dos_utils_set_efermi</title>
<path fill="none" stroke="#00ff00" d="M327.82,-253.26C349.74,-250.92 376.72,-248.03 401.29,-245.4"/>
<polygon fill="#00ff00" stroke="#00ff00" points="401.71,-248.88 411.29,-244.33 400.97,-241.92 401.71,-248.88"/>
</g>
<!-- proc~dos_utils_set_efermi&#45;&gt;proc~dos_utils_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge12" class="edge">
<title>proc~dos_utils_set_efermi&#45;&gt;proc~dos_utils_calculate</title>
<path fill="none" stroke="#ff0000" d="M531.55,-238C555.17,-238 582.48,-238 606.69,-238"/>
<polygon fill="#ff0000" stroke="#ff0000" points="606.86,-241.5 616.86,-238 606.86,-234.5 606.86,-241.5"/>
</g>
<!-- proc~jdos_calculate&#45;&gt;proc~jdos_utils_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge14" class="edge">
<title>proc~jdos_calculate&#45;&gt;proc~jdos_utils_calculate</title>
<path fill="none" stroke="#ffff00" d="M183.15,-206C197.61,-201.88 213.96,-197.23 229.13,-192.91"/>
<polygon fill="#ffff00" stroke="#ffff00" points="230.23,-196.24 238.89,-190.13 228.31,-189.5 230.23,-196.24"/>
</g>
<!-- proc~dos_calculate&#45;&gt;proc~dos_utils_calculate -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge11" class="edge">
<title>proc~dos_calculate&#45;&gt;proc~dos_utils_calculate</title>
<path fill="none" stroke="#ff0000" d="M325.08,-146.92C395.38,-165.37 537.75,-202.75 616.49,-223.43"/>
<polygon fill="#ff0000" stroke="#ff0000" points="615.68,-226.83 626.24,-225.99 617.45,-220.06 615.68,-226.83"/>
</g>
<!-- proc~dos_calculate&#45;&gt;proc~dos_utils_set_efermi -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge24" class="edge">
<title>proc~dos_calculate&#45;&gt;proc~dos_utils_set_efermi</title>
<path fill="none" stroke="#00ff00" d="M325.27,-148.01C330.52,-150.5 335.58,-153.48 340,-157 362.84,-175.22 352.39,-194.79 376,-212 383.65,-217.58 392.45,-221.96 401.52,-225.4"/>
<polygon fill="#00ff00" stroke="#00ff00" points="400.45,-228.74 411.05,-228.66 402.72,-222.11 400.45,-228.74"/>
</g>
<!-- proc~dos_utils_compute_dos_at_efermi -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_node16" class="node">
<title>proc~dos_utils_compute_dos_at_efermi</title>
<g id="a_proc~~elec_read_optical_mat~~CalledByGraph_node16"><a xlink:href=".././proc/dos_utils_compute_dos_at_efermi.html" xlink:title="dos_utils_compute_dos_at_efermi">
<polygon fill="#d9534f" stroke="#d9534f" points="567,-132 376,-132 376,-108 567,-108 567,-132"/>
<text text-anchor="middle" x="471.5" y="-117.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_compute_dos_at_efermi</text>
</a>
</g>
</g>
<!-- proc~dos_calculate&#45;&gt;proc~dos_utils_compute_dos_at_efermi -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge28" class="edge">
<title>proc~dos_calculate&#45;&gt;proc~dos_utils_compute_dos_at_efermi</title>
<path fill="none" stroke="#ff00ff" d="M325,-132.45C337.33,-131.39 351.42,-130.19 365.88,-128.95"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="366.26,-132.43 375.93,-128.09 365.66,-125.46 366.26,-132.43"/>
</g>
<!-- proc~dos_utils_compute_dos_at_efermi&#45;&gt;proc~dos_utils_calculate_at_e -->
<g id="proc~~elec_read_optical_mat~~CalledByGraph_edge16" class="edge">
<title>proc~dos_utils_compute_dos_at_efermi&#45;&gt;proc~dos_utils_calculate_at_e</title>
<path fill="none" stroke="#00ffff" d="M567.28,-120C575.79,-120 584.34,-120 592.7,-120"/>
<polygon fill="#00ffff" stroke="#00ffff" points="592.77,-123.5 602.77,-120 592.77,-116.5 592.77,-123.5"/>
</g>
</g>
</svg>
</div><script>var panprocelec_read_optical_matCalledByGraph = svgPanZoom('#procelec_read_optical_matCalledByGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
        <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/elec_read_optical_mat.html#src">elec_read_optical_mat</a>
      </div>
    </div>


    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="w">  </span><span class="k">subroutine </span><span class="n">elec_read_optical_mat</span><span class="w"></span>
<span class="w">    </span><span class="c">!=========================================================================</span>
<span class="w">    </span><span class="c">! Read the .cst_ome file in paralell if appropriate. These are the</span>
<span class="w">    </span><span class="c">! gradients of the bands at each kpoint.</span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! Arguments: None</span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! Parent module variables: band_gradient,nspins,nbands</span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! Modules used:  See below</span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! Key Internal Variables: None</span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! Necessary conditions: None</span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! Known Worries: None</span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! Written by  A J Morris                                         Dec 2010</span>
<span class="w">    </span><span class="c">!=========================================================================</span>
<span class="w">    </span><span class="k">use </span><span class="n">od_comms</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">on_root</span><span class="p">,</span><span class="w"> </span><span class="n">my_node_id</span><span class="p">,</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">,</span><span class="w"> </span><span class="n">root_id</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">comms_recv</span><span class="p">,</span><span class="w"> </span><span class="n">comms_send</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_io</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">io_time</span><span class="p">,</span><span class="w"> </span><span class="n">filename_len</span><span class="p">,</span><span class="w"> </span><span class="n">seedname</span><span class="p">,</span><span class="w"> </span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="n">io_file_unit</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">io_error</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_cell</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">num_kpoints_on_node</span><span class="p">,</span><span class="w"> </span><span class="n">nkpoints</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_constants</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">bohr2ang</span><span class="p">,</span><span class="w"> </span><span class="n">H2eV</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_parameters</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">legacy_file_format</span><span class="p">,</span><span class="w"> </span><span class="n">iprint</span><span class="p">,</span><span class="w"> </span><span class="n">devel_flag</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_algorithms</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">algor_dist_array</span><span class="w"></span>
<span class="w">    </span><span class="k">implicit none</span>

<span class="k">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gradient_unit</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ib</span><span class="p">,</span><span class="w"> </span><span class="n">jb</span><span class="p">,</span><span class="w"> </span><span class="k">is</span><span class="p">,</span><span class="w"> </span><span class="n">ik</span><span class="p">,</span><span class="w"> </span><span class="n">inodes</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"></span>
<span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="n">filename_len</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gradient_filename</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">time0</span><span class="p">,</span><span class="w"> </span><span class="n">time1</span><span class="p">,</span><span class="w"> </span><span class="n">file_version</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">file_ver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_dp</span><span class="w"></span>

<span class="w">    </span><span class="c">! Check that we haven&#39;t already done this.</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">optical_mat</span><span class="p">))</span><span class="w"> </span><span class="k">return</span>

<span class="k">    </span><span class="n">time0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_time</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">on_root</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">gradient_unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_file_unit</span><span class="p">()</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">index</span><span class="p">(</span><span class="n">devel_flag</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;old_filename&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">legacy_file_format</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        </span><span class="n">gradient_filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">seedname</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;.cst_ome&quot;</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(1x,a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Reading optical matrix elements from file: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">gradient_filename</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">open</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">gradient_unit</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="n">gradient_filename</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;old&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">else</span>
<span class="k">        </span><span class="n">gradient_filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">seedname</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;.ome_bin&quot;</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(1x,a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Reading optical matrix elements from file: &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">gradient_filename</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">open</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">gradient_unit</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="n">gradient_filename</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;old&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="o">=</span><span class="mi">102</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">gradient_unit</span><span class="p">)</span><span class="w"> </span><span class="n">file_version</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">file_version</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">file_ver</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.001_dp</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">          </span><span class="k">call </span><span class="n">io_error</span><span class="p">(</span><span class="s1">&#39;Error: Trying to read newer version of ome_bin file. Update optados!&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">gradient_unit</span><span class="p">)</span><span class="w"> </span><span class="n">omefile_header</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(1x,a)&#39;</span><span class="p">)</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">omefile_header</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">end if</span>
<span class="k">    end if</span><span class="w"></span>

<span class="w">    </span><span class="c">! Figure out how many kpoints should be on each node</span>
<span class="w">    </span><span class="k">call </span><span class="n">algor_dist_array</span><span class="p">(</span><span class="n">nkpoints</span><span class="p">,</span><span class="w"> </span><span class="n">num_kpoints_on_node</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">optical_mat</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nbands</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">nbands</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">num_kpoints_on_node</span><span class="p">(</span><span class="n">my_node_id</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">nspins</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ierr</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">io_error</span><span class="p">(</span><span class="s1">&#39;Error: Problem allocating optical_mat in elec_read_optical_mat&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">legacy_file_format</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>

<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">on_root</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        do </span><span class="n">inodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_nodes</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">          </span><span class="k">do </span><span class="n">ik</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_kpoints_on_node</span><span class="p">(</span><span class="n">inodes</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">do is</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nspins</span><span class="w"></span>
<span class="w">              </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="w">                </span><span class="k">do </span><span class="n">jb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nbands</span><span class="w"></span>
<span class="w">                  </span><span class="k">do </span><span class="n">ib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nbands</span><span class="w"></span>
<span class="w">                    </span><span class="c">! Read in units of Ha Bohr^2 / Ang</span>
<span class="w">                    </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">gradient_unit</span><span class="p">)</span><span class="w"> </span><span class="n">optical_mat</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span><span class="w"> </span><span class="n">jb</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ik</span><span class="p">,</span><span class="w"> </span><span class="k">is</span><span class="p">)</span><span class="w"></span>
<span class="w">                  </span><span class="k">end do</span>
<span class="k">                end do</span>
<span class="k">              end do</span>
<span class="k">            end do</span>
<span class="k">          end do</span>
<span class="k">          call </span><span class="n">comms_send</span><span class="p">(</span><span class="n">optical_mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">nbands</span><span class="o">*</span><span class="n">nbands</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="n">nspins</span><span class="o">*</span><span class="n">num_kpoints_on_node</span><span class="p">(</span><span class="n">inodes</span><span class="p">),</span><span class="w"> </span><span class="n">inodes</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">end do</span>

<span class="k">        do </span><span class="n">ik</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_kpoints_on_node</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="k">do is</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nspins</span><span class="w"></span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="w">              </span><span class="k">do </span><span class="n">jb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nbands</span><span class="w"></span>
<span class="w">                </span><span class="k">do </span><span class="n">ib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nbands</span><span class="w"></span>
<span class="w">                  </span><span class="c">! Read in units of Ha Bohr^2 / Ang</span>
<span class="w">                  </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">gradient_unit</span><span class="p">)</span><span class="w"> </span><span class="n">optical_mat</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span><span class="w"> </span><span class="n">jb</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ik</span><span class="p">,</span><span class="w"> </span><span class="k">is</span><span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">              end do</span>
<span class="k">            end do</span>
<span class="k">          end do</span>
<span class="k">        end do</span>
<span class="k">      end if</span>

<span class="k">    else</span><span class="w"> </span><span class="c">! sane file format</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">on_root</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        do </span><span class="n">inodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_nodes</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">          </span><span class="k">do </span><span class="n">ik</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_kpoints_on_node</span><span class="p">(</span><span class="n">inodes</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">do is</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nspins</span><span class="w"></span>
<span class="w">              </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">gradient_unit</span><span class="p">)</span><span class="w"> </span><span class="p">(((</span><span class="n">optical_mat</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span><span class="w"> </span><span class="n">jb</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ik</span><span class="p">,</span><span class="w"> </span><span class="k">is</span><span class="p">),</span><span class="w"> </span><span class="n">ib</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nbands</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">                                     </span><span class="p">,</span><span class="w"> </span><span class="n">jb</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nbands</span><span class="p">),</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">          end do</span>
<span class="k">          call </span><span class="n">comms_send</span><span class="p">(</span><span class="n">optical_mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">nbands</span><span class="o">*</span><span class="n">nbands</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="n">nspins</span><span class="o">*</span><span class="n">num_kpoints_on_node</span><span class="p">(</span><span class="n">inodes</span><span class="p">),</span><span class="w"> </span><span class="n">inodes</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">end do</span>
<span class="k">        do </span><span class="n">ik</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_kpoints_on_node</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="k">do is</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nspins</span><span class="w"></span>
<span class="w">            </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">gradient_unit</span><span class="p">)</span><span class="w"> </span><span class="p">(((</span><span class="n">optical_mat</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span><span class="w"> </span><span class="n">jb</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ik</span><span class="p">,</span><span class="w"> </span><span class="k">is</span><span class="p">),</span><span class="w"> </span><span class="n">ib</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nbands</span><span class="p">),</span><span class="w"> </span><span class="n">jb</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nbands</span><span class="p">),</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="w">          </span><span class="k">end do</span>
<span class="k">        end do</span>
<span class="k">      end if</span>
<span class="k">    end if</span>

<span class="k">    if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">on_root</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      call </span><span class="n">comms_recv</span><span class="p">(</span><span class="n">optical_mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">nbands</span><span class="o">*</span><span class="n">nbands</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="n">nspins</span><span class="o">*</span><span class="n">num_kpoints_on_node</span><span class="p">(</span><span class="n">my_node_id</span><span class="p">),</span><span class="w"> </span><span class="n">root_id</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">end if</span>

<span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">on_root</span><span class="p">)</span><span class="w"> </span><span class="k">close</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="n">gradient_unit</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="c">! Convert all band gradients to eV Ang</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">legacy_file_format</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      </span><span class="n">optical_mat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optical_mat</span><span class="o">*</span><span class="n">bohr2ang</span><span class="o">*</span><span class="n">bohr2ang</span><span class="o">*</span><span class="n">H2eV</span><span class="w"></span>
<span class="w">    </span><span class="k">else</span>
<span class="k">      </span><span class="n">optical_mat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optical_mat</span><span class="o">*</span><span class="n">bohr2ang</span><span class="o">*</span><span class="n">H2eV</span><span class="w"></span>
<span class="w">    </span><span class="k">end if</span>

<span class="k">    </span><span class="n">time1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_time</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">on_root</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(1x,a59,f11.3,a8)&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">           </span><span class="s1">&#39;+ Time to read Optical Matrix Elements                   &amp;</span>
<span class="s1">           &amp;      &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time0</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; (sec) +&#39;</span><span class="w"></span>
<span class="w">    </span><span class="k">end if</span>

<span class="k">    return</span>

<span class="mi">101</span><span class="w"> </span><span class="k">call </span><span class="n">io_error</span><span class="p">(</span><span class="s1">&#39;Error: Problem opening cst_ome file in read_band_optical_mat&#39;</span><span class="p">)</span><span class="w"></span>
<span class="mi">102</span><span class="w"> </span><span class="k">call </span><span class="n">io_error</span><span class="p">(</span><span class="s1">&#39;Error: Problem opening ome_bin file in read_band_optical_mat&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">  </span><span class="k">end subroutine </span><span class="n">elec_read_optical_mat</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>OptaDOS was developed by The OptaDOS developers group<br>&copy; 2024 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>