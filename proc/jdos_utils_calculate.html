<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Documentation for OptaDOS">
    <meta name="author" content="The OptaDOS developers group" >
    <link rel="icon" href="../favicon.png">

    <title>jdos_utils_calculate &ndash; OptaDOS</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">OptaDOS </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>jdos_utils_calculate
      <small>Subroutine</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title=" 1.3% of total for procedures.">83 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/jdos_utils.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/jdos_utils.f90.html'>jdos_utils.f90</a></li>
              <li><a href='../module/od_jdos_utils.html'>od_jdos_utils</a></li>
          <li class="active">jdos_utils_calculate</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/jdos_utils_calculate.html#src">jdos_utils_calculate</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine jdos_utils_calculate(matrix_weights, weighted_jdos)  
</h2>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/od_parameters.html'>od_parameters</a></li>
                <li><a href='../module/od_comms.html'>od_comms</a></li>
                <li><a href='../module/od_dos_utils.html'>od_dos_utils</a></li>
                <li><a href='../module/od_cell.html'>od_cell</a></li>
                <li><a href='../module/od_electronic.html'>od_electronic</a></li>
                <li><a href='../module/od_io.html'>od_io</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~jdos_utils_calculate~~UsesGraph Pages: 1 -->
<svg id="procjdos_utils_calculateUsesGraph" width="597pt" height="228pt"
 viewBox="0.00 0.00 597.00 228.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~jdos_utils_calculate~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 224)">
<title>proc~~jdos_utils_calculate~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-224 593,-224 593,4 -4,4"/>
<!-- proc~jdos_utils_calculate -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_node1" class="node">
<title>proc~jdos_utils_calculate</title>
<polygon fill="none" stroke="black" points="589,-85 474,-85 474,-61 589,-61 589,-85"/>
<text text-anchor="middle" x="531.5" y="-70.6" font-family="Helvetica,sans-Serif" font-size="10.50">jdos_utils_calculate</text>
</g>
<!-- module~od_parameters -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_node2" class="node">
<title>module~od_parameters</title>
<g id="a_proc~~jdos_utils_calculate~~UsesGraph_node2"><a xlink:href=".././module/od_parameters.html" xlink:title="od_parameters">
<polygon fill="#337ab7" stroke="#337ab7" points="438,-106 344,-106 344,-82 438,-82 438,-106"/>
<text text-anchor="middle" x="391" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_parameters</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;module~od_parameters -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge1" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;module~od_parameters</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473.77,-81.6C465.38,-82.87 456.73,-84.19 448.35,-85.46"/>
<polygon fill="#ff0000" stroke="#ff0000" points="447.65,-82.02 438.29,-86.98 448.7,-88.94 447.65,-82.02"/>
</g>
<!-- module~od_comms -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_node3" class="node">
<title>module~od_comms</title>
<g id="a_proc~~jdos_utils_calculate~~UsesGraph_node3"><a xlink:href=".././module/od_comms.html" xlink:title="od_comms">
<polygon fill="#337ab7" stroke="#337ab7" points="188,-220 118,-220 118,-196 188,-196 188,-220"/>
<text text-anchor="middle" x="153" y="-205.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_comms</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;module~od_comms -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge2" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;module~od_comms</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M390,-168C354.21,-179.59 344.97,-182.02 308,-189 271.26,-195.94 229.08,-200.94 198.17,-204.06"/>
<polygon fill="#ff0000" stroke="#ff0000" points="197.75,-200.59 188.14,-205.05 198.44,-207.56 197.75,-200.59"/>
</g>
<!-- module~od_dos_utils -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_node4" class="node">
<title>module~od_dos_utils</title>
<g id="a_proc~~jdos_utils_calculate~~UsesGraph_node4"><a xlink:href=".././module/od_dos_utils.html" xlink:title="od_dos_utils">
<polygon fill="#337ab7" stroke="#337ab7" points="429.5,-64 352.5,-64 352.5,-40 429.5,-40 429.5,-64"/>
<text text-anchor="middle" x="391" y="-49.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_dos_utils</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;module~od_dos_utils -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge3" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;module~od_dos_utils</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473.77,-64.4C462.56,-62.7 450.9,-60.93 440.01,-59.28"/>
<polygon fill="#ff0000" stroke="#ff0000" points="440.26,-55.78 429.85,-57.74 439.21,-62.7 440.26,-55.78"/>
</g>
<!-- module~od_cell -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_node5" class="node">
<title>module~od_cell</title>
<g id="a_proc~~jdos_utils_calculate~~UsesGraph_node5"><a xlink:href=".././module/od_cell.html" xlink:title="od_cell">
<polygon fill="#337ab7" stroke="#337ab7" points="293,-180 239,-180 239,-156 293,-156 293,-180"/>
<text text-anchor="middle" x="266" y="-165.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_cell</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;module~od_cell -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge4" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;module~od_cell</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M390,-168C361.77,-176.65 328.16,-175.95 303.21,-173.49"/>
<polygon fill="#ff0000" stroke="#ff0000" points="303.42,-169.99 293.09,-172.34 302.64,-176.95 303.42,-169.99"/>
</g>
<!-- module~od_electronic -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_node6" class="node">
<title>module~od_electronic</title>
<g id="a_proc~~jdos_utils_calculate~~UsesGraph_node6"><a xlink:href=".././module/od_electronic.html" xlink:title="od_electronic">
<polygon fill="#337ab7" stroke="#337ab7" points="308,-24 224,-24 224,0 308,0 308,-24"/>
<text text-anchor="middle" x="266" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_electronic</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;module~od_electronic -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge5" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;module~od_electronic</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M509.18,-60.97C490.88,-51.23 463.51,-38.02 438,-31 398.72,-20.19 352.76,-15.51 318.38,-13.49"/>
<polygon fill="#ff0000" stroke="#ff0000" points="318.28,-9.98 308.1,-12.95 317.9,-16.97 318.28,-9.98"/>
</g>
<!-- module~od_io -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_node7" class="node">
<title>module~od_io</title>
<g id="a_proc~~jdos_utils_calculate~~UsesGraph_node7"><a xlink:href=".././module/od_io.html" xlink:title="od_io">
<polygon fill="#337ab7" stroke="#337ab7" points="180,-140 126,-140 126,-116 180,-116 180,-140"/>
<text text-anchor="middle" x="153" y="-125.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_io</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;module~od_io -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge6" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;module~od_io</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M518.55,-85.11C496.14,-106.83 445.25,-151.69 392,-168"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M390,-168C354.03,-179.02 344.97,-153.98 308,-147 267.93,-139.43 221.4,-134.17 190.06,-131.13"/>
<polygon fill="#ff0000" stroke="#ff0000" points="190.33,-127.64 180.04,-130.19 189.67,-134.61 190.33,-127.64"/>
</g>
<!-- module~od_parameters&#45;&gt;module~od_cell -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge7" class="edge">
<title>module~od_parameters&#45;&gt;module~od_cell</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M369.96,-106.05C349.77,-118.2 318.42,-137.07 295.61,-150.79"/>
<polygon fill="#ff0000" stroke="#ff0000" points="293.79,-147.8 287.03,-155.95 297.4,-153.79 293.79,-147.8"/>
</g>
<!-- module~od_parameters&#45;&gt;module~od_io -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge8" class="edge">
<title>module~od_parameters&#45;&gt;module~od_io</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M265,-90C236.97,-90.67 207,-101.6 185.27,-111.57"/>
<polygon fill="#ff0000" stroke="#ff0000" points="183.72,-108.43 176.2,-115.89 186.73,-114.75 183.72,-108.43"/>
</g>
<!-- module~od_constants -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_node8" class="node">
<title>module~od_constants</title>
<g id="a_proc~~jdos_utils_calculate~~UsesGraph_node8"><a xlink:href=".././module/od_constants.html" xlink:title="od_constants">
<polygon fill="#337ab7" stroke="#337ab7" points="82,-160 0,-160 0,-136 82,-136 82,-160"/>
<text text-anchor="middle" x="41" y="-145.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_constants</text>
</a>
</g>
</g>
<!-- module~od_parameters&#45;&gt;module~od_constants -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge9" class="edge">
<title>module~od_parameters&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M343.86,-91.27C320.78,-90.22 292.42,-89.4 267,-90"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M265,-90C214.89,-91.19 200.44,-51.13 154,-70"/>
</g>
<!-- module~od_comms&#45;&gt;module~od_constants -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge10" class="edge">
<title>module~od_comms&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M129.74,-195.86C113.49,-186.99 91.24,-174.86 73.21,-165.03"/>
<polygon fill="#ffff00" stroke="#ffff00" points="74.68,-161.84 64.23,-160.12 71.33,-167.99 74.68,-161.84"/>
</g>
<!-- module~od_dos_utils&#45;&gt;module~od_electronic -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge11" class="edge">
<title>module~od_dos_utils&#45;&gt;module~od_electronic</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M353.1,-40C340.8,-36 326.94,-31.49 313.99,-27.28"/>
<polygon fill="#00ff00" stroke="#00ff00" points="314.9,-23.9 304.3,-24.13 312.73,-30.55 314.9,-23.9"/>
</g>
<!-- module~od_dos_utils&#45;&gt;module~od_constants -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge12" class="edge">
<title>module~od_dos_utils&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M352.43,-48.01C304.48,-44.42 219.86,-43.24 154,-70"/>
</g>
<!-- module~od_cell&#45;&gt;module~od_io -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge13" class="edge">
<title>module~od_cell&#45;&gt;module~od_io</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M238.98,-158.62C224.33,-153.34 205.83,-146.68 189.83,-140.91"/>
<polygon fill="#00ffff" stroke="#00ffff" points="190.84,-137.56 180.25,-137.46 188.47,-144.14 190.84,-137.56"/>
</g>
<!-- module~od_cell&#45;&gt;module~od_constants -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge14" class="edge">
<title>module~od_cell&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M238.98,-165.67C203.09,-162.45 137.67,-156.58 92.12,-152.49"/>
<polygon fill="#00ffff" stroke="#00ffff" points="92.41,-149.01 82.14,-151.6 91.79,-155.98 92.41,-149.01"/>
</g>
<!-- module~od_electronic&#45;&gt;module~od_constants -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge15" class="edge">
<title>module~od_electronic&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M244.7,-24.12C222.86,-36.79 186.83,-56.66 154,-70"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M152,-70C117.34,-84.08 83.1,-110.97 62.25,-129.2"/>
<polygon fill="#0000ff" stroke="#0000ff" points="59.82,-126.68 54.68,-135.95 64.48,-131.9 59.82,-126.68"/>
</g>
<!-- module~od_io&#45;&gt;module~od_constants -->
<g id="proc~~jdos_utils_calculate~~UsesGraph_edge16" class="edge">
<title>module~od_io&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M125.93,-132.74C115.81,-134.58 103.86,-136.75 92.2,-138.87"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="91.29,-135.48 82.08,-140.71 92.54,-142.37 91.29,-135.48"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>



    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
<th>Intent</th><th>Optional</th>        <th>Attributes</th>
        <th></th>
        <th>Name</th>
        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-matrix_weights~4"></span>
              real(kind=dp),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>matrix_weights</strong>(:,:,:,:,:)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-weighted_jdos~2"></span>
              real(kind=dp),
            </td>
<td>intent(out),</td>
              <td>optional,</td>            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>weighted_jdos</strong>(:,:,:)</td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~jdos_utils_calculate~~CallsGraph Pages: 1 -->
<svg id="procjdos_utils_calculateCallsGraph" width="641pt" height="556pt"
 viewBox="0.00 0.00 641.00 555.90" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~jdos_utils_calculate~~CallsGraph" class="graph" transform="scale(1.64 1.64) rotate(0) translate(4 909.21)">
<title>proc~~jdos_utils_calculate~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-909.21 1049,-909.21 1049,4 -4,4"/>
<!-- proc~jdos_utils_calculate -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node1" class="node">
<title>proc~jdos_utils_calculate</title>
<polygon fill="none" stroke="black" points="115,-278 0,-278 0,-254 115,-254 115,-278"/>
<text text-anchor="middle" x="57.5" y="-263.6" font-family="Helvetica,sans-Serif" font-size="10.50">jdos_utils_calculate</text>
</g>
<!-- proc~elec_read_band_gradient -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node2" class="node">
<title>proc~elec_read_band_gradient</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node2"><a xlink:href=".././proc/elec_read_band_gradient.html" xlink:title="elec_read_band_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="602,-700 455,-700 455,-676 602,-676 602,-700"/>
<text text-anchor="middle" x="528.5" y="-685.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elec_read_band_gradient</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~elec_read_band_gradient -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge1" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~elec_read_band_gradient</title>
<path fill="none" stroke="#ff0000" d="M58.04,-278.32C57,-325.79 59.82,-498.64 151,-588 229.44,-664.88 359.87,-684.46 444.77,-688.5"/>
<polygon fill="#ff0000" stroke="#ff0000" points="444.75,-692 454.89,-688.92 445.04,-685.01 444.75,-692"/>
</g>
<!-- proc~io_time -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node3" class="node">
<title>proc~io_time</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node3"><a xlink:href=".././proc/io_time.html" xlink:title="io_time">
<polygon fill="#d94e8f" stroke="#d94e8f" points="902,-603 848,-603 848,-579 902,-579 902,-603"/>
<text text-anchor="middle" x="875" y="-588.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_time</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~io_time -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge5" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#ff0000" d="M63.19,-278.07C86.17,-335.02 192.72,-574 362,-574 362,-574 362,-574 529.5,-574 641.86,-574 774.6,-583.13 837.47,-588.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="837.41,-591.52 847.66,-588.81 837.96,-584.54 837.41,-591.52"/>
</g>
<!-- proc~dos_utils_set_efermi -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node4" class="node">
<title>proc~dos_utils_set_efermi</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node4"><a xlink:href=".././proc/dos_utils_set_efermi.html" xlink:title="dos_utils_set_efermi">
<polygon fill="#d9534f" stroke="#d9534f" points="271,-396 151,-396 151,-372 271,-372 271,-396"/>
<text text-anchor="middle" x="211" y="-381.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_set_efermi</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~dos_utils_set_efermi -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge2" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~dos_utils_set_efermi</title>
<path fill="none" stroke="#ff0000" d="M74.14,-278.18C100.68,-298.85 154.68,-340.91 186.02,-365.32"/>
<polygon fill="#ff0000" stroke="#ff0000" points="184.18,-368.32 194.22,-371.71 188.48,-362.8 184.18,-368.32"/>
</g>
<!-- proc~setup_energy_scale -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node5" class="node">
<title>proc~setup_energy_scale</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node5"><a xlink:href=".././proc/setup_energy_scale.html" xlink:title="setup_energy_scale">
<polygon fill="#d9534f" stroke="#d9534f" points="587.5,-276 469.5,-276 469.5,-252 587.5,-252 587.5,-276"/>
<text text-anchor="middle" x="528.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">setup_energy_scale</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~setup_energy_scale -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge4" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~setup_energy_scale</title>
<path fill="none" stroke="#ff0000" d="M115.07,-265.76C201.49,-265.39 366.11,-264.69 459.11,-264.29"/>
<polygon fill="#ff0000" stroke="#ff0000" points="459.27,-267.79 469.26,-264.25 459.24,-260.79 459.27,-267.79"/>
</g>
<!-- proc~calculate_jdos -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node6" class="node">
<title>proc~calculate_jdos</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node6"><a xlink:href=".././proc/calculate_jdos.html" xlink:title="calculate_jdos">
<polygon fill="#d9534f" stroke="#d9534f" points="748,-148 660,-148 660,-124 748,-124 748,-148"/>
<text text-anchor="middle" x="704" y="-133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calculate_jdos</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~calculate_jdos -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge3" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~calculate_jdos</title>
<path fill="none" stroke="#ff0000" d="M66.11,-253.76C79.99,-232.66 111.65,-190.01 151,-172 319.43,-94.9 547.4,-113.54 649.59,-127.42"/>
<polygon fill="#ff0000" stroke="#ff0000" points="649.27,-130.91 659.66,-128.83 650.24,-123.98 649.27,-130.91"/>
</g>
<!-- proc~jdos_utils_merge -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node7" class="node">
<title>proc~jdos_utils_merge</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node7"><a xlink:href=".././proc/jdos_utils_merge.html" xlink:title="jdos_utils_merge">
<polygon fill="#d9534f" stroke="#d9534f" points="414,-238 312,-238 312,-214 414,-214 414,-238"/>
<text text-anchor="middle" x="363" y="-223.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jdos_utils_merge</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~jdos_utils_merge -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge6" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~jdos_utils_merge</title>
<path fill="none" stroke="#ff0000" d="M115.21,-257.16C127.03,-255.39 139.41,-253.59 151,-252 201.67,-245.04 259.31,-238 301.53,-233"/>
<polygon fill="#ff0000" stroke="#ff0000" points="302.12,-236.46 311.64,-231.81 301.3,-229.51 302.12,-236.46"/>
</g>
<!-- proc~io_error -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node8" class="node">
<title>proc~io_error</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node8"><a xlink:href=".././proc/io_error.html" xlink:title="io_error">
<polygon fill="#d9534f" stroke="#d9534f" points="1039.5,-510 985.5,-510 985.5,-486 1039.5,-486 1039.5,-510"/>
<text text-anchor="middle" x="1012.5" y="-495.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_error</text>
</a>
</g>
</g>
<!-- proc~jdos_utils_calculate&#45;&gt;proc~io_error -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge7" class="edge">
<title>proc~jdos_utils_calculate&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#ff0000" d="M89.82,-253.86C107.57,-247.31 130.3,-239.47 151,-234 219.18,-215.98 236.78,-211.47 307,-205 513.05,-186.01 568.36,-207.52 770,-254 847.73,-271.92 885.44,-243.83 944,-298 995.5,-345.64 1007.72,-433.88 1010.61,-475.35"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1007.13,-475.73 1011.2,-485.51 1014.12,-475.33 1007.13,-475.73"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~io_time -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge12" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#ff0000" d="M550.44,-675.95C571.81,-664.14 606.25,-646.44 638,-636 706.89,-613.35 791.05,-600.71 837.97,-594.93"/>
<polygon fill="#ff0000" stroke="#ff0000" points="838.44,-598.4 847.96,-593.74 837.61,-591.45 838.44,-598.4"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~io_error -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge10" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#ff0000" d="M602.26,-681.92C705.99,-672.05 889.83,-649.76 944,-612 976.17,-589.57 995.43,-546.45 1004.71,-520.15"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1008.14,-520.92 1007.98,-510.33 1001.5,-518.71 1008.14,-520.92"/>
</g>
<!-- interface~comms_bcast -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node11" class="node">
<title>interface~comms_bcast</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node11"><a xlink:href=".././interface/comms_bcast.html" xlink:title="comms_bcast">
<polygon fill="#a7506f" stroke="#a7506f" points="746.5,-414 661.5,-414 661.5,-390 746.5,-390 746.5,-414"/>
<text text-anchor="middle" x="704" y="-399.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">comms_bcast</text>
</a>
</g>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;interface~comms_bcast -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge8" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;interface~comms_bcast</title>
<path fill="none" stroke="#ff0000" d="M536.96,-675.71C563.87,-631.34 656.24,-479.08 690.28,-422.98"/>
<polygon fill="#ff0000" stroke="#ff0000" points="693.38,-424.61 695.57,-414.24 687.39,-420.98 693.38,-424.61"/>
</g>
<!-- interface~comms_recv -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node12" class="node">
<title>interface~comms_recv</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node12"><a xlink:href=".././interface/comms_recv.html" xlink:title="comms_recv">
<polygon fill="#a7506f" stroke="#a7506f" points="914.5,-859 835.5,-859 835.5,-835 914.5,-835 914.5,-859"/>
<text text-anchor="middle" x="875" y="-844.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">comms_recv</text>
</a>
</g>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;interface~comms_recv -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge14" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;interface~comms_recv</title>
<path fill="none" stroke="#ff0000" d="M537.39,-700.1C553.35,-723.51 591.88,-774.87 638,-800 697.08,-832.19 775.22,-842.48 825.06,-845.69"/>
<polygon fill="#ff0000" stroke="#ff0000" points="825.07,-849.19 835.25,-846.27 825.47,-842.2 825.07,-849.19"/>
</g>
<!-- proc~algor_dist_array -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node13" class="node">
<title>proc~algor_dist_array</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node13"><a xlink:href=".././proc/algor_dist_array.html" xlink:title="algor_dist_array">
<polygon fill="#d9534f" stroke="#d9534f" points="924,-695 826,-695 826,-671 924,-671 924,-695"/>
<text text-anchor="middle" x="875" y="-680.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">algor_dist_array</text>
</a>
</g>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~algor_dist_array -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge11" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~algor_dist_array</title>
<path fill="none" stroke="#ff0000" d="M602.14,-686.95C665.64,-686.02 756.67,-684.7 815.56,-683.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="815.86,-687.34 825.81,-683.7 815.76,-680.35 815.86,-687.34"/>
</g>
<!-- interface~comms_send -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node14" class="node">
<title>interface~comms_send</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node14"><a xlink:href=".././interface/comms_send.html" xlink:title="comms_send">
<polygon fill="#a7506f" stroke="#a7506f" points="916,-817 834,-817 834,-793 916,-793 916,-817"/>
<text text-anchor="middle" x="875" y="-802.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">comms_send</text>
</a>
</g>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;interface~comms_send -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge13" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;interface~comms_send</title>
<path fill="none" stroke="#ff0000" d="M541.18,-700.29C559.74,-718.99 597.99,-754.18 638,-771 698.56,-796.47 774.74,-803.42 823.89,-805.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="823.87,-808.54 833.96,-805.3 824.05,-801.54 823.87,-808.54"/>
</g>
<!-- proc~io_file_unit -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node15" class="node">
<title>proc~io_file_unit</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node15"><a xlink:href=".././proc/io_file_unit.html" xlink:title="io_file_unit">
<polygon fill="#d94e8f" stroke="#d94e8f" points="910,-775 840,-775 840,-751 910,-751 910,-775"/>
<text text-anchor="middle" x="875" y="-760.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_file_unit</text>
</a>
</g>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~io_file_unit -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge9" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#ff0000" d="M545.36,-700.01C565.62,-714.59 602.34,-738.52 638,-749 702.75,-768.02 781.69,-768.38 829.87,-766.21"/>
<polygon fill="#ff0000" stroke="#ff0000" points="830.16,-769.7 839.97,-765.7 829.8,-762.71 830.16,-769.7"/>
</g>
<!-- proc~elec_read_optical_mat -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node16" class="node">
<title>proc~elec_read_optical_mat</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node16"><a xlink:href=".././proc/elec_read_optical_mat.html" xlink:title="elec_read_optical_mat">
<polygon fill="#d9534f" stroke="#d9534f" points="770,-740 638,-740 638,-716 770,-716 770,-740"/>
<text text-anchor="middle" x="704" y="-725.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elec_read_optical_mat</text>
</a>
</g>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~elec_read_optical_mat -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge15" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~elec_read_optical_mat</title>
<path fill="none" stroke="#ff0000" d="M581.56,-700C600.17,-704.29 621.34,-709.17 640.73,-713.64"/>
<polygon fill="#ff0000" stroke="#ff0000" points="640.15,-717.1 650.68,-715.94 641.72,-710.28 640.15,-717.1"/>
</g>
<!-- proc~elec_dealloc_optical -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node17" class="node">
<title>proc~elec_dealloc_optical</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node17"><a xlink:href=".././proc/elec_dealloc_optical.html" xlink:title="elec_dealloc_optical">
<polygon fill="#d9534f" stroke="#d9534f" points="764.5,-897 643.5,-897 643.5,-873 764.5,-873 764.5,-897"/>
<text text-anchor="middle" x="704" y="-882.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elec_dealloc_optical</text>
</a>
</g>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~elec_dealloc_optical -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge16" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~elec_dealloc_optical</title>
<path fill="none" stroke="#ff0000" d="M534.1,-700.17C546.33,-731 582.55,-812.96 638,-859 642.32,-862.59 647.21,-865.73 652.31,-868.47"/>
<polygon fill="#ff0000" stroke="#ff0000" points="651.12,-871.78 661.65,-872.97 654.16,-865.48 651.12,-871.78"/>
</g>
<!-- proc~dos_utils_set_efermi&#45;&gt;proc~io_error -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge18" class="edge">
<title>proc~dos_utils_set_efermi&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#48ff00" d="M223.5,-396.08C240.36,-413.17 273.43,-444.37 307,-463 397.26,-513.1 424.27,-536 527.5,-536 527.5,-536 527.5,-536 705,-536 803.43,-536 918.3,-516.46 975.42,-505.4"/>
<polygon fill="#48ff00" stroke="#48ff00" points="976.26,-508.81 985.4,-503.44 974.91,-501.94 976.26,-508.81"/>
</g>
<!-- proc~dos_utils_set_efermi&#45;&gt;interface~comms_bcast -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge19" class="edge">
<title>proc~dos_utils_set_efermi&#45;&gt;interface~comms_bcast</title>
<path fill="none" stroke="#48ff00" d="M271.23,-386.17C368.24,-389.73 559.38,-396.74 651.28,-400.1"/>
<polygon fill="#48ff00" stroke="#48ff00" points="651.33,-403.61 661.45,-400.48 651.58,-396.61 651.33,-403.61"/>
</g>
<!-- interface~comms_reduce -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node18" class="node">
<title>interface~comms_reduce</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node18"><a xlink:href=".././interface/comms_reduce.html" xlink:title="comms_reduce">
<polygon fill="#a7506f" stroke="#a7506f" points="751,-316 657,-316 657,-292 751,-292 751,-316"/>
<text text-anchor="middle" x="704" y="-301.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">comms_reduce</text>
</a>
</g>
</g>
<!-- proc~dos_utils_set_efermi&#45;&gt;interface~comms_reduce -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge17" class="edge">
<title>proc~dos_utils_set_efermi&#45;&gt;interface~comms_reduce</title>
<path fill="none" stroke="#48ff00" d="M251.14,-371.99C298.81,-357.87 382.01,-334.87 455,-323 520.2,-312.4 596.02,-307.68 646.5,-305.6"/>
<polygon fill="#48ff00" stroke="#48ff00" points="646.7,-309.1 656.56,-305.21 646.43,-302.1 646.7,-309.1"/>
</g>
<!-- proc~dos_utils_calculate -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node19" class="node">
<title>proc~dos_utils_calculate</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node19"><a xlink:href=".././proc/dos_utils_calculate.html" xlink:title="dos_utils_calculate">
<polygon fill="#d9534f" stroke="#d9534f" points="419,-454 307,-454 307,-430 419,-430 419,-454"/>
<text text-anchor="middle" x="363" y="-439.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_calculate</text>
</a>
</g>
</g>
<!-- proc~dos_utils_set_efermi&#45;&gt;proc~dos_utils_calculate -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge20" class="edge">
<title>proc~dos_utils_set_efermi&#45;&gt;proc~dos_utils_calculate</title>
<path fill="none" stroke="#48ff00" d="M243.08,-396.02C265.81,-404.81 296.84,-416.81 321.51,-426.34"/>
<polygon fill="#48ff00" stroke="#48ff00" points="320.37,-429.66 330.96,-430 322.89,-423.13 320.37,-429.66"/>
</g>
<!-- proc~setup_energy_scale&#45;&gt;proc~io_error -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge23" class="edge">
<title>proc~setup_energy_scale&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#00ff91" d="M587.83,-258.47C638.12,-256.02 711.63,-258.11 770,-283 873.11,-326.97 962.3,-433.16 996.55,-477.75"/>
<polygon fill="#00ff91" stroke="#00ff91" points="993.83,-479.95 1002.66,-485.81 999.41,-475.73 993.83,-479.95"/>
</g>
<!-- proc~setup_energy_scale&#45;&gt;interface~comms_bcast -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge22" class="edge">
<title>proc~setup_energy_scale&#45;&gt;interface~comms_bcast</title>
<path fill="none" stroke="#00ff91" d="M544.59,-276.01C574.97,-300.17 643.66,-354.81 679.79,-383.54"/>
<polygon fill="#00ff91" stroke="#00ff91" points="677.81,-386.44 687.82,-389.92 682.17,-380.96 677.81,-386.44"/>
</g>
<!-- proc~setup_energy_scale&#45;&gt;interface~comms_reduce -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge21" class="edge">
<title>proc~setup_energy_scale&#45;&gt;interface~comms_reduce</title>
<path fill="none" stroke="#00ff91" d="M581.56,-276C602.24,-280.77 626.07,-286.26 647.11,-291.11"/>
<polygon fill="#00ff91" stroke="#00ff91" points="646.34,-294.53 656.88,-293.37 647.92,-287.71 646.34,-294.53"/>
</g>
<!-- proc~calculate_jdos&#45;&gt;proc~io_error -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge24" class="edge">
<title>proc~calculate_jdos&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#0091ff" d="M748.05,-125.41C801.04,-115.16 890.55,-107.37 944,-155 992.18,-197.93 1006.89,-406.23 1010.49,-475.53"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1007.01,-475.94 1011,-485.76 1014,-475.6 1007.01,-475.94"/>
</g>
<!-- proc~gaussian -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node9" class="node">
<title>proc~gaussian</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node9"><a xlink:href=".././proc/gaussian.html" xlink:title="gaussian">
<polygon fill="#d94e8f" stroke="#d94e8f" points="905,-24 845,-24 845,0 905,0 905,-24"/>
<text text-anchor="middle" x="875" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gaussian</text>
</a>
</g>
</g>
<!-- proc~calculate_jdos&#45;&gt;proc~gaussian -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge26" class="edge">
<title>proc~calculate_jdos&#45;&gt;proc~gaussian</title>
<path fill="none" stroke="#0091ff" d="M713.58,-123.93C729.41,-102.51 765.37,-57.77 806,-33 814.86,-27.6 825.23,-23.48 835.16,-20.39"/>
<polygon fill="#0091ff" stroke="#0091ff" points="836.21,-23.73 844.87,-17.62 834.3,-16.99 836.21,-23.73"/>
</g>
<!-- proc~doslin_sub_cell_corners -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node10" class="node">
<title>proc~doslin_sub_cell_corners</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node10"><a xlink:href=".././proc/doslin_sub_cell_corners.html" xlink:title="doslin_sub_cell_corners">
<polygon fill="#d9534f" stroke="#d9534f" points="944,-66 806,-66 806,-42 944,-42 944,-66"/>
<text text-anchor="middle" x="875" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doslin_sub_cell_corners</text>
</a>
</g>
</g>
<!-- proc~calculate_jdos&#45;&gt;proc~doslin_sub_cell_corners -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge28" class="edge">
<title>proc~calculate_jdos&#45;&gt;proc~doslin_sub_cell_corners</title>
<path fill="none" stroke="#0091ff" d="M722.17,-123.84C741.71,-110.43 774.97,-88.91 806,-75 810.42,-73.02 815.08,-71.15 819.8,-69.41"/>
<polygon fill="#0091ff" stroke="#0091ff" points="821.24,-72.62 829.53,-66.02 818.93,-66.01 821.24,-72.62"/>
</g>
<!-- proc~doslin -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node20" class="node">
<title>proc~doslin</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node20"><a xlink:href=".././proc/doslin.html" xlink:title="doslin">
<polygon fill="#d94e8f" stroke="#d94e8f" points="902,-108 848,-108 848,-84 902,-84 902,-108"/>
<text text-anchor="middle" x="875" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">doslin</text>
</a>
</g>
</g>
<!-- proc~calculate_jdos&#45;&gt;proc~doslin -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge25" class="edge">
<title>proc~calculate_jdos&#45;&gt;proc~doslin</title>
<path fill="none" stroke="#0091ff" d="M748.08,-125.8C775.88,-119.22 811.63,-110.76 837.93,-104.54"/>
<polygon fill="#0091ff" stroke="#0091ff" points="838.93,-107.9 847.86,-102.19 837.32,-101.08 838.93,-107.9"/>
</g>
<!-- proc~allocate_jdos -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node21" class="node">
<title>proc~allocate_jdos</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node21"><a xlink:href=".././proc/allocate_jdos.html" xlink:title="allocate_jdos">
<polygon fill="#d9534f" stroke="#d9534f" points="916,-188 834,-188 834,-164 916,-164 916,-188"/>
<text text-anchor="middle" x="875" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_jdos</text>
</a>
</g>
</g>
<!-- proc~calculate_jdos&#45;&gt;proc~allocate_jdos -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge27" class="edge">
<title>proc~calculate_jdos&#45;&gt;proc~allocate_jdos</title>
<path fill="none" stroke="#0091ff" d="M748.08,-146.2C771.19,-151.67 799.78,-158.43 823.87,-164.14"/>
<polygon fill="#0091ff" stroke="#0091ff" points="823.36,-167.61 833.9,-166.51 824.97,-160.8 823.36,-167.61"/>
</g>
<!-- proc~jdos_utils_merge&#45;&gt;interface~comms_reduce -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge29" class="edge">
<title>proc~jdos_utils_merge&#45;&gt;interface~comms_reduce</title>
<path fill="none" stroke="#4800ff" d="M414.04,-222.88C463.1,-221.35 539.42,-223.14 602,-243 631.08,-252.23 660.52,-271.37 680.05,-285.77"/>
<polygon fill="#4800ff" stroke="#4800ff" points="677.94,-288.56 688.03,-291.8 682.16,-282.98 677.94,-288.56"/>
</g>
<!-- proc~heap_sort -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node22" class="node">
<title>proc~heap_sort</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node22"><a xlink:href=".././proc/heap_sort.html" xlink:title="heap_sort">
<polygon fill="#d9534f" stroke="#d9534f" points="1045,-66 980,-66 980,-42 1045,-42 1045,-66"/>
<text text-anchor="middle" x="1012.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">heap_sort</text>
</a>
</g>
</g>
<!-- proc~doslin_sub_cell_corners&#45;&gt;proc~heap_sort -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge30" class="edge">
<title>proc~doslin_sub_cell_corners&#45;&gt;proc~heap_sort</title>
<path fill="none" stroke="#ff7500" d="M944.15,-54C952.95,-54 961.75,-54 969.94,-54"/>
<polygon fill="#ff7500" stroke="#ff7500" points="969.95,-57.5 979.95,-54 969.95,-50.5 969.95,-57.5"/>
</g>
<!-- proc~algor_dist_array&#45;&gt;proc~io_error -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge31" class="edge">
<title>proc~algor_dist_array&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#27ff00" d="M922.85,-670.86C930.57,-667.32 938,-662.79 944,-657 983.54,-618.87 1001.06,-553.9 1007.82,-520.02"/>
<polygon fill="#27ff00" stroke="#27ff00" points="1011.26,-520.66 1009.65,-510.19 1004.38,-519.38 1011.26,-520.66"/>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~io_time -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge32" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#00c4ff" d="M720,-715.84C749.61,-691.83 815.78,-638.2 850.96,-609.68"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="853.23,-612.34 858.79,-603.33 848.82,-606.91 853.23,-612.34"/>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~io_error -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge33" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#00c4ff" d="M770.24,-739.36C822.8,-744.67 895.65,-742.87 944,-704 1000.93,-658.23 1010.34,-563.44 1011.56,-520.28"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="1015.06,-520.3 1011.71,-510.25 1008.06,-520.19 1015.06,-520.3"/>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;interface~comms_recv -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge37" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;interface~comms_recv</title>
<path fill="none" stroke="#00c4ff" d="M714.23,-740.11C730.54,-760.71 766.48,-802.58 806,-826 812,-829.55 818.66,-832.56 825.39,-835.09"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="824.66,-838.54 835.25,-838.46 826.92,-831.92 824.66,-838.54"/>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~algor_dist_array -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge34" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~algor_dist_array</title>
<path fill="none" stroke="#00c4ff" d="M750.29,-715.94C771.4,-710.32 796.71,-703.58 818.92,-697.67"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="820.12,-700.97 828.88,-695.01 818.32,-694.21 820.12,-700.97"/>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;interface~comms_send -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge35" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;interface~comms_send</title>
<path fill="none" stroke="#00c4ff" d="M724.14,-740.18C744.01,-752.46 776.3,-771.34 806,-784 811.82,-786.48 818.03,-788.81 824.24,-790.94"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="823.36,-794.34 833.95,-794.14 825.55,-787.69 823.36,-794.34"/>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~io_file_unit -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge36" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#00c4ff" d="M763.16,-740.05C785.05,-744.58 809.56,-749.65 829.96,-753.88"/>
<polygon fill="#00c4ff" stroke="#00c4ff" points="829.41,-757.34 839.91,-755.94 830.83,-750.48 829.41,-757.34"/>
</g>
<!-- proc~elec_dealloc_optical&#45;&gt;proc~io_error -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge38" class="edge">
<title>proc~elec_dealloc_optical&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#004eff" d="M752.82,-897.08C806.32,-907.47 892.27,-914.36 944,-868 996.16,-821.26 1008.3,-593.03 1010.87,-520.31"/>
<polygon fill="#004eff" stroke="#004eff" points="1014.37,-520.13 1011.2,-510.02 1007.38,-519.9 1014.37,-520.13"/>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;proc~elec_read_band_gradient -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge43" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;proc~elec_read_band_gradient</title>
<path fill="none" stroke="#9c00ff" d="M372.11,-454.2C398.31,-493.63 480.93,-617.93 513.81,-667.4"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="510.89,-669.34 519.34,-675.73 516.72,-665.46 510.89,-669.34"/>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;proc~io_time -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge41" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#9c00ff" d="M396.66,-454.12C413.91,-460.36 435.5,-467.92 455,-474 593.54,-517.21 630.45,-520.16 770,-560 792.78,-566.5 818.28,-574.1 838.32,-580.14"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="837.39,-583.52 847.98,-583.06 839.42,-576.82 837.39,-583.52"/>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;proc~io_error -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge39" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#9c00ff" d="M419.21,-446.77C548.4,-457.95 867.6,-485.55 975.33,-494.87"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="975.1,-498.37 985.37,-495.74 975.71,-491.39 975.1,-498.37"/>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;interface~comms_bcast -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge42" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;interface~comms_bcast</title>
<path fill="none" stroke="#9c00ff" d="M419.22,-435.48C483.47,-427.9 588.72,-415.48 651.38,-408.09"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="651.92,-411.55 661.44,-406.9 651.1,-404.6 651.92,-411.55"/>
</g>
<!-- proc~dos_utils_merge -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_node23" class="node">
<title>proc~dos_utils_merge</title>
<g id="a_proc~~jdos_utils_calculate~~CallsGraph_node23"><a xlink:href=".././proc/dos_utils_merge.html" xlink:title="dos_utils_merge">
<polygon fill="#d9534f" stroke="#d9534f" points="578,-356 479,-356 479,-332 578,-332 578,-356"/>
<text text-anchor="middle" x="528.5" y="-341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_merge</text>
</a>
</g>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;proc~dos_utils_merge -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge40" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;proc~dos_utils_merge</title>
<path fill="none" stroke="#9c00ff" d="M384.05,-429.98C412.73,-412.79 465.64,-381.08 498.57,-361.34"/>
<polygon fill="#9c00ff" stroke="#9c00ff" points="500.51,-364.26 507.29,-356.12 496.91,-358.25 500.51,-364.26"/>
</g>
<!-- proc~allocate_jdos&#45;&gt;proc~io_error -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge44" class="edge">
<title>proc~allocate_jdos&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#ff0075" d="M916.35,-184.18C926.63,-188.03 936.79,-193.7 944,-202 980.02,-243.5 1002.15,-413.78 1009.11,-475.51"/>
<polygon fill="#ff0075" stroke="#ff0075" points="1005.66,-476.17 1010.24,-485.72 1012.62,-475.4 1005.66,-476.17"/>
</g>
<!-- proc~dos_utils_merge&#45;&gt;interface~comms_reduce -->
<g id="proc~~jdos_utils_calculate~~CallsGraph_edge45" class="edge">
<title>proc~dos_utils_merge&#45;&gt;interface~comms_reduce</title>
<path fill="none" stroke="#00ffff" d="M578.29,-332.75C599.67,-327.82 624.89,-322.01 647.03,-316.9"/>
<polygon fill="#00ffff" stroke="#00ffff" points="648,-320.27 656.96,-314.61 646.43,-313.45 648,-320.27"/>
</g>
</g>
</svg>
</div><script>var panprocjdos_utils_calculateCallsGraph = svgPanZoom('#procjdos_utils_calculateCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~jdos_utils_calculate~~CalledByGraph Pages: 1 -->
<svg id="procjdos_utils_calculateCalledByGraph" width="348pt" height="74pt"
 viewBox="0.00 0.00 348.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~jdos_utils_calculate~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>proc~~jdos_utils_calculate~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-70 344,-70 344,4 -4,4"/>
<!-- proc~jdos_utils_calculate -->
<g id="proc~~jdos_utils_calculate~~CalledByGraph_node1" class="node">
<title>proc~jdos_utils_calculate</title>
<polygon fill="none" stroke="black" points="340,-45 225,-45 225,-21 340,-21 340,-45"/>
<text text-anchor="middle" x="282.5" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50">jdos_utils_calculate</text>
</g>
<!-- proc~jdos_calculate -->
<g id="proc~~jdos_utils_calculate~~CalledByGraph_node2" class="node">
<title>proc~jdos_calculate</title>
<g id="a_proc~~jdos_utils_calculate~~CalledByGraph_node2"><a xlink:href=".././proc/jdos_calculate.html" xlink:title="jdos_calculate">
<polygon fill="#d9534f" stroke="#d9534f" points="184,-66 96,-66 96,-42 184,-42 184,-66"/>
<text text-anchor="middle" x="140" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">jdos_calculate</text>
</a>
</g>
</g>
<!-- proc~jdos_calculate&#45;&gt;proc~jdos_utils_calculate -->
<g id="proc~~jdos_utils_calculate~~CalledByGraph_edge1" class="edge">
<title>proc~jdos_calculate&#45;&gt;proc~jdos_utils_calculate</title>
<path fill="none" stroke="#ff0000" d="M184.3,-47.53C194.02,-46.08 204.54,-44.5 214.96,-42.95"/>
<polygon fill="#ff0000" stroke="#ff0000" points="215.51,-46.4 224.88,-41.46 214.47,-39.48 215.51,-46.4"/>
</g>
<!-- proc~optics_calculate -->
<g id="proc~~jdos_utils_calculate~~CalledByGraph_node3" class="node">
<title>proc~optics_calculate</title>
<g id="a_proc~~jdos_utils_calculate~~CalledByGraph_node3"><a xlink:href=".././proc/optics_calculate.html" xlink:title="optics_calculate">
<polygon fill="#d9534f" stroke="#d9534f" points="189,-24 91,-24 91,0 189,0 189,-24"/>
<text text-anchor="middle" x="140" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">optics_calculate</text>
</a>
</g>
</g>
<!-- proc~optics_calculate&#45;&gt;proc~jdos_utils_calculate -->
<g id="proc~~jdos_utils_calculate~~CalledByGraph_edge2" class="edge">
<title>proc~optics_calculate&#45;&gt;proc~jdos_utils_calculate</title>
<path fill="none" stroke="#ff0000" d="M189.35,-19.23C197.57,-20.45 206.23,-21.75 214.82,-23.03"/>
<polygon fill="#ff0000" stroke="#ff0000" points="214.43,-26.51 224.83,-24.53 215.46,-19.59 214.43,-26.51"/>
</g>
<!-- program~optados -->
<g id="proc~~jdos_utils_calculate~~CalledByGraph_node4" class="node">
<title>program~optados</title>
<g id="a_proc~~jdos_utils_calculate~~CalledByGraph_node4"><a xlink:href=".././program/optados.html" xlink:title="optados">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="55,-45 0,-45 0,-21 55,-21 55,-45"/>
<text text-anchor="middle" x="27.5" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">optados</text>
</a>
</g>
</g>
<!-- program~optados&#45;&gt;proc~jdos_calculate -->
<g id="proc~~jdos_utils_calculate~~CalledByGraph_edge3" class="edge">
<title>program~optados&#45;&gt;proc~jdos_calculate</title>
<path fill="none" stroke="#ff0000" d="M55.25,-38.08C64.45,-39.83 75.09,-41.85 85.65,-43.86"/>
<polygon fill="#ff0000" stroke="#ff0000" points="85.21,-47.34 95.69,-45.77 86.52,-40.46 85.21,-47.34"/>
</g>
<!-- program~optados&#45;&gt;proc~optics_calculate -->
<g id="proc~~jdos_utils_calculate~~CalledByGraph_edge4" class="edge">
<title>program~optados&#45;&gt;proc~optics_calculate</title>
<path fill="none" stroke="#00ffff" d="M55.25,-27.92C63.05,-26.43 71.88,-24.75 80.83,-23.06"/>
<polygon fill="#00ffff" stroke="#00ffff" points="81.74,-26.44 90.91,-21.14 80.44,-19.57 81.74,-26.44"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
        <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/jdos_utils_calculate.html#src">jdos_utils_calculate</a>
      </div>
    </div>


    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="w">  </span><span class="k">subroutine </span><span class="n">jdos_utils_calculate</span><span class="p">(</span><span class="n">matrix_weights</span><span class="p">,</span><span class="w"> </span><span class="n">weighted_jdos</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="c">!===============================================================================</span>
<span class="w">    </span><span class="c">! Main routine in dos module, drives the calculation of Density of states for</span>
<span class="w">    </span><span class="c">! both task : dos and also if it is required elsewhere.</span>
<span class="w">    </span><span class="c">!===============================================================================</span>
<span class="w">    </span><span class="k">use </span><span class="n">od_parameters</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">linear</span><span class="p">,</span><span class="w"> </span><span class="n">fixed</span><span class="p">,</span><span class="w"> </span><span class="n">adaptive</span><span class="p">,</span><span class="w"> </span><span class="n">quad</span><span class="p">,</span><span class="w"> </span><span class="n">iprint</span><span class="p">,</span><span class="w"> </span><span class="n">dos_per_volume</span><span class="p">,</span><span class="w"> </span><span class="n">photo</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">jdos_max_energy</span><span class="p">,</span><span class="w"> </span><span class="n">jdos_spacing</span><span class="p">,</span><span class="w"> </span><span class="n">photo</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_electronic</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">elec_read_band_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">band_gradient</span><span class="p">,</span><span class="w"> </span><span class="n">nspins</span><span class="p">,</span><span class="w"> </span><span class="n">electrons_per_state</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">      </span><span class="n">num_electrons</span><span class="p">,</span><span class="w"> </span><span class="n">efermi_set</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_comms</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">on_root</span><span class="p">,</span><span class="w"> </span><span class="n">comms_bcast</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_io</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="n">io_error</span><span class="p">,</span><span class="w"> </span><span class="n">io_time</span><span class="p">,</span><span class="w"> </span><span class="n">seedname</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_cell</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">cell_volume</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_dos_utils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dos_utils_set_efermi</span><span class="w"></span>

<span class="w">    </span><span class="k">implicit none</span><span class="w"></span>
<span class="w">    </span><span class="c">!integer :: ierr</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">time0</span><span class="p">,</span><span class="w"> </span><span class="n">time1</span><span class="w"></span>

<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">optional</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">weighted_jdos</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span><span class="w">  </span><span class="c">!I&#39;ve added this</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="w"> </span><span class="k">optional</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">matrix_weights</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span><span class="w">               </span><span class="c">!I&#39;ve added this</span>
<span class="w">    </span><span class="n">calc_weighted_jdos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">matrix_weights</span><span class="p">))</span><span class="w"> </span><span class="n">calc_weighted_jdos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">calc_weighted_jdos</span><span class="w"> </span><span class="p">.</span><span class="n">eqv</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! We are called just to provide jdos.</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">E</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">on_root</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot; Already calculated jdos, so returning...&quot;</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w">  </span><span class="c">! The jdos has already been calculated previously so just return.</span>
<span class="w">      </span><span class="k">end if</span>
<span class="k">    end if</span><span class="w"></span>

<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! R E A D   B A N D   G R A D I E N T S</span>
<span class="w">    </span><span class="c">! If we&#39;re using one of the more accurate roadening schemes we also need to read in the</span>
<span class="w">    </span><span class="c">! band gradients too</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">quad</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">linear</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">adaptive</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">band_gradient</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">elec_read_band_gradient</span><span class="w"></span>
<span class="w">    </span><span class="k">end if</span><span class="w"></span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">efermi_set</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">dos_utils_set_efermi</span><span class="w"></span>

<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! C A L C U L A T E   J D O S</span>
<span class="w">    </span><span class="c">! Now everything is set up, we can perform the dos accumulation in parellel</span>
<span class="w">    </span><span class="n">time0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_time</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">setup_energy_scale</span><span class="p">(</span><span class="n">E</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fixed</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">calc_weighted_jdos</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">calculate_jdos</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">jdos_fixed</span><span class="p">,</span><span class="w"> </span><span class="n">matrix_weights</span><span class="p">,</span><span class="w"> </span><span class="n">weighted_jdos</span><span class="o">=</span><span class="n">weighted_jdos</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">jdos_utils_merge</span><span class="p">(</span><span class="n">jdos_fixed</span><span class="p">,</span><span class="w"> </span><span class="n">weighted_jdos</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">else</span>
<span class="k">        call </span><span class="n">calculate_jdos</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">jdos_fixed</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">jdos_utils_merge</span><span class="p">(</span><span class="n">jdos_fixed</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">end if</span>

<span class="k">    end if</span>
<span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">adaptive</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">calc_weighted_jdos</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">calculate_jdos</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">jdos_adaptive</span><span class="p">,</span><span class="w"> </span><span class="n">matrix_weights</span><span class="p">,</span><span class="w"> </span><span class="n">weighted_jdos</span><span class="o">=</span><span class="n">weighted_jdos</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">jdos_utils_merge</span><span class="p">(</span><span class="n">jdos_adaptive</span><span class="p">,</span><span class="w"> </span><span class="n">weighted_jdos</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">else</span>
<span class="k">        call </span><span class="n">calculate_jdos</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">jdos_adaptive</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">jdos_utils_merge</span><span class="p">(</span><span class="n">jdos_adaptive</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">end if</span>
<span class="k">    end if</span>
<span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">linear</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">calc_weighted_jdos</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        call </span><span class="n">calculate_jdos</span><span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">jdos_linear</span><span class="p">,</span><span class="w"> </span><span class="n">matrix_weights</span><span class="p">,</span><span class="w"> </span><span class="n">weighted_jdos</span><span class="o">=</span><span class="n">weighted_jdos</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">jdos_utils_merge</span><span class="p">(</span><span class="n">jdos_linear</span><span class="p">,</span><span class="w"> </span><span class="n">weighted_jdos</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">else</span>
<span class="k">        call </span><span class="n">calculate_jdos</span><span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">jdos_linear</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="k">call </span><span class="n">jdos_utils_merge</span><span class="p">(</span><span class="n">jdos_linear</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">end if</span>
<span class="k">    end if</span>

<span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">quad</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      call </span><span class="n">io_error</span><span class="p">(</span><span class="s2">&quot;quadratic broadening not implemented&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!if(quad)    call merge_dos(dos_quad)</span>
<span class="w">      </span><span class="c">!if(quad)    call merge_dos(intdos_quad)</span>
<span class="w">    </span><span class="k">end if</span><span class="w"></span>

<span class="c">!    if(.not.on_root) then</span>
<span class="c">!       if(allocated(E)) deallocate(E, stat=ierr)</span>
<span class="c">!       if (ierr/=0) call io_error (&quot;cannot deallocate  E&quot;)</span>
<span class="c">!    endif</span>

<span class="w">    </span><span class="n">time1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_time</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">on_root</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(1x,a59,f11.3,a8)&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">           </span><span class="s1">&#39;+ Time to calculate Joint Density of States              &amp;</span>
<span class="s1">           &amp;      &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time0</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; (sec) +&#39;</span><span class="w"></span>
<span class="w">    </span><span class="k">end if</span><span class="w"></span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dos_per_volume</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">photo</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">fixed</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          </span><span class="n">jdos_fixed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jdos_fixed</span><span class="w"></span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">adaptive</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          </span><span class="n">jdos_adaptive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jdos_adaptive</span><span class="w"></span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">linear</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          </span><span class="n">jdos_linear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jdos_linear</span><span class="w"></span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">      else</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">fixed</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          </span><span class="n">jdos_fixed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jdos_fixed</span><span class="o">/</span><span class="n">cell_volume</span><span class="w"></span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">adaptive</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          </span><span class="n">jdos_adaptive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jdos_adaptive</span><span class="o">/</span><span class="n">cell_volume</span><span class="w"></span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">linear</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          </span><span class="n">jdos_linear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jdos_linear</span><span class="o">/</span><span class="n">cell_volume</span><span class="w"></span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">      end if</span><span class="w"></span>

<span class="w">      </span><span class="c">! if(quad) then</span>
<span class="w">      </span><span class="c">!    dos_quad=dos_quad/cell_volume</span>
<span class="w">      </span><span class="c">!    intdos_quad=intdos_quad/cell_volume</span>
<span class="w">      </span><span class="c">! endif</span>
<span class="w">    </span><span class="k">end if</span>

<span class="k">  end subroutine </span><span class="n">jdos_utils_calculate</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>OptaDOS was developed by The OptaDOS developers group<br>&copy; 2024 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>