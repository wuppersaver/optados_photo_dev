<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Documentation for OptaDOS">
    <meta name="author" content="The OptaDOS developers group" >
    <link rel="icon" href="../favicon.png">

    <title>dos_calculate &ndash; OptaDOS</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">OptaDOS </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>dos_calculate
      <small>Subroutine</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title=" 0.5% of total for procedures.">31 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/dos.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/dos.f90.html'>dos.f90</a></li>
              <li><a href='../module/od_dos.html'>od_dos</a></li>
          <li class="active">dos_calculate</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/dos_calculate.html#src">dos_calculate</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine dos_calculate()  
</h2>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/od_parameters.html'>od_parameters</a></li>
                <li><a href='../module/od_dos_utils.html'>od_dos_utils</a></li>
                <li><a href='../module/od_comms.html'>od_comms</a></li>
                <li><a href='../module/od_electronic.html'>od_electronic</a></li>
                <li><a href='../module/od_io.html'>od_io</a></li>
            </ul>
          </li>
          <li class="list-group-item">
            <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~dos_calculate~~UsesGraph Pages: 1 -->
<svg id="procdos_calculateUsesGraph" width="567pt" height="227pt"
 viewBox="0.00 0.00 567.00 226.77" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dos_calculate~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 222.77)">
<title>proc~~dos_calculate~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-222.77 563,-222.77 563,4 -4,4"/>
<!-- proc~dos_calculate -->
<g id="proc~~dos_calculate~~UsesGraph_node1" class="node">
<title>proc~dos_calculate</title>
<polygon fill="none" stroke="black" points="559,-122 474,-122 474,-98 559,-98 559,-122"/>
<text text-anchor="middle" x="516.5" y="-107.6" font-family="Helvetica,sans-Serif" font-size="10.50">dos_calculate</text>
</g>
<!-- module~od_parameters -->
<g id="proc~~dos_calculate~~UsesGraph_node2" class="node">
<title>module~od_parameters</title>
<g id="a_proc~~dos_calculate~~UsesGraph_node2"><a xlink:href=".././module/od_parameters.html" xlink:title="od_parameters">
<polygon fill="#337ab7" stroke="#337ab7" points="438,-182 344,-182 344,-158 438,-158 438,-182"/>
<text text-anchor="middle" x="391" y="-167.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_parameters</text>
</a>
</g>
</g>
<!-- proc~dos_calculate&#45;&gt;module~od_parameters -->
<g id="proc~~dos_calculate~~UsesGraph_edge1" class="edge">
<title>proc~dos_calculate&#45;&gt;module~od_parameters</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M490.51,-122.14C472.01,-131.13 446.59,-143.48 426.21,-153.38"/>
<polygon fill="#ff0000" stroke="#ff0000" points="424.42,-150.36 416.95,-157.88 427.48,-156.65 424.42,-150.36"/>
</g>
<!-- module~od_dos_utils -->
<g id="proc~~dos_calculate~~UsesGraph_node3" class="node">
<title>module~od_dos_utils</title>
<g id="a_proc~~dos_calculate~~UsesGraph_node3"><a xlink:href=".././module/od_dos_utils.html" xlink:title="od_dos_utils">
<polygon fill="#337ab7" stroke="#337ab7" points="429.5,-102 352.5,-102 352.5,-78 429.5,-78 429.5,-102"/>
<text text-anchor="middle" x="391" y="-87.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_dos_utils</text>
</a>
</g>
</g>
<!-- proc~dos_calculate&#45;&gt;module~od_dos_utils -->
<g id="proc~~dos_calculate~~UsesGraph_edge2" class="edge">
<title>proc~dos_calculate&#45;&gt;module~od_dos_utils</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473.69,-103.23C462.76,-101.46 450.9,-99.54 439.69,-97.72"/>
<polygon fill="#ff0000" stroke="#ff0000" points="440.05,-94.24 429.62,-96.09 438.93,-101.15 440.05,-94.24"/>
</g>
<!-- module~od_io -->
<g id="proc~~dos_calculate~~UsesGraph_node4" class="node">
<title>module~od_io</title>
<g id="a_proc~~dos_calculate~~UsesGraph_node4"><a xlink:href=".././module/od_io.html" xlink:title="od_io">
<polygon fill="#337ab7" stroke="#337ab7" points="180,-142 126,-142 126,-118 180,-118 180,-142"/>
<text text-anchor="middle" x="153" y="-127.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_io</text>
</a>
</g>
</g>
<!-- proc~dos_calculate&#45;&gt;module~od_io -->
<g id="proc~~dos_calculate~~UsesGraph_edge3" class="edge">
<title>proc~dos_calculate&#45;&gt;module~od_io</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M390,-130C335.33,-129.98 321.49,-134.33 267,-130"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M265,-130C240.07,-128.02 211.89,-128.05 190.17,-128.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="189.96,-125.06 180.06,-128.84 190.16,-132.06 189.96,-125.06"/>
</g>
<!-- module~od_comms -->
<g id="proc~~dos_calculate~~UsesGraph_node5" class="node">
<title>module~od_comms</title>
<g id="a_proc~~dos_calculate~~UsesGraph_node5"><a xlink:href=".././module/od_comms.html" xlink:title="od_comms">
<polygon fill="#337ab7" stroke="#337ab7" points="188,-24 118,-24 118,0 188,0 188,-24"/>
<text text-anchor="middle" x="153" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_comms</text>
</a>
</g>
</g>
<!-- proc~dos_calculate&#45;&gt;module~od_comms -->
<g id="proc~~dos_calculate~~UsesGraph_edge4" class="edge">
<title>proc~dos_calculate&#45;&gt;module~od_comms</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M496.47,-97.93C481.2,-88.75 458.93,-76.46 438,-69 355.95,-39.76 254.91,-23.99 198.14,-16.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="198.43,-13.36 188.07,-15.62 197.57,-20.31 198.43,-13.36"/>
</g>
<!-- module~od_electronic -->
<g id="proc~~dos_calculate~~UsesGraph_node6" class="node">
<title>module~od_electronic</title>
<g id="a_proc~~dos_calculate~~UsesGraph_node6"><a xlink:href=".././module/od_electronic.html" xlink:title="od_electronic">
<polygon fill="#337ab7" stroke="#337ab7" points="308,-102 224,-102 224,-78 308,-78 308,-102"/>
<text text-anchor="middle" x="266" y="-87.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_electronic</text>
</a>
</g>
</g>
<!-- proc~dos_calculate&#45;&gt;module~od_electronic -->
<g id="proc~~dos_calculate~~UsesGraph_edge5" class="edge">
<title>proc~dos_calculate&#45;&gt;module~od_electronic</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M473.76,-120.18C449.95,-125.13 419.48,-130.01 392,-130"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M390,-130C357.89,-129.99 323.27,-117.51 298.96,-106.49"/>
<polygon fill="#ff0000" stroke="#ff0000" points="300.4,-103.3 289.86,-102.21 297.42,-109.63 300.4,-103.3"/>
</g>
<!-- module~od_parameters&#45;&gt;module~od_io -->
<g id="proc~~dos_calculate~~UsesGraph_edge7" class="edge">
<title>module~od_parameters&#45;&gt;module~od_io</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M364.81,-157.93C340.44,-147.21 302.14,-132.79 267,-130"/>
</g>
<!-- module~od_cell -->
<g id="proc~~dos_calculate~~UsesGraph_node7" class="node">
<title>module~od_cell</title>
<g id="a_proc~~dos_calculate~~UsesGraph_node7"><a xlink:href=".././module/od_cell.html" xlink:title="od_cell">
<polygon fill="#337ab7" stroke="#337ab7" points="293,-182 239,-182 239,-158 293,-158 293,-182"/>
<text text-anchor="middle" x="266" y="-167.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_cell</text>
</a>
</g>
</g>
<!-- module~od_parameters&#45;&gt;module~od_cell -->
<g id="proc~~dos_calculate~~UsesGraph_edge6" class="edge">
<title>module~od_parameters&#45;&gt;module~od_cell</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M343.85,-170C330.43,-170 315.97,-170 303.25,-170"/>
<polygon fill="#ff0000" stroke="#ff0000" points="303.04,-166.5 293.04,-170 303.04,-173.5 303.04,-166.5"/>
</g>
<!-- module~od_constants -->
<g id="proc~~dos_calculate~~UsesGraph_node8" class="node">
<title>module~od_constants</title>
<g id="a_proc~~dos_calculate~~UsesGraph_node8"><a xlink:href=".././module/od_constants.html" xlink:title="od_constants">
<polygon fill="#337ab7" stroke="#337ab7" points="82,-103 0,-103 0,-79 82,-79 82,-103"/>
<text text-anchor="middle" x="41" y="-88.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">od_constants</text>
</a>
</g>
</g>
<!-- module~od_parameters&#45;&gt;module~od_constants -->
<g id="proc~~dos_calculate~~UsesGraph_edge8" class="edge">
<title>module~od_parameters&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M364.94,-182.02C321.16,-201.32 228.35,-234.66 154,-210"/>
</g>
<!-- module~od_dos_utils&#45;&gt;module~od_electronic -->
<g id="proc~~dos_calculate~~UsesGraph_edge9" class="edge">
<title>module~od_dos_utils&#45;&gt;module~od_electronic</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M352.43,-90C341.72,-90 329.86,-90 318.48,-90"/>
<polygon fill="#cbff00" stroke="#cbff00" points="318.2,-86.5 308.2,-90 318.2,-93.5 318.2,-86.5"/>
</g>
<!-- module~od_dos_utils&#45;&gt;module~od_constants -->
<g id="proc~~dos_calculate~~UsesGraph_edge10" class="edge">
<title>module~od_dos_utils&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M352.2,-78.02C305.76,-64.68 224.48,-45.74 154,-52"/>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M152,-52C124.66,-53.9 95.49,-64.68 74.07,-74.43"/>
<polygon fill="#cbff00" stroke="#cbff00" points="72.36,-71.37 64.81,-78.8 75.34,-77.7 72.36,-71.37"/>
</g>
<!-- module~od_io&#45;&gt;module~od_constants -->
<g id="proc~~dos_calculate~~UsesGraph_edge11" class="edge">
<title>module~od_io&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M125.93,-120.76C113.97,-116.52 99.45,-111.37 85.88,-106.56"/>
<polygon fill="#00ff66" stroke="#00ff66" points="86.81,-103.17 76.21,-103.13 84.47,-109.77 86.81,-103.17"/>
</g>
<!-- module~od_comms&#45;&gt;module~od_constants -->
<g id="proc~~dos_calculate~~UsesGraph_edge12" class="edge">
<title>module~od_comms&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M134.81,-24.34C116.73,-37.33 88.08,-57.91 67.39,-72.76"/>
<polygon fill="#0066ff" stroke="#0066ff" points="65.15,-70.07 59.07,-78.74 69.23,-75.75 65.15,-70.07"/>
</g>
<!-- module~od_electronic&#45;&gt;module~od_constants -->
<g id="proc~~dos_calculate~~UsesGraph_edge13" class="edge">
<title>module~od_electronic&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M245.58,-77.88C223.91,-65.67 187.48,-49.03 154,-52"/>
</g>
<!-- module~od_cell&#45;&gt;module~od_io -->
<g id="proc~~dos_calculate~~UsesGraph_edge14" class="edge">
<title>module~od_cell&#45;&gt;module~od_io</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M238.98,-160.62C224.33,-155.34 205.83,-148.68 189.83,-142.91"/>
<polygon fill="#ff0000" stroke="#ff0000" points="190.84,-139.56 180.25,-139.46 188.47,-146.14 190.84,-139.56"/>
</g>
<!-- module~od_cell&#45;&gt;module~od_constants -->
<g id="proc~~dos_calculate~~UsesGraph_edge15" class="edge">
<title>module~od_cell&#45;&gt;module~od_constants</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M241.91,-182.12C214.57,-195.81 170.62,-215.51 154,-210"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M152,-210C104.02,-194.09 69.2,-141.88 52.71,-112.18"/>
<polygon fill="#ff0000" stroke="#ff0000" points="55.63,-110.21 47.82,-103.05 49.45,-113.52 55.63,-110.21"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
          </li>
      </ul>
    </div>


    <p>$
$    unshifted_efermi=efermi
$
$    if(set_efermi_zero) then
$       if(on_root) then
$          write(stdout,*)
$          write(stdout,'(1x,a71)')  '+----------------------- Shift Fermi Energy --------------------------+'
$          write(stdout,'(1x,a1,a46,a24)')"|", " Setting Fermi energy to 0 : ","|"
$       endif
$       E(:)=E(:)-efermi
$       band_energy(:,:,:) = band_energy(:,:,:) - efermi
$       efermi=0.0_dp
$    endif
$
$    if(on_root) then
$       write(stdout,'(1x,a1,a46,f8.4,a3,12x,a8)')"|", " Fermi energy used : ", unshifted_efermi,"eV","| &lt;- Ef "
$       write(stdout,'(1x,a71)')  '+---------------------------------------------------------------------+'
$
$       time1=io_time()
$       write(stdout,'(1x,a40,f11.3,a)') 'Time to perfom analysis ',time1-time0,' (sec)'
$       !-------------------------------------------------------------------------------
$    end if</p>

    <h3>Arguments</h3>
    <em>None</em>
    <br>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~dos_calculate~~CallsGraph Pages: 1 -->
<svg id="procdos_calculateCallsGraph" width="641pt" height="618pt"
 viewBox="0.00 0.00 641.00 618.28" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dos_calculate~~CallsGraph" class="graph" transform="scale(1.82 1.82) rotate(0) translate(4 1121.64)">
<title>proc~~dos_calculate~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1121.64 1163,-1121.64 1163,4 -4,4"/>
<!-- proc~dos_calculate -->
<g id="proc~~dos_calculate~~CallsGraph_node1" class="node">
<title>proc~dos_calculate</title>
<polygon fill="none" stroke="black" points="85,-692.58 0,-692.58 0,-668.58 85,-668.58 85,-692.58"/>
<text text-anchor="middle" x="42.5" y="-678.18" font-family="Helvetica,sans-Serif" font-size="10.50">dos_calculate</text>
</g>
<!-- proc~dos_utils_calculate -->
<g id="proc~~dos_calculate~~CallsGraph_node2" class="node">
<title>proc~dos_utils_calculate</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node2"><a xlink:href=".././proc/dos_utils_calculate.html" xlink:title="dos_utils_calculate">
<polygon fill="#d9534f" stroke="#d9534f" points="474,-652.58 362,-652.58 362,-628.58 474,-628.58 474,-652.58"/>
<text text-anchor="middle" x="418" y="-638.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_calculate</text>
</a>
</g>
</g>
<!-- proc~dos_calculate&#45;&gt;proc~dos_utils_calculate -->
<g id="proc~~dos_calculate~~CallsGraph_edge1" class="edge">
<title>proc~dos_calculate&#45;&gt;proc~dos_utils_calculate</title>
<path fill="none" stroke="#ff0000" d="M85.22,-672.33C96.78,-670.24 109.35,-668.15 121,-666.58 200.03,-656 291.52,-648.72 351.63,-644.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="351.99,-648.09 361.73,-643.93 351.52,-641.11 351.99,-648.09"/>
</g>
<!-- proc~io_time -->
<g id="proc~~dos_calculate~~CallsGraph_node3" class="node">
<title>proc~io_time</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node3"><a xlink:href=".././proc/io_time.html" xlink:title="io_time">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1038.5,-989.58 984.5,-989.58 984.5,-965.58 1038.5,-965.58 1038.5,-989.58"/>
<text text-anchor="middle" x="1011.5" y="-975.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_time</text>
</a>
</g>
</g>
<!-- proc~dos_calculate&#45;&gt;proc~io_time -->
<g id="proc~~dos_calculate~~CallsGraph_edge5" class="edge">
<title>proc~dos_calculate&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#ff0000" d="M44.04,-692.85C46.41,-732.74 58.72,-860.78 121,-939.58 215.21,-1058.78 265.07,-1110.58 417,-1110.58 417,-1110.58 417,-1110.58 622.5,-1110.58 755.42,-1110.58 810.22,-1142.36 918,-1064.58 946.37,-1044.11 927.11,-1016.96 954,-994.58 959.97,-989.62 967.35,-986.1 974.8,-983.61"/>
<polygon fill="#ff0000" stroke="#ff0000" points="975.81,-986.96 984.5,-980.9 973.92,-980.22 975.81,-986.96"/>
</g>
<!-- proc~dos_utils_set_efermi -->
<g id="proc~~dos_calculate~~CallsGraph_node4" class="node">
<title>proc~dos_utils_set_efermi</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node4"><a xlink:href=".././proc/dos_utils_set_efermi.html" xlink:title="dos_utils_set_efermi">
<polygon fill="#d9534f" stroke="#d9534f" points="276.5,-612.58 156.5,-612.58 156.5,-588.58 276.5,-588.58 276.5,-612.58"/>
<text text-anchor="middle" x="216.5" y="-598.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_set_efermi</text>
</a>
</g>
</g>
<!-- proc~dos_calculate&#45;&gt;proc~dos_utils_set_efermi -->
<g id="proc~~dos_calculate~~CallsGraph_edge2" class="edge">
<title>proc~dos_calculate&#45;&gt;proc~dos_utils_set_efermi</title>
<path fill="none" stroke="#ff0000" d="M58.06,-668.49C73.02,-656.6 97.39,-638.67 121,-627.58 130.81,-622.97 141.58,-618.99 152.22,-615.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="153.37,-618.91 161.92,-612.66 151.34,-612.21 153.37,-618.91"/>
</g>
<!-- proc~dos_utils_compute_bandgap -->
<g id="proc~~dos_calculate~~CallsGraph_node5" class="node">
<title>proc~dos_utils_compute_bandgap</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node5"><a xlink:href=".././proc/dos_utils_compute_bandgap.html" xlink:title="dos_utils_compute_bandgap">
<polygon fill="#d9534f" stroke="#d9534f" points="918,-892.58 755,-892.58 755,-868.58 918,-868.58 918,-892.58"/>
<text text-anchor="middle" x="836.5" y="-878.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_compute_bandgap</text>
</a>
</g>
</g>
<!-- proc~dos_calculate&#45;&gt;proc~dos_utils_compute_bandgap -->
<g id="proc~~dos_calculate~~CallsGraph_edge3" class="edge">
<title>proc~dos_calculate&#45;&gt;proc~dos_utils_compute_bandgap</title>
<path fill="none" stroke="#ff0000" d="M85.24,-691.13C217.24,-724.46 625.84,-827.64 777.8,-866.01"/>
<polygon fill="#ff0000" stroke="#ff0000" points="777.31,-869.5 787.86,-868.55 779.02,-862.71 777.31,-869.5"/>
</g>
<!-- proc~dos_utils_compute_dos_at_efermi -->
<g id="proc~~dos_calculate~~CallsGraph_node6" class="node">
<title>proc~dos_utils_compute_dos_at_efermi</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node6"><a xlink:href=".././proc/dos_utils_compute_dos_at_efermi.html" xlink:title="dos_utils_compute_dos_at_efermi">
<polygon fill="#d9534f" stroke="#d9534f" points="312,-930.58 121,-930.58 121,-906.58 312,-906.58 312,-930.58"/>
<text text-anchor="middle" x="216.5" y="-916.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_compute_dos_at_efermi</text>
</a>
</g>
</g>
<!-- proc~dos_calculate&#45;&gt;proc~dos_utils_compute_dos_at_efermi -->
<g id="proc~~dos_calculate~~CallsGraph_edge4" class="edge">
<title>proc~dos_calculate&#45;&gt;proc~dos_utils_compute_dos_at_efermi</title>
<path fill="none" stroke="#ff0000" d="M46.43,-692.8C54.19,-723.08 77.68,-802.87 121,-854.58 137.48,-874.25 161.46,-890.4 181.15,-901.55"/>
<polygon fill="#ff0000" stroke="#ff0000" points="179.68,-904.74 190.13,-906.47 183.04,-898.6 179.68,-904.74"/>
</g>
<!-- proc~dos_utils_compute_band_energies -->
<g id="proc~~dos_calculate~~CallsGraph_node7" class="node">
<title>proc~dos_utils_compute_band_energies</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node7"><a xlink:href=".././proc/dos_utils_compute_band_energies.html" xlink:title="dos_utils_compute_band_energies">
<polygon fill="#d9534f" stroke="#d9534f" points="719,-692.58 524,-692.58 524,-668.58 719,-668.58 719,-692.58"/>
<text text-anchor="middle" x="621.5" y="-678.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_compute_band_energies</text>
</a>
</g>
</g>
<!-- proc~dos_calculate&#45;&gt;proc~dos_utils_compute_band_energies -->
<g id="proc~~dos_calculate~~CallsGraph_edge6" class="edge">
<title>proc~dos_calculate&#45;&gt;proc~dos_utils_compute_band_energies</title>
<path fill="none" stroke="#ff0000" d="M85.46,-680.58C174.53,-680.58 384.86,-680.58 513.68,-680.58"/>
<polygon fill="#ff0000" stroke="#ff0000" points="513.97,-684.08 523.97,-680.58 513.97,-677.08 513.97,-684.08"/>
</g>
<!-- proc~write_dos -->
<g id="proc~~dos_calculate~~CallsGraph_node8" class="node">
<title>proc~write_dos</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node8"><a xlink:href=".././proc/write_dos.html" xlink:title="write_dos">
<polygon fill="#d9534f" stroke="#d9534f" points="653,-380.58 590,-380.58 590,-356.58 653,-356.58 653,-380.58"/>
<text text-anchor="middle" x="621.5" y="-366.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_dos</text>
</a>
</g>
</g>
<!-- proc~dos_calculate&#45;&gt;proc~write_dos -->
<g id="proc~~dos_calculate~~CallsGraph_edge7" class="edge">
<title>proc~dos_calculate&#45;&gt;proc~write_dos</title>
<path fill="none" stroke="#ff0000" d="M50.96,-668.33C63.62,-648.2 90.88,-607.56 121,-579.58 209.42,-497.45 236.95,-477.83 348,-430.58 426.43,-397.21 525.54,-380.45 580.02,-373.21"/>
<polygon fill="#ff0000" stroke="#ff0000" points="580.51,-376.68 589.98,-371.93 579.61,-369.73 580.51,-376.68"/>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;proc~io_time -->
<g id="proc~~dos_calculate~~CallsGraph_edge10" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#ff0000" d="M426.01,-652.75C456.64,-704.43 584.82,-906.07 755,-969.58 828.95,-997.18 923.46,-990.3 974.28,-983.52"/>
<polygon fill="#ff0000" stroke="#ff0000" points="975.02,-986.95 984.44,-982.09 974.05,-980.02 975.02,-986.95"/>
</g>
<!-- proc~io_error -->
<g id="proc~~dos_calculate~~CallsGraph_node9" class="node">
<title>proc~io_error</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node9"><a xlink:href=".././proc/io_error.html" xlink:title="io_error">
<polygon fill="#d9534f" stroke="#d9534f" points="1159,-656.58 1105,-656.58 1105,-632.58 1159,-632.58 1159,-656.58"/>
<text text-anchor="middle" x="1132" y="-642.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_error</text>
</a>
</g>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;proc~io_error -->
<g id="proc~~dos_calculate~~CallsGraph_edge8" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#ff0000" d="M449.86,-628.49C508.29,-606.31 639.58,-559.91 755,-543.58 826.73,-533.44 847.32,-527.68 918,-543.58 989.52,-559.68 1065.25,-602.71 1104.27,-627.09"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1102.61,-630.18 1112.93,-632.57 1106.35,-624.27 1102.61,-630.18"/>
</g>
<!-- proc~dos_utils_merge -->
<g id="proc~~dos_calculate~~CallsGraph_node10" class="node">
<title>proc~dos_utils_merge</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node10"><a xlink:href=".././proc/dos_utils_merge.html" xlink:title="dos_utils_merge">
<polygon fill="#d9534f" stroke="#d9534f" points="671,-534.58 572,-534.58 572,-510.58 671,-510.58 671,-534.58"/>
<text text-anchor="middle" x="621.5" y="-520.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_merge</text>
</a>
</g>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;proc~dos_utils_merge -->
<g id="proc~~dos_calculate~~CallsGraph_edge9" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;proc~dos_utils_merge</title>
<path fill="none" stroke="#ff0000" d="M429.34,-628.48C446.83,-608.78 484.25,-569.85 524,-548.58 535.7,-542.32 549.03,-537.48 561.96,-533.77"/>
<polygon fill="#ff0000" stroke="#ff0000" points="562.99,-537.12 571.74,-531.15 561.18,-530.36 562.99,-537.12"/>
</g>
<!-- interface~comms_bcast -->
<g id="proc~~dos_calculate~~CallsGraph_node11" class="node">
<title>interface~comms_bcast</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node11"><a xlink:href=".././interface/comms_bcast.html" xlink:title="comms_bcast">
<polygon fill="#a7506f" stroke="#a7506f" points="879,-576.58 794,-576.58 794,-552.58 879,-552.58 879,-576.58"/>
<text text-anchor="middle" x="836.5" y="-562.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">comms_bcast</text>
</a>
</g>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;interface~comms_bcast -->
<g id="proc~~dos_calculate~~CallsGraph_edge11" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;interface~comms_bcast</title>
<path fill="none" stroke="#ff0000" d="M474.08,-643.86C535.58,-645.7 637.23,-643.25 719,-614.58 737.15,-608.22 737.69,-598.95 755,-590.58 764.12,-586.17 774.18,-582.25 784,-578.88"/>
<polygon fill="#ff0000" stroke="#ff0000" points="785.29,-582.14 793.7,-575.68 783.1,-575.49 785.29,-582.14"/>
</g>
<!-- proc~elec_read_band_gradient -->
<g id="proc~~dos_calculate~~CallsGraph_node13" class="node">
<title>proc~elec_read_band_gradient</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node13"><a xlink:href=".././proc/elec_read_band_gradient.html" xlink:title="elec_read_band_gradient">
<polygon fill="#d9534f" stroke="#d9534f" points="695,-772.58 548,-772.58 548,-748.58 695,-748.58 695,-772.58"/>
<text text-anchor="middle" x="621.5" y="-758.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elec_read_band_gradient</text>
</a>
</g>
</g>
<!-- proc~dos_utils_calculate&#45;&gt;proc~elec_read_band_gradient -->
<g id="proc~~dos_calculate~~CallsGraph_edge12" class="edge">
<title>proc~dos_utils_calculate&#45;&gt;proc~elec_read_band_gradient</title>
<path fill="none" stroke="#ff0000" d="M439.43,-652.75C475.43,-674.19 550.25,-718.75 591.55,-743.34"/>
<polygon fill="#ff0000" stroke="#ff0000" points="589.93,-746.45 600.32,-748.56 593.51,-740.44 589.93,-746.45"/>
</g>
<!-- proc~dos_utils_set_efermi&#45;&gt;proc~dos_utils_calculate -->
<g id="proc~~dos_calculate~~CallsGraph_edge16" class="edge">
<title>proc~dos_utils_set_efermi&#45;&gt;proc~dos_utils_calculate</title>
<path fill="none" stroke="#48ff00" d="M276.55,-612.42C300.28,-617.18 327.72,-622.68 352.02,-627.55"/>
<polygon fill="#48ff00" stroke="#48ff00" points="351.37,-630.99 361.86,-629.53 352.74,-624.13 351.37,-630.99"/>
</g>
<!-- proc~dos_utils_set_efermi&#45;&gt;proc~io_error -->
<g id="proc~~dos_calculate~~CallsGraph_edge14" class="edge">
<title>proc~dos_utils_set_efermi&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#48ff00" d="M233.58,-588.31C265.64,-563.92 335.49,-511.24 348,-505.58 461.08,-454.44 496.39,-444.58 620.5,-444.58 620.5,-444.58 620.5,-444.58 837.5,-444.58 940.73,-444.58 987.53,-400.18 1069,-463.58 1118.73,-502.29 1128.8,-583.03 1130.68,-622.25"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1127.19,-622.48 1131.03,-632.36 1134.19,-622.24 1127.19,-622.48"/>
</g>
<!-- proc~dos_utils_set_efermi&#45;&gt;interface~comms_bcast -->
<g id="proc~~dos_calculate~~CallsGraph_edge15" class="edge">
<title>proc~dos_utils_set_efermi&#45;&gt;interface~comms_bcast</title>
<path fill="none" stroke="#48ff00" d="M276.76,-597.13C397.31,-590.11 669.35,-574.26 783.52,-567.61"/>
<polygon fill="#48ff00" stroke="#48ff00" points="783.96,-571.09 793.74,-567.02 783.55,-564.1 783.96,-571.09"/>
</g>
<!-- interface~comms_reduce -->
<g id="proc~~dos_calculate~~CallsGraph_node12" class="node">
<title>interface~comms_reduce</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node12"><a xlink:href=".././interface/comms_reduce.html" xlink:title="comms_reduce">
<polygon fill="#a7506f" stroke="#a7506f" points="883.5,-496.58 789.5,-496.58 789.5,-472.58 883.5,-472.58 883.5,-496.58"/>
<text text-anchor="middle" x="836.5" y="-482.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">comms_reduce</text>
</a>
</g>
</g>
<!-- proc~dos_utils_set_efermi&#45;&gt;interface~comms_reduce -->
<g id="proc~~dos_calculate~~CallsGraph_edge13" class="edge">
<title>proc~dos_utils_set_efermi&#45;&gt;interface~comms_reduce</title>
<path fill="none" stroke="#48ff00" d="M246.43,-588.45C300.06,-566.59 418.99,-521.07 524,-501.58 612.15,-485.23 716.54,-482.92 779.32,-483.32"/>
<polygon fill="#48ff00" stroke="#48ff00" points="779.37,-486.83 789.41,-483.42 779.44,-479.83 779.37,-486.83"/>
</g>
<!-- proc~dos_utils_compute_bandgap&#45;&gt;proc~io_time -->
<g id="proc~~dos_calculate~~CallsGraph_edge17" class="edge">
<title>proc~dos_utils_compute_bandgap&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#00ff91" d="M884.16,-892.67C895.54,-896.42 907.47,-901.05 918,-906.58 945.04,-920.79 972.34,-942.91 990.2,-958.69"/>
<polygon fill="#00ff91" stroke="#00ff91" points="987.93,-961.35 997.71,-965.44 992.61,-956.15 987.93,-961.35"/>
</g>
<!-- proc~dos_utils_compute_bandgap&#45;&gt;proc~io_error -->
<g id="proc~~dos_calculate~~CallsGraph_edge20" class="edge">
<title>proc~dos_utils_compute_bandgap&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#00ff91" d="M887.71,-892.62C939.07,-901.76 1018.31,-906.66 1069,-865.58 1100.22,-840.28 1120.73,-717.66 1128.03,-666.78"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1131.51,-667.19 1129.42,-656.81 1124.57,-666.23 1131.51,-667.19"/>
</g>
<!-- interface~comms_recv -->
<g id="proc~~dos_calculate~~CallsGraph_node14" class="node">
<title>interface~comms_recv</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node14"><a xlink:href=".././interface/comms_recv.html" xlink:title="comms_recv">
<polygon fill="#a7506f" stroke="#a7506f" points="1051,-814.58 972,-814.58 972,-790.58 1051,-790.58 1051,-814.58"/>
<text text-anchor="middle" x="1011.5" y="-800.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">comms_recv</text>
</a>
</g>
</g>
<!-- proc~dos_utils_compute_bandgap&#45;&gt;interface~comms_recv -->
<g id="proc~~dos_calculate~~CallsGraph_edge18" class="edge">
<title>proc~dos_utils_compute_bandgap&#45;&gt;interface~comms_recv</title>
<path fill="none" stroke="#00ff91" d="M860.39,-868.54C883.66,-856.51 920.89,-837.79 954,-823.58 958.17,-821.79 962.55,-820.01 966.94,-818.28"/>
<polygon fill="#00ff91" stroke="#00ff91" points="968.45,-821.45 976.52,-814.59 965.93,-814.92 968.45,-821.45"/>
</g>
<!-- interface~comms_send -->
<g id="proc~~dos_calculate~~CallsGraph_node15" class="node">
<title>interface~comms_send</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node15"><a xlink:href=".././interface/comms_send.html" xlink:title="comms_send">
<polygon fill="#a7506f" stroke="#a7506f" points="1052.5,-856.58 970.5,-856.58 970.5,-832.58 1052.5,-832.58 1052.5,-856.58"/>
<text text-anchor="middle" x="1011.5" y="-842.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">comms_send</text>
</a>
</g>
</g>
<!-- proc~dos_utils_compute_bandgap&#45;&gt;interface~comms_send -->
<g id="proc~~dos_calculate~~CallsGraph_edge19" class="edge">
<title>proc~dos_utils_compute_bandgap&#45;&gt;interface~comms_send</title>
<path fill="none" stroke="#00ff91" d="M895.59,-868.5C916.58,-864.13 940.09,-859.24 960.34,-855.02"/>
<polygon fill="#00ff91" stroke="#00ff91" points="961.23,-858.41 970.3,-852.95 959.8,-851.56 961.23,-858.41"/>
</g>
<!-- proc~dos_utils_compute_dos_at_efermi&#45;&gt;proc~io_time -->
<g id="proc~~dos_calculate~~CallsGraph_edge21" class="edge">
<title>proc~dos_utils_compute_dos_at_efermi&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#0091ff" d="M239.28,-930.69C288.27,-957.09 411.66,-1018.96 524,-1037.58 696.75,-1066.22 750.02,-1086.05 918,-1036.58 944.85,-1028.68 971.36,-1010.41 989.06,-996.28"/>
<polygon fill="#0091ff" stroke="#0091ff" points="991.51,-998.79 997.01,-989.73 987.07,-993.39 991.51,-998.79"/>
</g>
<!-- proc~dos_utils_compute_dos_at_efermi&#45;&gt;interface~comms_bcast -->
<g id="proc~~dos_calculate~~CallsGraph_edge23" class="edge">
<title>proc~dos_utils_compute_dos_at_efermi&#45;&gt;interface~comms_bcast</title>
<path fill="none" stroke="#0091ff" d="M233.77,-906.37C277.91,-873.84 404.64,-784.58 524,-739.58 606.62,-708.44 653.55,-760.85 719,-701.58 760.27,-664.21 714.02,-619.28 755,-581.58 763.05,-574.18 773.48,-569.68 784.16,-567.02"/>
<polygon fill="#0091ff" stroke="#0091ff" points="784.85,-570.45 793.96,-565.06 783.47,-563.59 784.85,-570.45"/>
</g>
<!-- proc~dos_utils_calculate_at_e -->
<g id="proc~~dos_calculate~~CallsGraph_node16" class="node">
<title>proc~dos_utils_calculate_at_e</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node16"><a xlink:href=".././proc/dos_utils_calculate_at_e.html" xlink:title="dos_utils_calculate_at_e">
<polygon fill="#d9534f" stroke="#d9534f" points="488,-968.58 348,-968.58 348,-944.58 488,-944.58 488,-968.58"/>
<text text-anchor="middle" x="418" y="-954.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dos_utils_calculate_at_e</text>
</a>
</g>
</g>
<!-- proc~dos_utils_compute_dos_at_efermi&#45;&gt;proc~dos_utils_calculate_at_e -->
<g id="proc~~dos_calculate~~CallsGraph_edge22" class="edge">
<title>proc~dos_utils_compute_dos_at_efermi&#45;&gt;proc~dos_utils_calculate_at_e</title>
<path fill="none" stroke="#0091ff" d="M280.62,-930.61C300.73,-934.44 323.15,-938.71 343.91,-942.66"/>
<polygon fill="#0091ff" stroke="#0091ff" points="343.47,-946.14 353.95,-944.57 344.78,-939.26 343.47,-946.14"/>
</g>
<!-- proc~dos_utils_compute_band_energies&#45;&gt;proc~io_time -->
<g id="proc~~dos_calculate~~CallsGraph_edge24" class="edge">
<title>proc~dos_utils_compute_band_energies&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#4800ff" d="M655.53,-692.79C676.82,-702.34 703.36,-717.69 719,-739.58 761.88,-799.6 702.36,-849.93 755,-901.58 807.76,-953.35 847.78,-911.51 918,-934.58 939.01,-941.49 961.53,-951.89 979.09,-960.73"/>
<polygon fill="#4800ff" stroke="#4800ff" points="977.8,-964 988.3,-965.45 981,-957.77 977.8,-964"/>
</g>
<!-- proc~dos_utils_compute_band_energies&#45;&gt;interface~comms_reduce -->
<g id="proc~~dos_calculate~~CallsGraph_edge25" class="edge">
<title>proc~dos_utils_compute_band_energies&#45;&gt;interface~comms_reduce</title>
<path fill="none" stroke="#4800ff" d="M632.87,-668.56C654.42,-643.87 706.13,-586.22 755,-543.58 772.08,-528.69 792.72,-513.61 808.82,-502.43"/>
<polygon fill="#4800ff" stroke="#4800ff" points="810.98,-505.19 817.25,-496.64 807.02,-499.42 810.98,-505.19"/>
</g>
<!-- proc~write_dos&#45;&gt;proc~io_error -->
<g id="proc~~dos_calculate~~CallsGraph_edge26" class="edge">
<title>proc~write_dos&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#ff00da" d="M653.32,-368.57C743.98,-369.19 1007.28,-375.74 1069,-430.58 1125.26,-480.57 1131.82,-578.19 1131.72,-622.16"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1128.22,-622.31 1131.57,-632.36 1135.22,-622.41 1128.22,-622.31"/>
</g>
<!-- proc~io_date -->
<g id="proc~~dos_calculate~~CallsGraph_node17" class="node">
<title>proc~io_date</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node17"><a xlink:href=".././proc/io_date.html" xlink:title="io_date">
<polygon fill="#d9534f" stroke="#d9534f" points="1159,-26.58 1105,-26.58 1105,-2.58 1159,-2.58 1159,-26.58"/>
<text text-anchor="middle" x="1132" y="-12.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_date</text>
</a>
</g>
</g>
<!-- proc~write_dos&#45;&gt;proc~io_date -->
<g id="proc~~dos_calculate~~CallsGraph_edge27" class="edge">
<title>proc~write_dos&#45;&gt;proc~io_date</title>
<path fill="none" stroke="#ff00da" d="M628.79,-356.45C657.32,-302.97 780.69,-87.63 954,-13.58 999.59,5.89 1058.02,0.42 1094.99,-6.28"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1094.34,-9.72 1104.82,-8.19 1095.67,-2.85 1094.34,-9.72"/>
</g>
<!-- proc~write_dos_xmgrace -->
<g id="proc~~dos_calculate~~CallsGraph_node18" class="node">
<title>proc~write_dos_xmgrace</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node18"><a xlink:href=".././proc/write_dos_xmgrace.html" xlink:title="write_dos_xmgrace">
<polygon fill="#d9534f" stroke="#d9534f" points="894,-254.58 779,-254.58 779,-230.58 894,-230.58 894,-254.58"/>
<text text-anchor="middle" x="836.5" y="-240.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">write_dos_xmgrace</text>
</a>
</g>
</g>
<!-- proc~write_dos&#45;&gt;proc~write_dos_xmgrace -->
<g id="proc~~dos_calculate~~CallsGraph_edge28" class="edge">
<title>proc~write_dos&#45;&gt;proc~write_dos_xmgrace</title>
<path fill="none" stroke="#ff00da" d="M642.92,-356.5C680.93,-334.02 762.63,-285.69 806.4,-259.8"/>
<polygon fill="#ff00da" stroke="#ff00da" points="808.31,-262.73 815.14,-254.63 804.75,-256.71 808.31,-262.73"/>
</g>
<!-- proc~io_file_unit -->
<g id="proc~~dos_calculate~~CallsGraph_node19" class="node">
<title>proc~io_file_unit</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node19"><a xlink:href=".././proc/io_file_unit.html" xlink:title="io_file_unit">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1046.5,-496.58 976.5,-496.58 976.5,-472.58 1046.5,-472.58 1046.5,-496.58"/>
<text text-anchor="middle" x="1011.5" y="-482.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io_file_unit</text>
</a>
</g>
</g>
<!-- proc~write_dos&#45;&gt;proc~io_file_unit -->
<g id="proc~~dos_calculate~~CallsGraph_edge29" class="edge">
<title>proc~write_dos&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#ff00da" d="M653.27,-377.78C721.85,-398.29 887.44,-447.79 966.74,-471.5"/>
<polygon fill="#ff00da" stroke="#ff00da" points="965.85,-474.89 976.43,-474.4 967.85,-468.18 965.85,-474.89"/>
</g>
<!-- proc~dos_utils_merge&#45;&gt;interface~comms_reduce -->
<g id="proc~~dos_calculate~~CallsGraph_edge30" class="edge">
<title>proc~dos_utils_merge&#45;&gt;interface~comms_reduce</title>
<path fill="none" stroke="#ff8b00" d="M671.1,-513.91C703.26,-508.18 745.53,-500.63 779.16,-494.63"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="780.07,-498.03 789.3,-492.83 778.84,-491.14 780.07,-498.03"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~io_time -->
<g id="proc~~dos_calculate~~CallsGraph_edge35" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#00ff2e" d="M627.81,-772.8C642.61,-805.26 687.72,-893.95 755,-934.58 824.16,-976.36 922.06,-980.68 974.31,-979.54"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="974.55,-983.03 984.44,-979.24 974.34,-976.04 974.55,-983.03"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~io_error -->
<g id="proc~~dos_calculate~~CallsGraph_edge33" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#00ff2e" d="M668.73,-748.46C684.69,-744.19 702.66,-739.28 719,-734.58 735.08,-729.96 738.79,-727.73 755,-723.58 893.07,-688.28 929.71,-688.72 1069,-658.58 1077.36,-656.78 1086.34,-654.78 1094.79,-652.87"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1095.8,-656.24 1104.78,-650.61 1094.25,-649.41 1095.8,-656.24"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;interface~comms_bcast -->
<g id="proc~~dos_calculate~~CallsGraph_edge31" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;interface~comms_bcast</title>
<path fill="none" stroke="#00ff2e" d="M695.19,-750.26C704.05,-746.48 712.31,-741.39 719,-734.58 765.22,-687.51 709.95,-638.78 755,-590.58 762.83,-582.2 773.38,-576.52 784.26,-572.66"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="785.31,-576 793.84,-569.72 783.26,-569.31 785.31,-576"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;interface~comms_recv -->
<g id="proc~~dos_calculate~~CallsGraph_edge37" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;interface~comms_recv</title>
<path fill="none" stroke="#00ff2e" d="M684.33,-772.6C706.54,-776.58 731.83,-780.72 755,-783.58 826.65,-792.45 910.16,-797.71 961.68,-800.37"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="961.7,-803.88 971.86,-800.89 962.05,-796.89 961.7,-803.88"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;interface~comms_send -->
<g id="proc~~dos_calculate~~CallsGraph_edge36" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;interface~comms_send</title>
<path fill="none" stroke="#00ff2e" d="M654.77,-772.61C681.35,-782.14 720.2,-795.2 755,-803.58 825.43,-820.55 908.5,-832.41 960.35,-838.87"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="959.94,-842.34 970.29,-840.08 960.79,-835.39 959.94,-842.34"/>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~io_file_unit -->
<g id="proc~~dos_calculate~~CallsGraph_edge32" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#00ff2e" d="M695.25,-749.63C703.99,-745.93 712.21,-741.04 719,-734.58 756.59,-698.85 716.81,-658.67 755,-623.58 809.78,-573.26 853.79,-623.14 918,-585.58 952.43,-565.45 981.45,-528.34 997.37,-505.14"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1000.36,-506.97 1003,-496.71 994.54,-503.09 1000.36,-506.97"/>
</g>
<!-- proc~algor_dist_array -->
<g id="proc~~dos_calculate~~CallsGraph_node20" class="node">
<title>proc~algor_dist_array</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node20"><a xlink:href=".././proc/algor_dist_array.html" xlink:title="algor_dist_array">
<polygon fill="#d9534f" stroke="#d9534f" points="1060.5,-734.58 962.5,-734.58 962.5,-710.58 1060.5,-710.58 1060.5,-734.58"/>
<text text-anchor="middle" x="1011.5" y="-720.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">algor_dist_array</text>
</a>
</g>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~algor_dist_array -->
<g id="proc~~dos_calculate~~CallsGraph_edge34" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~algor_dist_array</title>
<path fill="none" stroke="#00ff2e" d="M695.28,-749.24C714.66,-746.47 735.59,-743.69 755,-741.58 822.57,-734.24 900.51,-728.89 952.37,-725.77"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="952.6,-729.27 962.38,-725.18 952.19,-722.28 952.6,-729.27"/>
</g>
<!-- proc~elec_read_optical_mat -->
<g id="proc~~dos_calculate~~CallsGraph_node21" class="node">
<title>proc~elec_read_optical_mat</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node21"><a xlink:href=".././proc/elec_read_optical_mat.html" xlink:title="elec_read_optical_mat">
<polygon fill="#d9534f" stroke="#d9534f" points="902.5,-774.58 770.5,-774.58 770.5,-750.58 902.5,-750.58 902.5,-774.58"/>
<text text-anchor="middle" x="836.5" y="-760.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elec_read_optical_mat</text>
</a>
</g>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~elec_read_optical_mat -->
<g id="proc~~dos_calculate~~CallsGraph_edge38" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~elec_read_optical_mat</title>
<path fill="none" stroke="#00ff2e" d="M695.21,-761.27C716.13,-761.46 738.99,-761.68 760.07,-761.88"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="760.23,-765.38 770.26,-761.97 760.29,-758.38 760.23,-765.38"/>
</g>
<!-- proc~elec_dealloc_optical -->
<g id="proc~~dos_calculate~~CallsGraph_node24" class="node">
<title>proc~elec_dealloc_optical</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node24"><a xlink:href=".././proc/elec_dealloc_optical.html" xlink:title="elec_dealloc_optical">
<polygon fill="#d9534f" stroke="#d9534f" points="897,-656.58 776,-656.58 776,-632.58 897,-632.58 897,-656.58"/>
<text text-anchor="middle" x="836.5" y="-642.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">elec_dealloc_optical</text>
</a>
</g>
</g>
<!-- proc~elec_read_band_gradient&#45;&gt;proc~elec_dealloc_optical -->
<g id="proc~~dos_calculate~~CallsGraph_edge39" class="edge">
<title>proc~elec_read_band_gradient&#45;&gt;proc~elec_dealloc_optical</title>
<path fill="none" stroke="#00ff2e" d="M693.62,-748.5C702.71,-744.98 711.47,-740.44 719,-734.58 744.77,-714.55 729.73,-691.24 755,-670.58 759.59,-666.83 764.73,-663.62 770.14,-660.86"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="771.78,-663.96 779.44,-656.65 768.89,-657.59 771.78,-663.96"/>
</g>
<!-- proc~dos_utils_calculate_at_e&#45;&gt;proc~io_time -->
<g id="proc~~dos_calculate~~CallsGraph_edge41" class="edge">
<title>proc~dos_utils_calculate_at_e&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#002eff" d="M436.18,-968.71C456.18,-982 490.73,-1002.53 524,-1010.58 694.2,-1051.78 745.45,-1040.44 918,-1010.58 937.38,-1007.23 958.08,-1000.2 974.97,-993.48"/>
<polygon fill="#002eff" stroke="#002eff" points="976.52,-996.63 984.44,-989.6 973.86,-990.16 976.52,-996.63"/>
</g>
<!-- proc~dos_utils_calculate_at_e&#45;&gt;proc~io_error -->
<g id="proc~~dos_calculate~~CallsGraph_edge40" class="edge">
<title>proc~dos_utils_calculate_at_e&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#002eff" d="M429.45,-968.65C446.8,-987.66 483.69,-1023.84 524,-1037.58 753.85,-1115.94 903.68,-1176.46 1069,-998.58 1114.27,-949.88 1127.13,-736.9 1130.17,-666.94"/>
<polygon fill="#002eff" stroke="#002eff" points="1133.68,-666.77 1130.59,-656.64 1126.69,-666.49 1133.68,-666.77"/>
</g>
<!-- proc~dos_utils_calculate_at_e&#45;&gt;proc~elec_read_band_gradient -->
<g id="proc~~dos_calculate~~CallsGraph_edge42" class="edge">
<title>proc~dos_utils_calculate_at_e&#45;&gt;proc~elec_read_band_gradient</title>
<path fill="none" stroke="#002eff" d="M431.6,-944.32C465.68,-911.18 559.83,-819.6 600.91,-779.64"/>
<polygon fill="#002eff" stroke="#002eff" points="603.43,-782.07 608.16,-772.59 598.55,-777.05 603.43,-782.07"/>
</g>
<!-- proc~write_dos_xmgrace&#45;&gt;proc~io_error -->
<g id="proc~~dos_calculate~~CallsGraph_edge47" class="edge">
<title>proc~write_dos_xmgrace&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#e700ff" d="M888.33,-230.54C940.57,-221.44 1020.88,-217.1 1069,-261.58 1122.28,-310.84 1129.79,-548.44 1130.84,-622.5"/>
<polygon fill="#e700ff" stroke="#e700ff" points="1127.34,-622.6 1130.95,-632.56 1134.34,-622.52 1127.34,-622.6"/>
</g>
<!-- proc~write_dos_xmgrace&#45;&gt;proc~io_file_unit -->
<g id="proc~~dos_calculate~~CallsGraph_edge43" class="edge">
<title>proc~write_dos_xmgrace&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#e700ff" d="M846.08,-254.58C873.81,-293.37 961.22,-415.65 996.01,-464.32"/>
<polygon fill="#e700ff" stroke="#e700ff" points="993.21,-466.41 1001.87,-472.51 998.9,-462.34 993.21,-466.41"/>
</g>
<!-- proc~xmgu_setup -->
<g id="proc~~dos_calculate~~CallsGraph_node22" class="node">
<title>proc~xmgu_setup</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node22"><a xlink:href=".././proc/xmgu_setup.html" xlink:title="xmgu_setup">
<polygon fill="#d9534f" stroke="#d9534f" points="1050,-46.58 973,-46.58 973,-22.58 1050,-22.58 1050,-46.58"/>
<text text-anchor="middle" x="1011.5" y="-32.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xmgu_setup</text>
</a>
</g>
</g>
<!-- proc~write_dos_xmgrace&#45;&gt;proc~xmgu_setup -->
<g id="proc~~dos_calculate~~CallsGraph_edge45" class="edge">
<title>proc~write_dos_xmgrace&#45;&gt;proc~xmgu_setup</title>
<path fill="none" stroke="#e700ff" d="M841.93,-230.16C854.35,-197.02 892.67,-105.66 954,-55.58 956.93,-53.19 960.16,-51.06 963.54,-49.16"/>
<polygon fill="#e700ff" stroke="#e700ff" points="965.32,-52.18 972.76,-44.64 962.24,-45.9 965.32,-52.18"/>
</g>
<!-- proc~xmgu_legend -->
<g id="proc~~dos_calculate~~CallsGraph_node23" class="node">
<title>proc~xmgu_legend</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node23"><a xlink:href=".././proc/xmgu_legend.html" xlink:title="xmgu_legend">
<polygon fill="#d9534f" stroke="#d9534f" points="1054,-172.58 969,-172.58 969,-148.58 1054,-148.58 1054,-172.58"/>
<text text-anchor="middle" x="1011.5" y="-158.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xmgu_legend</text>
</a>
</g>
</g>
<!-- proc~write_dos_xmgrace&#45;&gt;proc~xmgu_legend -->
<g id="proc~~dos_calculate~~CallsGraph_edge44" class="edge">
<title>proc~write_dos_xmgrace&#45;&gt;proc~xmgu_legend</title>
<path fill="none" stroke="#e700ff" d="M858.57,-230.52C881.61,-217.57 919.8,-196.82 954,-181.58 958.03,-179.79 962.27,-178.01 966.54,-176.3"/>
<polygon fill="#e700ff" stroke="#e700ff" points="967.81,-179.56 975.86,-172.67 965.27,-173.04 967.81,-179.56"/>
</g>
<!-- proc~xmgu_title -->
<g id="proc~~dos_calculate~~CallsGraph_node25" class="node">
<title>proc~xmgu_title</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node25"><a xlink:href=".././proc/xmgu_title.html" xlink:title="xmgu_title">
<polygon fill="#d9534f" stroke="#d9534f" points="1045.5,-130.58 977.5,-130.58 977.5,-106.58 1045.5,-106.58 1045.5,-130.58"/>
<text text-anchor="middle" x="1011.5" y="-116.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xmgu_title</text>
</a>
</g>
</g>
<!-- proc~write_dos_xmgrace&#45;&gt;proc~xmgu_title -->
<g id="proc~~dos_calculate~~CallsGraph_edge46" class="edge">
<title>proc~write_dos_xmgrace&#45;&gt;proc~xmgu_title</title>
<path fill="none" stroke="#e700ff" d="M848.27,-230.5C867.59,-209.45 910.23,-165.81 954,-139.58 958.38,-136.96 963.13,-134.58 967.97,-132.43"/>
<polygon fill="#e700ff" stroke="#e700ff" points="969.36,-135.64 977.29,-128.61 966.71,-129.17 969.36,-135.64"/>
</g>
<!-- proc~xmgu_subtitle -->
<g id="proc~~dos_calculate~~CallsGraph_node26" class="node">
<title>proc~xmgu_subtitle</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node26"><a xlink:href=".././proc/xmgu_subtitle.html" xlink:title="xmgu_subtitle">
<polygon fill="#d9534f" stroke="#d9534f" points="1055,-88.58 968,-88.58 968,-64.58 1055,-64.58 1055,-88.58"/>
<text text-anchor="middle" x="1011.5" y="-74.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xmgu_subtitle</text>
</a>
</g>
</g>
<!-- proc~write_dos_xmgrace&#45;&gt;proc~xmgu_subtitle -->
<g id="proc~~dos_calculate~~CallsGraph_edge48" class="edge">
<title>proc~write_dos_xmgrace&#45;&gt;proc~xmgu_subtitle</title>
<path fill="none" stroke="#e700ff" d="M844.27,-230.23C859.98,-202.62 901.62,-135.37 954,-97.58 956.12,-96.06 958.36,-94.63 960.68,-93.29"/>
<polygon fill="#e700ff" stroke="#e700ff" points="962.59,-96.25 969.93,-88.6 959.42,-90 962.59,-96.25"/>
</g>
<!-- proc~xmgu_axis -->
<g id="proc~~dos_calculate~~CallsGraph_node27" class="node">
<title>proc~xmgu_axis</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node27"><a xlink:href=".././proc/xmgu_axis.html" xlink:title="xmgu_axis">
<polygon fill="#d9534f" stroke="#d9534f" points="1046,-378.58 977,-378.58 977,-354.58 1046,-354.58 1046,-378.58"/>
<text text-anchor="middle" x="1011.5" y="-364.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xmgu_axis</text>
</a>
</g>
</g>
<!-- proc~write_dos_xmgrace&#45;&gt;proc~xmgu_axis -->
<g id="proc~~dos_calculate~~CallsGraph_edge49" class="edge">
<title>proc~write_dos_xmgrace&#45;&gt;proc~xmgu_axis</title>
<path fill="none" stroke="#e700ff" d="M848.27,-254.67C867.59,-275.71 910.23,-319.35 954,-345.58 958.21,-348.11 962.77,-350.41 967.42,-352.49"/>
<polygon fill="#e700ff" stroke="#e700ff" points="966.41,-355.86 976.99,-356.44 969.08,-349.39 966.41,-355.86"/>
</g>
<!-- proc~xmgu_vertical_line -->
<g id="proc~~dos_calculate~~CallsGraph_node28" class="node">
<title>proc~xmgu_vertical_line</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node28"><a xlink:href=".././proc/xmgu_vertical_line.html" xlink:title="xmgu_vertical_line">
<polygon fill="#d9534f" stroke="#d9534f" points="1067.5,-336.58 955.5,-336.58 955.5,-312.58 1067.5,-312.58 1067.5,-336.58"/>
<text text-anchor="middle" x="1011.5" y="-322.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xmgu_vertical_line</text>
</a>
</g>
</g>
<!-- proc~write_dos_xmgrace&#45;&gt;proc~xmgu_vertical_line -->
<g id="proc~~dos_calculate~~CallsGraph_edge50" class="edge">
<title>proc~write_dos_xmgrace&#45;&gt;proc~xmgu_vertical_line</title>
<path fill="none" stroke="#e700ff" d="M858.57,-254.65C881.61,-267.6 919.8,-288.35 954,-303.58 958.03,-305.38 962.27,-307.16 966.54,-308.87"/>
<polygon fill="#e700ff" stroke="#e700ff" points="965.27,-312.13 975.86,-312.5 967.81,-305.61 965.27,-312.13"/>
</g>
<!-- proc~xmgu_data_header -->
<g id="proc~~dos_calculate~~CallsGraph_node29" class="node">
<title>proc~xmgu_data_header</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node29"><a xlink:href=".././proc/xmgu_data_header.html" xlink:title="xmgu_data_header">
<polygon fill="#d9534f" stroke="#d9534f" points="1069,-294.58 954,-294.58 954,-270.58 1069,-270.58 1069,-294.58"/>
<text text-anchor="middle" x="1011.5" y="-280.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xmgu_data_header</text>
</a>
</g>
</g>
<!-- proc~write_dos_xmgrace&#45;&gt;proc~xmgu_data_header -->
<g id="proc~~dos_calculate~~CallsGraph_edge51" class="edge">
<title>proc~write_dos_xmgrace&#45;&gt;proc~xmgu_data_header</title>
<path fill="none" stroke="#e700ff" d="M889.41,-254.59C907.97,-258.88 929.07,-263.76 948.41,-268.23"/>
<polygon fill="#e700ff" stroke="#e700ff" points="947.8,-271.68 958.33,-270.52 949.38,-264.86 947.8,-271.68"/>
</g>
<!-- proc~xmgu_data -->
<g id="proc~~dos_calculate~~CallsGraph_node30" class="node">
<title>proc~xmgu_data</title>
<g id="a_proc~~dos_calculate~~CallsGraph_node30"><a xlink:href=".././proc/xmgu_data.html" xlink:title="xmgu_data">
<polygon fill="#d9534f" stroke="#d9534f" points="1047.5,-214.58 975.5,-214.58 975.5,-190.58 1047.5,-190.58 1047.5,-214.58"/>
<text text-anchor="middle" x="1011.5" y="-200.18" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">xmgu_data</text>
</a>
</g>
</g>
<!-- proc~write_dos_xmgrace&#45;&gt;proc~xmgu_data -->
<g id="proc~~dos_calculate~~CallsGraph_edge52" class="edge">
<title>proc~write_dos_xmgrace&#45;&gt;proc~xmgu_data</title>
<path fill="none" stroke="#e700ff" d="M889.41,-230.58C913.59,-224.99 942.1,-218.4 965.38,-213.02"/>
<polygon fill="#e700ff" stroke="#e700ff" points="966.39,-216.38 975.34,-210.71 964.81,-209.56 966.39,-216.38"/>
</g>
<!-- proc~algor_dist_array&#45;&gt;proc~io_error -->
<g id="proc~~dos_calculate~~CallsGraph_edge53" class="edge">
<title>proc~algor_dist_array&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#ff0000" d="M1042.6,-710.52C1051.37,-706.54 1060.79,-701.78 1069,-696.58 1084.04,-687.06 1099.39,-674.22 1111.05,-663.68"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1113.51,-666.17 1118.48,-656.82 1108.76,-661.03 1113.51,-666.17"/>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~io_time -->
<g id="proc~~dos_calculate~~CallsGraph_edge54" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~io_time</title>
<path fill="none" stroke="#ff8b00" d="M847.78,-774.74C863.19,-793.03 893.13,-828.75 918,-859.58 945.39,-893.54 976.56,-933.61 994.82,-957.23"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="992.27,-959.66 1001.16,-965.44 997.82,-955.38 992.27,-959.66"/>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~io_error -->
<g id="proc~~dos_calculate~~CallsGraph_edge55" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#ff8b00" d="M902.66,-772.15C951.88,-776.02 1019.22,-773.87 1069,-743.58 1097.83,-726.05 1115.37,-689.49 1124.12,-666.04"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1127.43,-667.19 1127.44,-656.6 1120.82,-664.87 1127.43,-667.19"/>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;interface~comms_recv -->
<g id="proc~~dos_calculate~~CallsGraph_edge59" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;interface~comms_recv</title>
<path fill="none" stroke="#ff8b00" d="M889.41,-774.59C912.36,-779.89 939.21,-786.1 961.79,-791.32"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="961.3,-794.8 971.83,-793.64 962.88,-787.98 961.3,-794.8"/>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;interface~comms_send -->
<g id="proc~~dos_calculate~~CallsGraph_edge57" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;interface~comms_send</title>
<path fill="none" stroke="#ff8b00" d="M858.57,-774.65C881.61,-787.6 919.8,-808.35 954,-823.58 958.03,-825.38 962.27,-827.16 966.54,-828.87"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="965.27,-832.13 975.86,-832.5 967.81,-825.61 965.27,-832.13"/>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~io_file_unit -->
<g id="proc~~dos_calculate~~CallsGraph_edge58" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~io_file_unit</title>
<path fill="none" stroke="#ff8b00" d="M849.12,-750.41C865.68,-732.69 896.45,-698.29 918,-665.58 953.87,-611.14 986.15,-541 1001.33,-506.18"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="1004.57,-507.52 1005.32,-496.95 998.14,-504.75 1004.57,-507.52"/>
</g>
<!-- proc~elec_read_optical_mat&#45;&gt;proc~algor_dist_array -->
<g id="proc~~dos_calculate~~CallsGraph_edge56" class="edge">
<title>proc~elec_read_optical_mat&#45;&gt;proc~algor_dist_array</title>
<path fill="none" stroke="#ff8b00" d="M889.41,-750.58C909.33,-745.97 932.2,-740.69 952.65,-735.96"/>
<polygon fill="#ff8b00" stroke="#ff8b00" points="953.52,-739.35 962.47,-733.69 951.94,-732.53 953.52,-739.35"/>
</g>
<!-- proc~xmgu_setup&#45;&gt;proc~io_date -->
<g id="proc~~dos_calculate~~CallsGraph_edge60" class="edge">
<title>proc~xmgu_setup&#45;&gt;proc~io_date</title>
<path fill="none" stroke="#e7ff00" d="M1050.32,-28.2C1064.46,-25.81 1080.49,-23.11 1094.51,-20.74"/>
<polygon fill="#e7ff00" stroke="#e7ff00" points="1095.49,-24.13 1104.77,-19.01 1094.33,-17.22 1095.49,-24.13"/>
</g>
<!-- proc~elec_dealloc_optical&#45;&gt;proc~io_error -->
<g id="proc~~dos_calculate~~CallsGraph_edge61" class="edge">
<title>proc~elec_dealloc_optical&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#00ff2e" d="M897.25,-644.58C956.43,-644.58 1045.15,-644.58 1094.53,-644.58"/>
<polygon fill="#00ff2e" stroke="#00ff2e" points="1094.73,-648.08 1104.73,-644.58 1094.73,-641.08 1094.73,-648.08"/>
</g>
<!-- proc~xmgu_data&#45;&gt;proc~io_error -->
<g id="proc~~dos_calculate~~CallsGraph_edge62" class="edge">
<title>proc~xmgu_data&#45;&gt;proc~io_error</title>
<path fill="none" stroke="#ff008b" d="M1047.66,-212.34C1055.79,-216.16 1063.62,-221.42 1069,-228.58 1116.41,-291.77 1127.97,-545.29 1130.41,-622.29"/>
<polygon fill="#ff008b" stroke="#ff008b" points="1126.91,-622.44 1130.71,-632.33 1133.91,-622.23 1126.91,-622.44"/>
</g>
</g>
</svg>
</div><script>var panprocdos_calculateCallsGraph = svgPanZoom('#procdos_calculateCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~dos_calculate~~CalledByGraph Pages: 1 -->
<svg id="procdos_calculateCalledByGraph" width="184pt" height="32pt"
 viewBox="0.00 0.00 184.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~dos_calculate~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~dos_calculate~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 180,-28 180,4 -4,4"/>
<!-- proc~dos_calculate -->
<g id="proc~~dos_calculate~~CalledByGraph_node1" class="node">
<title>proc~dos_calculate</title>
<polygon fill="none" stroke="black" points="176,-24 91,-24 91,0 176,0 176,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">dos_calculate</text>
</g>
<!-- program~optados -->
<g id="proc~~dos_calculate~~CalledByGraph_node2" class="node">
<title>program~optados</title>
<g id="a_proc~~dos_calculate~~CalledByGraph_node2"><a xlink:href=".././program/optados.html" xlink:title="optados">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="55,-24 0,-24 0,0 55,0 55,-24"/>
<text text-anchor="middle" x="27.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">optados</text>
</a>
</g>
</g>
<!-- program~optados&#45;&gt;proc~dos_calculate -->
<g id="proc~~dos_calculate~~CalledByGraph_edge1" class="edge">
<title>program~optados&#45;&gt;proc~dos_calculate</title>
<path fill="none" stroke="#ff0000" d="M55.01,-12C62.8,-12 71.6,-12 80.4,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="80.67,-15.5 90.67,-12 80.67,-8.5 80.67,-15.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>

    <section class="visible-xs visible-sm hidden-md">
        <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/dos_calculate.html#src">dos_calculate</a>
      </div>
    </div>


    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="w">  </span><span class="k">subroutine </span><span class="n">dos_calculate</span><span class="w"></span>
<span class="w">    </span><span class="c">!===============================================================================</span>
<span class="w">    </span><span class="c">! Main routine in dos module, drives the calculation of density of states for</span>
<span class="w">    </span><span class="c">! both task : dos and also if it is required elsewhere.</span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! Arguments: matrix_weigths (in) (opt) : LCAO or other weightings for DOS</span>
<span class="w">    </span><span class="c">!            weighted_dos   (out)(opt) : Output DOS weigthed by matrix_weights</span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! Parent Module Varables Used: mw, E, dos_adaptive, dos_fixed, dos_linear</span>
<span class="w">    </span><span class="c">! intdos_adaptive, intdos_fixed, intdos_linear, efermi_fixed, efermi_adaptive</span>
<span class="w">    </span><span class="c">! efermi_linear, delta_bins, calc_weighted_dos</span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! Modules Used: see below</span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! Key Internal Variables: None</span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! Necessary Conditions: One of linear, adaptive or fixed must be .true.</span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! Known Worries: (1) If more than one of linear, adaptive or fixed are set it</span>
<span class="w">    </span><span class="c">! uses the most complicated method.</span>
<span class="w">    </span><span class="c">! (2) It should be possible to pass optioinal arguments to sub programs as</span>
<span class="w">    </span><span class="c">! optional argumnets without checking whether they are there or not. g95 will</span>
<span class="w">    </span><span class="c">! allow this behaviour. gfotran will not.</span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! Written by : A J Morris December 2010</span>
<span class="w">    </span><span class="c">!===============================================================================</span>
<span class="w">    </span><span class="k">use </span><span class="n">od_io</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="n">io_time</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_dos_utils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="n">dos_fixed</span><span class="p">,</span><span class="w"> </span><span class="n">intdos_fixed</span><span class="p">,</span><span class="w"> </span><span class="n">dos_adaptive</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">         </span><span class="p">&amp;</span><span class="n">intdos_adaptive</span><span class="p">,</span><span class="w"> </span><span class="n">dos_linear</span><span class="p">,</span><span class="w"> </span><span class="n">intdos_linear</span><span class="p">,</span><span class="w"> </span><span class="n">dos_utils_calculate</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">         </span><span class="p">&amp;</span><span class="n">dos_utils_compute_dos_at_efermi</span><span class="p">,</span><span class="w"> </span><span class="n">dos_utils_compute_bandgap</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">         </span><span class="p">&amp;</span><span class="n">dos_utils_compute_band_energies</span><span class="p">,</span><span class="w"> </span><span class="n">dos_utils_set_efermi</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_parameters</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">fixed</span><span class="p">,</span><span class="w"> </span><span class="n">adaptive</span><span class="p">,</span><span class="w"> </span><span class="n">linear</span><span class="p">,</span><span class="w"> </span><span class="n">compute_band_gap</span><span class="p">,&amp;</span><span class="w"></span>
<span class="w">         </span><span class="p">&amp;</span><span class="n">compute_band_energy</span><span class="p">,</span><span class="w"> </span><span class="n">set_efermi_zero</span><span class="p">,</span><span class="w"> </span><span class="n">iprint</span><span class="w"></span>

<span class="w">    </span><span class="k">use </span><span class="n">od_comms</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">on_root</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">od_electronic</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">nspins</span><span class="p">,</span><span class="w"> </span><span class="n">efermi</span><span class="p">,</span><span class="w"> </span><span class="n">band_energy</span><span class="p">,</span><span class="w"> </span><span class="n">efermi_set</span><span class="w"></span>

<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">time0</span><span class="p">,</span><span class="w"> </span><span class="n">time1</span><span class="p">,</span><span class="w"> </span><span class="n">unshifted_efermi</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">on_root</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(1x,a78)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;+============================================================================+&#39;</span><span class="w"></span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(1x,a78)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;+                              Density of States                             +&#39;</span><span class="w"></span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(1x,a78)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;+============================================================================+&#39;</span><span class="w"></span>
<span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(1x,a78)&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">end if</span>

<span class="k">    call </span><span class="n">dos_utils_calculate</span><span class="w">   </span><span class="c">! Will return if this has already been done.</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">efermi_set</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">dos_utils_set_efermi</span><span class="w"></span>

<span class="w">    </span><span class="n">time0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_time</span><span class="p">()</span><span class="w"></span>

<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! D O S   A T   F E R M I  L E V E L   A N A L Y S I S</span>
<span class="w">    </span><span class="k">call </span><span class="n">dos_utils_compute_dos_at_efermi</span><span class="w"></span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>

<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! B A N D  G A P  A N A L Y S I S</span>
<span class="w">    </span><span class="c">! The compute_dos_at_efermi routine may have set compute_band_gap to true</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_band_gap</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">dos_utils_compute_bandgap</span><span class="w"></span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>

<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c">! B A N D   E N E R G Y   A N A L Y S I S</span>
<span class="w">    </span><span class="c">! Now for a bit of crosschecking  band energies</span>
<span class="w">    </span><span class="c">! These should all converge to the same number as the number of bins is increased</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compute_band_energy</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">dos_utils_compute_band_energies</span><span class="w"></span>
<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>
<span class="c">!!$</span>
<span class="c">!!$    unshifted_efermi=efermi</span>
<span class="c">!!$</span>
<span class="c">!!$    if(set_efermi_zero) then</span>
<span class="c">!!$       if(on_root) then</span>
<span class="c">!!$          write(stdout,*)</span>
<span class="c">!!$          write(stdout,&#39;(1x,a71)&#39;)  &#39;+----------------------- Shift Fermi Energy --------------------------+&#39;</span>
<span class="c">!!$          write(stdout,&#39;(1x,a1,a46,a24)&#39;)&quot;|&quot;, &quot; Setting Fermi energy to 0 : &quot;,&quot;|&quot;</span>
<span class="c">!!$       endif</span>
<span class="c">!!$       E(:)=E(:)-efermi</span>
<span class="c">!!$       band_energy(:,:,:) = band_energy(:,:,:) - efermi</span>
<span class="c">!!$       efermi=0.0_dp</span>
<span class="c">!!$    endif</span>
<span class="c">!!$</span>
<span class="c">!!$    if(on_root) then</span>
<span class="c">!!$       write(stdout,&#39;(1x,a1,a46,f8.4,a3,12x,a8)&#39;)&quot;|&quot;, &quot; Fermi energy used : &quot;, unshifted_efermi,&quot;eV&quot;,&quot;| &lt;- Ef &quot;</span>
<span class="c">!!$       write(stdout,&#39;(1x,a71)&#39;)  &#39;+---------------------------------------------------------------------+&#39;</span>
<span class="c">!!$</span>
<span class="c">!!$       time1=io_time()</span>
<span class="c">!!$       write(stdout,&#39;(1x,a40,f11.3,a)&#39;) &#39;Time to perfom analysis &#39;,time1-time0,&#39; (sec)&#39;</span>
<span class="c">!!$       !-------------------------------------------------------------------------------</span>
<span class="c">!!$    end if</span>

<span class="w">    </span><span class="c">! W R I T E   O U T   D O S</span>
<span class="w">    </span><span class="n">time0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_time</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="c">! Otherwise we have written to wdos and dos, so they can be called</span>
<span class="w">    </span><span class="c">! by whatever.</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">on_root</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">fixed</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_dos</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="n">dos_fixed</span><span class="p">,</span><span class="w"> </span><span class="n">intdos_fixed</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;fixed&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">adaptive</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_dos</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="n">dos_adaptive</span><span class="p">,</span><span class="w"> </span><span class="n">intdos_adaptive</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;adaptive&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">linear</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">write_dos</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="w"> </span><span class="n">dos_linear</span><span class="p">,</span><span class="w"> </span><span class="n">intdos_linear</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;linear&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">      </span><span class="c">!if(quad)    call write_dos(E, dos_quad, intdos_quad, &quot;quad&quot;)</span>
<span class="w">    </span><span class="k">end if</span>
<span class="k">    </span><span class="n">time1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">io_time</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">on_root</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iprint</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      write</span><span class="w"> </span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(1x,a59,f11.3,a8)&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="w">           </span><span class="s1">&#39;+ Time to write DOS to disk                              &amp;</span>
<span class="s1">           &amp;      &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time0</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; (sec) +&#39;</span><span class="w"></span>
<span class="w">    </span><span class="k">end if</span><span class="w"></span>

<span class="w">    </span><span class="c">!-------------------------------------------------------------------------------</span>

<span class="w">  </span><span class="k">end subroutine </span><span class="n">dos_calculate</span><span class="w"></span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>OptaDOS was developed by The OptaDOS developers group<br>&copy; 2024 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>